{{var gmwa=gmwa||{},gmwa=(gmwa.init=function(e,o,t){gmwa.logger.init(o),gmwa.logger.log("App|GM WebApp started"),gmwa.isSafari=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),gmwa.storage=Storages.localStorage,gmwa.mapsFW=t,void 0!==e&&(gmwa.storage.isEmpty("_gmwa_dt")?gmwa.storage.set("_gmwa_dt",e):gmwa.storage.get("_gmwa_dt")!=e&&(gmwa.storage.set("_gmwa_dt",e),gmwa.webpush.subscribe())),gmwa.services.worker.register(),window.lazySizesConfig=window.lazySizesConfig||{},window.lazySizesConfig.hFac=.4,window.dayjs&&window.dayjs.locale("es"),gmwa.components.maps&&gmwa.components.maps.init(t),gmwa.initDefaults(),gmwa.router.init()},gmwa.initDefaults=function(){$(".list-collapsible").on("click",function(){$(this).next("div:first").slideToggle("slow")})},gmwa||{}),gmwa=(gmwa.config={gcmAPIKey:"AAAAOWC1TY0:APA91bFOZCjb4Iy4LE8VaXvAYm4xstzeKCHNMncRSLTMckFLzyDrSVttOFDH5txUneCoqLjTC-49nuu_dsrF60zw-j7XPq53iPB1niUjSc4gjp6F1DjrynpPIZFQgwHx-eMCZoHNvsbe"},gmwa||{}),gmwa=(gmwa.logger={},gmwa.logger.init=function(e){(gmwa.logger.debug=e)?(gmwa.logger.log=console.log.bind(window.console),gmwa.logger.info=console.info.bind(window.console),gmwa.logger.warn=console.warn.bind(window.console),gmwa.logger.error=console.error.bind(window.console)):(gmwa.logger.log=function(){},gmwa.logger.info=function(){},gmwa.logger.warn=function(){},gmwa.logger.error=function(){})},gmwa||{}),gmwa=(gmwa.router={},gmwa.router.sendPushSubscription=!1,gmwa.router.init=function(){("/"==window.location.pathname?(gmwa.logger.log("Router|Resolved to home controller"),gmwa.controllers.home):"/local"==window.location.pathname.substr(0,6)?(gmwa.logger.log("Router|Resolved to comercio controller"),gmwa.controllers.comercio):"/reservar"==window.location.pathname.substr(0,9)?(gmwa.logger.log("Router|Resolved to reserve controller"),gmwa.controllers.reserve):"/fotos"==window.location.pathname.substr(0,6)?(gmwa.logger.log("Router|Resolved to gals controller"),gmwa.controllers.gals):"/buscar"==window.location.pathname.substr(0,7)||"/rubro"==window.location.pathname.substr(0,6)||"/rubro-zona"==window.location.pathname.substr(0,11)||"/zona"==window.location.pathname.substr(0,5)?(gmwa.logger.log("Router|Resolved to resultList controller"),gmwa.controllers.resultlist):"/promociones-y-ofertas"==window.location.pathname?(gmwa.logger.log("Router|Resolved to promosHome controller"),gmwa.controllers.promosHome):"/promociones-y-ofertas"==window.location.pathname.substr(0,22)?(gmwa.logger.log("Router|Resolved to promosAll controller"),gmwa.controllers.promosAll):"/promociones/"==window.location.pathname.substr(0,13)?(gmwa.logger.log("Router|Resolved to promosSponsor controller"),gmwa.controllers.promosSponsor):"/promocion/"==window.location.pathname.substr(0,11)?(gmwa.logger.log("Router|Resolved to promosFicha controller"),gmwa.controllers.promosFicha):"/pedidos"==window.location.pathname?(gmwa.logger.log("Router|Resolved to requestsList controller"),gmwa.controllers.requestsList):"/pedir/"==window.location.pathname.substr(0,7)?(gmwa.logger.log("Router|Resolved to store controller"),gmwa.router.sendPushSubscription=!0,gmwa.controllers.store):"/pd/"==window.location.pathname.substr(0,4)?(gmwa.logger.log("Router|Resolved to productOrderMenu controller"),gmwa.router.sendPushSubscription=!0,gmwa.controllers.productOrderMenu):"/presupuesto/v/"==window.location.pathname.substr(0,15)?(gmwa.logger.log("Router|Resolved to quoteView controller"),gmwa.controllers.quoteView):"/presupuesto/"==window.location.pathname.substr(0,13)?(gmwa.logger.log("Router|Resolved to quoteRequest controller"),gmwa.router.sendPushSubscription=!0,gmwa.controllers.quoteRequest):"/pedidos/pedido"==window.location.pathname.substr(0,15)?(gmwa.logger.log("Router|Resolved to orderView controller"),gmwa.controllers.orderView):"/pedido/checkout"==window.location.pathname.substr(0,16)?(gmwa.logger.log("Router|Resolved to orderCheckout controller"),gmwa.router.sendPushSubscription=!0,gmwa.controllers.orderCheckout):"/cartelera"==window.location.pathname.substr(0,10)?(gmwa.logger.log("Router|Resolved to cartelera controller"),gmwa.controllers.cartelera):"/horoscopo"==window.location.pathname.substr(0,10)?(gmwa.logger.log("Router|Resolved to horoscopo controller"),gmwa.controllers.horoscopo):"/reportarerror"==window.location.pathname.substr(0,14)?(gmwa.logger.log("Router|Resolved to reportar error controller"),gmwa.controllers.reportarError):"/contacto"==window.location.pathname.substr(0,9)?(gmwa.logger.log("Router|Resolved to contacto controller"),gmwa.controllers.contact):"/azar"==window.location.pathname.substr(0,5)?(gmwa.logger.log("Router|Resolved to azar controller"),gmwa.controllers.azar):"/login"==window.location.pathname.substr(0,6)?(gmwa.logger.log("Router|Resolved to login controller"),gmwa.controllers.login):"/favs"==window.location.pathname.substr(0,5)?(gmwa.logger.log("Router|Resolved to favorites controller"),gmwa.controllers.favorites):(gmwa.logger.log("Router|Resolved to default home controller"),gmwa.controllers.home)).init()},gmwa||{}),gmwa=(gmwa.utils={},gmwa.utils.eErrMsg=null,gmwa.utils.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},gmwa.utils.isAndroid=function(){return/Android/i.test(navigator.userAgent)},gmwa.utils.showProgress=function(e,o,t,r){var a='<div id="divProgress" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;z-index:2000;background-color: rgba(0,0,0,0.5);text-align: center;">';t&&(a=(a+='<div style="margin-top: 20px;text-align: center;background-color: #FFF;display: inline-block;padding: 10px; box-shadow: 0px 2px 6px 0px rgba(0,0,0,0.5);">')+'<div id="galspinner" class="spinner" style="margin-top: 20px;"><div class="rect1" style="background-color:#757575"></div><div class="rect2" style="background-color:#757575"></div><div class="rect3" style="background-color:#757575"></div><div class="rect4" style="background-color:#757575"></div><div class="rect5" style="background-color:#757575"></div></div><div style="font-size:22px;font-weight:100">'+e+"</div><div>"+o+"</div></div>"),a+="</div>",gmwa.utils.divProgress=$(a),r&&($("#guia-container").css("filter","blur(2px)"),$("#guia-container").css("-webkit-filter:","blur(2px)")),$("body").append(gmwa.utils.divProgress)},gmwa.utils.hideProgress=function(){$("#divProgress").remove(),$("#guia-container").css("filter","blur(0px)"),$("#guia-container").css("-webkit-filter:","blur(0px)")},gmwa.utils.showError=function(e,o){null===gmwa.utils.eErrMsg&&(gmwa.utils.eErrMsg=$('<div class="tiny reveal" id="errMsg" data-reveal><h4>'+e+"</h4><p>"+o+'</p><button class="button" data-close>OK</button><button class="close-button" data-close aria-label="Close reveal" type="button"><span aria-hidden="true">&times;</span></button></div>'),gmwa.utils.eErrMsg.foundation()),gmwa.utils.eErrMsg.foundation("open")},gmwa.utils.scrollTo=function(e){$("html, body").animate({scrollTop:$("#"+e).offset().top},500)},gmwa.utils.flash=function(e){$("#"+e).effect("highlight",{},2e3)},gmwa.utils.formatNumber=function(e,o,t,r,a){t=void 0===t?".":t,r=void 0===r?",":r;var n="\\d(?=(\\d{3})+"+(0<(o=void 0===o?2:o)?"\\D":"$")+")",e=parseFloat(e).toFixed(Math.max(0,~~o));return(r?e.replace(".",r):e).replace(new RegExp(n,"g"),"$&"+(t||","))},gmwa.utils.formatNumberObject=function(e,o,t,r,a){t=void 0===t?".":t,r=void 0===r?",":r,a=void 0===a?"$U":a;var n="\\d(?=(\\d{3})+"+(0<(o=void 0===o?2:o)?"\\D":"$")+")",e=parseFloat(e).toFixed(Math.max(0,~~o)),o=(r?e.replace(".",r):e).replace(new RegExp(n,"g"),"$&"+(t||",")).toString().split(",");return{number:o[0],decimals:void 0===o[1]?"":o[1],currency:a}},gmwa.utils.formatNumberHTML=function(e,o,t,r,a){t=void 0===t?".":t,r=void 0===r?",":r,a=void 0===a?"$U":a;var n="\\d(?=(\\d{3})+"+(0<(o=void 0===o?2:o)?"\\D":"$")+")",e=parseFloat(e).toFixed(Math.max(0,~~o)),o=(r?e.replace(".",r):e).replace(new RegExp(n,"g"),"$&"+(t||",")).toString().split(",");return'<span class="currency">'+a+"</span> "+o[0]+'<span class="decimals">,'+(void 0===o[1]?"":o[1])+"</span>"},gmwa.utils.loadStylesheet=function(e,o){var t=document.createElement("link");t.href=e,t.rel="stylesheet",t.type="text/css",t.media="only x",t.onload=function(){t.media="all",o()},document.getElementsByTagName("head")[0].appendChild(t)},gmwa.utils.loadScript=function(e,o){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.readyState?t.onreadystatechange=function(){"loaded"!=t.readyState&&"complete"!=t.readyState||(t.onreadystatechange=null,o&&"function"==typeof o&&o())}:t.onload=function(){o&&"function"==typeof o&&o()},t.src=e,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)},gmwa.utils.sendGAEvent=function(e,o,t){var r,a,n;gtag&&(console.log("Utils | sendGAEvent | Sending event("+e+","+o+","+t+")"),r=(n=t.split("|"))[0],a=n[1],n=n[2],gtag("event",o,{event_category:e,event_action:o,event_label:t,name:r,idr:a,ids:n}))},gmwa.utils.isEmail=function(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)},gmwa||{}),gmwa=(gmwa.webpush={},gmwa.webpush.isPushEnabled=!1,gmwa.webpush.isPushSupported=!1,gmwa.webpush.isBlocked=!1,gmwa.webpush.pushId="web.uy.com.1122",gmwa.webpush.urlBase64ToUint8Array=function(e){for(var e=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),o=window.atob(e),t=new Uint8Array(o.length),r=0;r<o.length;++r)t[r]=o.charCodeAt(r);return t},gmwa.webpush.unsubscribe=function(o){gmwa.isSafari||navigator.serviceWorker.ready.then(function(e){gmwa.logger.log("WebPush|Unsubscribe from push requested"),e.pushManager.getSubscription().then(function(e){e?e.unsubscribe().then(function(){gmwa.logger.log("WebPush|Push service unsubscribed"),gmwa.webpush.isPushEnabled=!1,o(0)}).catch(function(e){o(-1),gmwa.logger.log("WebPush|Unsubscription error: ",e)}):(gmwa.webpush.isPushEnabled=!1,gmwa.logger.log("WebPush|No subscription yet. User must request permission"),o(0))}).catch(function(e){o(-2),gmwa.logger.log("WebPush|Error thrown while unsubscribing from push messaging.",e)})})},gmwa.webpush.subscribe=function(t){if(gmwa.isSafari)if("safari"in window&&"pushNotification"in window.safari){gmwa.logger.log("WebPush|Subscribe to push requested for PushID "+gmwa.webpush.pushId);var e=window.safari.pushNotification.permission(gmwa.webpush.pushId);if("denied"===e.permission)gmwa.logger.log("WebPush|Permission for Notifications was denied"),gmwa.logger.log(e),t&&t(-1);else{if("granted"===e.permission)return gmwa.webpush.isPushEnabled=!0,t&&t(0),gmwa.logger.log("WebPush|Permission for Notifications was granted!"),gmwa.logger.log(e),gmwa.webpush.sendSubscriptionToServer({isAPN:!0,endpoint:e.deviceToken});"default"===e.permission?window.safari.pushNotification.requestPermission("https://wgm.tingelmar.com",gmwa.webpush.pushId,{id:"web.wgm"},function(e){if("denied"===e.permission)gmwa.logger.log("WebPush|Permission for Notifications was denied"),gmwa.logger.log(e),t&&t(-1);else{if("granted"===e.permission)return gmwa.webpush.isPushEnabled=!0,gmwa.logger.log("WebPush|Permission for Notifications was granted!"),gmwa.logger.log(e),t&&t(0),gmwa.webpush.sendSubscriptionToServer({isAPN:!0,endpoint:e.deviceToken});gmwa.logger.log("WebPush|Permission for Notifications is unknown!"),gmwa.logger.log(e)}}):(gmwa.logger.log("WebPush|Permission for Notifications is unknown!"),gmwa.logger.log(e))}}else gmwa.logger.log("WebPush|WebPush not supported"),t&&t(-2);else navigator.serviceWorker.ready.then(function(e){gmwa.logger.log("WebPush|Subscribe to push requested");var o="",o=0<=window.location.hostname.toLowerCase().indexOf("buscoinfo")?"BMdNOGlVFilaDpgOdZTP1znMUxo93j6ck8J4Rt3sMpdPHPkoyiJTfuUe3X2379dMfIy-zDETn3S_2GF5Ownc_qg":"BAmkGWd5l67dpfKt35y1C5w33tyxuK3if4XbYLe3j69z2R5ZhLPsh3-flPdwIC_1Ecle9WRHXJXY_s61uzIlMFo",o=(gmwa.logger.log("WebPush|Will request notifications subscription with pub key => "+o),gmwa.webpush.urlBase64ToUint8Array(o));e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o}).then(function(e){return gmwa.webpush.isPushEnabled=!0,t&&t(0),gmwa.webpush.sendSubscriptionToServer(e)}).catch(function(e){"denied"===Notification.permission?(gmwa.logger.log("WebPush|Permission for Notifications was denied"),t&&t(-1)):(gmwa.logger.error("WebPush|Unable to subscribe to push.",e),t&&t(-2))})})},gmwa.webpush.sendSubscriptionToServer=function(e){e.endpoint.split("/");var o=JSON.stringify(e),e="/pedidos/pushsubscribe?dt="+gmwa.storage.get("_gmwa_dt");$.ajax({type:"POST",url:e,data:o,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){0===e.outcode?(gmwa.logger.log("WebPush|API returned OK: "+JSON.stringify(e)),gmwa.storage.set("_gmwa_subscription",o),gmwa.logger.log("WebPush|Subscription saved to local storage"),gmwa.logger.log(o)):gmwa.logger.error("WebPush|API returned error: "+JSON.stringify(e))}).fail(function(e){gmwa.logger.error("WebPush|API returned error: "+JSON.stringify(e))})},gmwa||{}),gmwa=(gmwa.components=gmwa.components||{},gmwa.components.galleryviewer={},gmwa.components.galleryviewer.init=function(){gmwa.logger.log("GalleryViewer|Init..."),$("a.gal-image-ho").on("click",function(e){e.preventDefault();var o,n,l=-1;"PICTURE"==e.currentTarget.childNodes[0].tagName.toUpperCase()?(o=e.currentTarget.childNodes[0].getElementsByTagName("img"))&&o.length&&(o=o[0].attributes.index)&&(l=parseInt(o.nodeValue)):l=parseInt(e.currentTarget.childNodes[0].attributes.index.nodeValue),-1!=l&&($(document.body).append('<div id="galviewer"><i class="fa fa-times gal-close" aria-hidden="true"></i><div id="galspinner" class="spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div><div id="galspinnertext" style="text-align: center;color: #FFF;font-size: 13px;">Cargando...</div><div id="gal-cntr" class="gal-cntr" style="display:none"><div class="gal-prev"><i class="fa fa-angle-left" aria-hidden="true"></i></div><img id="galimg" ><div class="gal-next"><i class="fa fa-angle-right" aria-hidden="true"></i></div><div id="gal-info" class="gal-info"></div></div></div>'),n=function(e){$("#galviewer").remove(),$(document).off("keydown")},$("#galviewer").on("click",function(e){n()}).children().click(function(e){return!1}),$(".gal-close").on("click",function(e){n()}),gmwa.logger.log("Will request data..."),$.getJSON("/galeria/info/"+e.currentTarget.dataset.idrids+"/"+e.currentTarget.dataset.ide+"/"+e.currentTarget.dataset.id).done(function(e){var o,t,r,a;0==e.outcode?(window.currentGallery=e.r.gallery,window.currentGalleryIndex=l,o=function(e){gmwa.logger.log("Moving next"),window.currentGalleryIndex+1<window.currentGallery.images.length&&(window.currentGalleryIndex++,$("#galimg").attr("src",window.currentGallery.images[window.currentGalleryIndex].src),$("#galImgTitle").text(window.currentGallery.images[window.currentGalleryIndex].title),$("#galImgDesc").text(window.currentGallery.images[window.currentGalleryIndex].desc),window.currentGalleryIndex==window.currentGallery.images.length-1?$(".gal-next").hide():$(".gal-next").show(),$(".gal-prev").show())},t=function(e){gmwa.logger.log("Moving prev"),0<=window.currentGalleryIndex-1&&(window.currentGalleryIndex--,$("#galimg").attr("src",window.currentGallery.images[window.currentGalleryIndex].src),$("#galImgTitle").text(window.currentGallery.images[window.currentGalleryIndex].title),$("#galImgDesc").text(window.currentGallery.images[window.currentGalleryIndex].desc),0===window.currentGalleryIndex?$(".gal-prev").hide():$(".gal-prev").show(),$(".gal-next").show())},$(".gal-next").on("click",o),$(".gal-prev").on("click",t),$(document).on("keydown",function(e){switch(e.which){case 37:t();break;case 39:o();break;case 27:n();break;default:return}e.preventDefault()}),r='<div class="bizDetails"><table><tr><td>',e.r.retailer.ics&&0<e.r.retailer.ics.length?r+='<img src="'+e.r.retailer.ics+'"></td><td>':r+='<img src="/img/local_default.png"></td><td>',r+="<h1>"+e.r.retailer.nam+"</h1><br><h2>"+e.r.retailer.adr+"</h2></td></tr></table></div>",a='<div class="galDetails"><h1>'+e.r.gallery.name+"</h1><h2>"+e.r.gallery.description+'</h2><h3 id="galImgTitle">'+e.r.gallery.images[window.currentGalleryIndex].title+'</h3><h4 id="galImgDesc">'+e.r.gallery.images[window.currentGalleryIndex].desc+"</h4></div>",$(".gal-info").html(r+a),$("#galimg").attr("src",window.currentGallery.images[window.currentGalleryIndex].src),$("#galImgTitle").text(window.currentGallery.images[window.currentGalleryIndex].title),$("#galImgDesc").text(window.currentGallery.images[window.currentGalleryIndex].desc),0==window.currentGalleryIndex&&$(".gal-prev").hide(),$(".gal-cntr").fadeIn(400),$("#galspinner, #galspinnertext").hide()):gmwa.logger.error("API returned error: "+e.outcode+" ("+e.outmsg+")")}).fail(function(e){gmwa.logger.error(e)}))})},gmwa||{}),gmwa=(gmwa.components=gmwa.components||{},gmwa.components.header={},gmwa.components.header.buscadorOpened=!1,gmwa.components.header.navigating=!1,gmwa.components.header.menuOpened=!1,gmwa.components.header.menuBtn=null,gmwa.components.header.init=function(){gmwa.logger.log("Header|Init...");var e={url:function(e){if(3<=e.length)return"/components/pred-rubros-json/"+e},requestDelay:300,getValue:"name",template:{type:"description",fields:{description:"desc"}},list:{maxNumberOfElements:15,onChooseEvent:function(){var e,o=$("#search-rubroNombre").getSelectedItemData();1!=o.type||gmwa.components.header.navigating||(e=o.key.split("~"),e=parseInt(1e4*e[0])+parseInt(e[1]),o="/local/"+encodeURI(o.name.toLowerCase())+"/LOC",o+=e.toString(),gmwa.components.header.navigating=!0,window.location=o)}}},e=($("#search-rubroNombre").easyAutocomplete(e),e={url:function(e){if(3<=e.length)return"/components/pred-zonas-json/"+e},requestDelay:300,getValue:"name",template:{type:"description",fields:{description:"desc"}}},$("#search-zonaNombre").easyAutocomplete(e),$("#searcher-form a, #doSearch").on("click",function(e){e.preventDefault(),gmwa.components.header.search()}),$("#searcher-form").submit(function(e){e.preventDefault(),gmwa.components.header.search()}),$("#headerLupa").on("click",function(e){$("#headerBuscador").show()}),$("#cancelSearch").on("click",function(e){$("#headerBuscador").hide()}),$("#btnLogin").attr("href"));void 0!==e&&(e=e.replace("retUrl=/","retUrl="+location.href),$("#btnLogin").attr("href",e)),gmwa.components.header.menuBtn=$("#btnMenu i"),$("#btnMenu").on("click",function(e){null==gmwa.components.header.menuCntr&&(gmwa.components.header.menuCntr=$("#headerToolbar")),gmwa.components.header.menuCntr.show(function(){gmwa.components.header.menuCntr.addClass("show")})}),$("#btnMenuClose").on("click",function(e){gmwa.components.header.menuCntr.removeClass("show"),setTimeout(function(){gmwa.components.header.menuCntr.hide()},400)}),gmwa.components.header.initCrosshair()},gmwa.components.header.search=function(){var e=gmwa.components.header.slugify($("#search-rubroNombre").val().trim())||"empresas",o=gmwa.components.header.slugify($("#search-zonaNombre").val().trim())||"todo-el-pais";gmwa.components.header.crossHairActive&&gmwa.components.header.coords&&gmwa.components.header.coords.latitude?document.location="/buscar/"+e+"/"+o+"/"+gmwa.components.header.coords.latitude+","+gmwa.components.header.coords.longitude:document.location="/buscar/"+e+"/"+o},gmwa.components.header.slugify=function(e){e=(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var o="ãàáäâẽèéëêìíïîõòóöôùúüûñç·/_,:;",t=0,r=o.length;t<r;t++)e=e.replace(new RegExp(o.charAt(t),"g"),"aaaaaeeeeeiiiiooooouuuunc------".charAt(t));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")},gmwa.components.header.initCrosshair=function(){if("geolocation"in navigator&&(gmwa.components.header.crossHairActive=!1,$("#cross").on("click",function(e){gmwa.components.header.crossHairActive?($("#cross").removeClass("fa-close"),$("#cross").addClass("fa-crosshairs"),$("#search-zonaNombre").val(""),$("#search-zonaNombre").prop("disabled",!1),gmwa.components.header.crossHairActive=!1,gmwa.storage.remove("_gmwa_nm")):gmwa.components.header.activateNearMe()}),!gmwa.storage.isEmpty("_gmwa_nm"))){try{$lastZoneData=gmwa.storage.get("_gmwa_nm")}catch(e){gmwa.logger.error("Header|Exception catched loading lastZoneData!"),gmwa.logger.error(e),gmwa.storage.remove("_gmwa_nm")}300<=(new Date).getTime()/1e3-$lastZoneData.timestamp?(gmwa.logger.log("Header|Refreshing lastZonaData..."),gmwa.components.header.activateNearMe()):(gmwa.logger.log("Header|Using cached lastZonaData..."),gmwa.components.header.coords=$lastZoneData.coords,$("#cross").removeClass("fa-crosshairs"),$("#cross").addClass("fa-close"),$("#search-zonaNombre").val($lastZoneData.zoneName),$("#search-zonaNombre").prop("disabled",!0),gmwa.components.header.crossHairActive=!0)}},gmwa.components.header.activateNearMe=function(){gmwa.components.header.getNearMe(function(e){e&&($("#cross").removeClass("fa-crosshairs"),$("#cross").addClass("fa-close"),$("#search-zonaNombre").val(e),$("#search-zonaNombre").prop("disabled",!0),e={zoneName:e,coords:{latitude:gmwa.components.header.coords.latitude,longitude:gmwa.components.header.coords.longitude},timestamp:(new Date).getTime()/1e3},gmwa.storage.set("_gmwa_nm",JSON.stringify(e)),gmwa.components.header.crossHairActive=!0)})},gmwa.components.header.getNearMe=function(t){navigator.geolocation.getCurrentPosition(function(o){gmwa.components.header.coords=o.coords,$.ajax({url:"/zonanearestcoords/"+o.coords.latitude+"/"+o.coords.longitude,contentType:"application/json; charset=utf-8"}).done(function(e){null!=e?t(e.nmz):(gmwa.logger.error("No zone found for coords: "+o.coords.latitude+" , "+o.coords.longitude),t(null))}).fail(function(e){gmwa.logger.error("Error getting zone for coords: "+o.coords.latitude+" , "+o.coords.longitude),gmwa.logger.error(e),t(null)})})},gmwa||{}),gmwa=(gmwa.components=gmwa.components||{},gmwa.components.listadoRZ={},gmwa.components.listadoRZ.init=function(){gmwa.logger.log("ListadoRZ|Init..."),$(".listado-rubro li, .listado-zona li").on("click",function(){$(this).parents("ul:first").find("li").removeClass("check"),$(this).addClass("check")})},gmwa||{}),gmwa=(gmwa.components=gmwa.components||{},gmwa.components.maps={},gmwa.components.maps.GMaps={},gmwa.components.maps.LMaps={},gmwa.components.maps.downloadDeferred=function(e){var o=document.createElement("div"),o=(o.innerHTML='<link rel="stylesheet" type="text/css" href="/js/vendors/leaflet2/leaflet.css">',document.body.appendChild(o),document.createElement("script"));o.src="/js/vendors/leaflet2/leaflet.js",o.onload=function(){e()},document.body.appendChild(o)},gmwa.components.maps.LMaps.initMap=function(e,o,t,r,a){var n=$("#"+e);if(0!=n.length)return n=r,r=new L.Map(e),e=new L.TileLayer("https://maps.tingelmar.com/osm_tiles/{z}/{x}/{y}.png",{minZoom:7,maxZoom:18,attribution:"Map Data &#9400 OpenStreetMap contributors"}),o=parseFloat(o),t=parseFloat(t),r.setView(new L.LatLng(o,t),n),r.addLayer(e),r},gmwa.components.maps.LMaps.initMapAsync=function(e,o,t,r,a,n){"undefined"==typeof L?gmwa.components.maps.downloadDeferred(function(){n(gmwa.components.maps.LMaps.initMap(e,o,t,r,a))}):n(gmwa.components.maps.LMaps.initMap(e,o,t,r,a))},gmwa.components.maps.LMaps.addMarkerSimple=function(e,o,t){o=new L.marker([parseFloat(o),parseFloat(t)]);return o.addTo(e),o},gmwa.components.maps.LMaps.addMarkerDraggable=function(e,o,t){o=new L.marker([parseFloat(o),parseFloat(t)],{draggable:"true"});return o.addTo(e),o},gmwa.components.maps.GMaps.initMap=function(e,o,t,r,a){e=$("#"+e);if(0!=e.length)return o=new google.maps.LatLng(o,t),t=a?{zoom:r,center:o,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!1,scrollwheel:!1,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}}:{zoom:r,center:o,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!0,scrollwheel:!0,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}},new google.maps.Map(e[0],t)},gmwa.components.maps.GMaps.addMarkerSimple=function(e,o,t){o=new google.maps.LatLng(o,t);return new google.maps.Marker({position:o,map:e})},gmwa.components.maps.init=function(e){gmwa.components.maps.instance=0==e?gmwa.components.maps.GMaps:gmwa.components.maps.LMaps},gmwa||{});gmwa.components=gmwa.components||{},gmwa.components.videoviewer={},gmwa.components.videoviewer.init=function(){gmwa.logger.log("VideoViewer|Init 2..."),$("a.itemVideo").on("click",function(e){e.preventDefault();function o(e){$("#galviewer").remove(),$(document).off("keydown")}e='<div id="galviewer"><i class="fa fa-times gal-close" aria-hidden="true"></i><div id="gal-cntr" class="gal-cntr" style="padding-right:0px"><iframe id="galvid" type="text/html"   src="https://www.youtube.com/embed/'+this.dataset.id+'?autoplay=1&loop=0&rel=0"  frameborder="0"/>';$(document.body).append(e);$("#galviewer").on("click",function(e){o()}).children().click(function(e){return!1}),$(".gal-close").on("click",function(e){o()}),$(document).on("keydown",function(e){27===e.which&&(o(),e.preventDefault())})})},gmwa.controllers=gmwa.controllers||{},gmwa.controllers.comercio={},gmwa.controllers.comercio.toggleFav=null,gmwa.controllers.comercio.init=function(){gmwa.logger.log("Comercio|Init..."),$("div.ver-condiciones").on("click",function(e){e.preventDefault();var o=$(this).find("a:first");$(this).next("div.condiciones:first").toggle(0,function(){$("div.condiciones:first").is(":visible")?o.text("Ocultar condiciones"):o.text("Ver condiciones")})}),gmwa.components.header.init(),gmwa.components.videoviewer.init(),gmwa.utils.isMobile()&&gmwa.controllers.comercio.initKeenSlider(),gmwa.controllers.comercio.buildSpecialHoursStatus(),gmwa.controllers.comercio.smiImg=document.getElementById("smiImg"),gmwa.controllers.comercio.smiImg?gmwa.controllers.comercio.smiImg.addEventListener("click",function(e){gmwa.controllers.comercio.initializeMap()}):gmwa.controllers.comercio.initializeMap(),gmwa.controllers.comercio.updateMailData(),gmwa.controllers.comercio.inlineSpinner=document.getElementById("btnFastLoginNext2Spin"),$("#bookSave").click(function(e){e.preventDefault(),null==gmwa.controllers.comercio.toggleFav&&(gmwa.controllers.comercio.toggleFav=$(this).data("saved")),"1"==gmwa.controllers.comercio.toggleFav?($(this).prop("disabled",!0),gmwa.controllers.comercio.toggleFavorite($("#ficha").data("idr"),$("#ficha").data("ids"),"del",function(e){e&&($("#bookSave").html('<i class="fa fa-bookmark-o" aria-hidden="true"></i> Guardar'),$("#bookSave").prop("disabled",!1),gmwa.controllers.comercio.toggleFav="0")})):($(this).prop("disabled",!0),gmwa.controllers.comercio.toggleFavorite($("#ficha").data("idr"),$("#ficha").data("ids"),"add",function(e){e&&($("#bookSave").html('<i class="fa fa-bookmark" aria-hidden="true"></i> Guardado'),$("#bookSave").prop("disabled",!1),gmwa.controllers.comercio.toggleFav="1")}))}),$("#commentBtn").click(function(e){e.preventDefault(),gmwa.controllers.comercio.doReview()}),$("#btnLike").click(function(e){e.preventDefault(),null!=gmwa.controllers.comercio.commentLike&&0!=gmwa.controllers.comercio.commentLike||($("#btnLike").addClass("btnLikeSelected"),$("#btnDisLike").removeClass("btnDislikeSelected"),gmwa.controllers.comercio.commentLike=!0)}),$("#btnDisLike").click(function(e){e.preventDefault(),null!=gmwa.controllers.comercio.commentLike&&1!=gmwa.controllers.comercio.commentLike||($("#btnDisLike").addClass("btnDislikeSelected"),$("#btnLike").removeClass("btnLikeSelected"),gmwa.controllers.comercio.commentLike=!1)}),$("#btn-getdir").click(function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","Directions",o),gmwa.controllers.comercio.openDirections(e)}),$(".retact-def-btn a").each(function(e){$(this).attr("href")&&("0"==$(this).attr("data-type")?$(this).on("click",function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","DF-Call",o)}):"1"==$(this).attr("data-type")?$(this).on("click",function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","DF-SMS",o)}):"2"==$(this).attr("data-type")?$(this).on("click",function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","DF-WA",o)}):"3"==$(this).attr("data-type")&&$(this).on("click",function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","DF-UB",o)}))}),$(".retact-btn a").each(function(e){$(this).attr("href")&&("tel:"==$(this).attr("href").substr(0,4)?$(this).on("click",function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","Call",o)}):"http:"==$(this).attr("href").substr(0,5)?$(this).on("click",function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","Web",o)}):"mailto:"==$(this).attr("href").substr(0,7)?$(this).on("click",function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","Mail",o)}):"sms:"==$(this).attr("href").substr(0,4)&&$(this).on("click",function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","SMS",o)}))}),$("#snets").click(function(e){var o=$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids"),t=$(this).attr("data-net");gmwa.utils.sendGAEvent("Profile","SNET"+t,o)}),navigator.share?($("#btnShareMenu").hide(),$("#btnShare").click(function(e){e.preventDefault(),e.stopPropagation();e={name:$("#ficha").attr("data-name"),text:$("#locAdr").text().trim(),url:window.location.href};gmwa.controllers.comercio.sendShareEvent("native"),navigator.share({title:e.name,text:e.name+" | "+e.text,url:e.url}).then(function(){}).catch(function(e){console.log("Error sharing",e)})})):($("#btnShare").click(function(e){gmwa.controllers.comercio.shareOpened?($("#shareModal").foundation("close"),gmwa.controllers.comercio.shareOpened=!0):($("#shareModal").foundation("open"),gmwa.controllers.comercio.shareOpened=!1)}),$(".sharerpanel a").each(function(){$(this).on("click",function(e){gmwa.controllers.comercio.sendShareEvent($(this).text())})}))},gmwa.controllers.comercio.updateMailData=function(){var e="info@1122.com.uy",o="1122",t=$(".infoFicha .title").text(),o=(0<=window.location.hostname.toLowerCase().indexOf("buscoinfo")&&(e="feedback@buscoinfo.com.py",o="BuscoInfo"),"Mensaje a "+o+" | "+t),t="mailto:"+e;t+="?subject="+o+"&body=-----"+o,$("#fContactEmail").attr("href",t)},gmwa.controllers.comercio.initializeGoogleMap=function(){var e,o,t,r=$("#mapa");0!=r.length&&(e=r.data("lat"),o=r.data("lng"),t=r.data("im"),""!=e)&&""!=o&&0!=e&&0!=o&&(e=new google.maps.LatLng(e,o),o=t?{zoom:15,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!1,scrollwheel:!1,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}}:{zoom:15,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!0,scrollwheel:!0,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}},t=new google.maps.Map(r[0],o),new google.maps.Marker({position:e,map:t}))},gmwa.controllers.comercio.initializeMap=function(){var e=$("#mapa"),o=e.data("lat"),t=e.data("lng"),e=e.data("im");""==o||""==t||0==o||0==t||isNaN(o)||isNaN(t)||(gmwa.logger.log("Initializing Maps..."),gmwa.components.maps.instance.initMapAsync("mapa",o,t,16,e,function(e){gmwa.controllers.comercio.map=e,gmwa.components.maps.instance.addMarkerSimple(gmwa.controllers.comercio.map,o,t),gmwa.controllers.comercio.smiImg&&(gmwa.controllers.comercio.smiImg.style.display="none")}))},gmwa.controllers.comercio.enhanceHoursCalulateDelta=function(e,o){return hHourOpens=parseInt(e/100),hHour=parseInt(o/100),hHourOpens==hHour?e-o:e-o-40},gmwa.controllers.comercio.convertDateToString=function(e,o){return o?e.format("dddd D [de] MMMM"):e.format("D [de] MMMM")},gmwa.controllers.comercio.buildHourLabel=function(e){var o=parseInt(e);return o<100?10<=o?"00:"+e:"00:0"+e:e.slice(0,-2)+":"+e.slice(-2,8)},gmwa.controllers.comercio.buildSpecialHoursStatus=function(){var e,o,t={color:"darkorange",text:"text",show:!0,htext:"text",specialDate:null},r=window.hrsps,a=null;a=(a=new Date).getFullYear()+"-"+(0+String(a.getMonth()+1)).slice(-2)+"-"+(0+String(a.getDate())).slice(-2),r.length&&(t.color="#7CB342",a=dayjs(r[0].d+" 00:00:00"),t.specialDate=gmwa.controllers.comercio.convertDateToString(a,!0),r[0].dsc&&(t.specialDate=r[0].dsc+", "+gmwa.controllers.comercio.convertDateToString(a,!0)),r[0].cf?(r[0].hp?(e=" abierto de ",o=[],r[0].hp.forEach(function(e){o.push(gmwa.controllers.comercio.buildHourLabel(e.start)+" a "+gmwa.controllers.comercio.buildHourLabel(e.end))}),e+=o.join(", ")):(e=" cerrado",t.color="#FF5722"),r[0].dsc?t.htext=gmwa.controllers.comercio.convertDateToString(a,!0)+' "'+r[0].dsc+'" '+e:t.htext=gmwa.controllers.comercio.convertDateToString(a,!0)+e):(t.color="#a96500",(new Date).getDay()==parseInt(a.format("d"))?t.htext="El horario de hoy puede variar":t.htext="El horario para el "+gmwa.controllers.comercio.convertDateToString(a,!0)+(r[0].dsc?" "+r[0].dsc:"")+" puede variar"),$("#horarioEspecial").append($('<div style="color: '+t.color+'">'+t.htext+"</div>")))},gmwa.controllers.comercio.enhanceHours=function(){var e,o=!1,t="...",r="",a=new Date,n=100*a.getHours()+a.getMinutes(),l=-1,s=-1;$("#hoursIsToday").children(0).children(1).each(function(){l=$(this).data("start"),e=$(this).data("end"),(dayIsOpen=$(this).parent().data("isopen"))&&!o&&(n<l?(r=n<e&&e<l?(t="<span style='color:#2f7733;font-weight: 100;'>(abierto)</span>","<span style='color:#2f7733;'>Ahora abierto</span>"):(s=gmwa.controllers.comercio.enhanceHoursCalulateDelta(l,n))<100?(t="<span style='color:#cc362b;font-weight: 100;'>(abre en "+s+" mins)</span>","<span style='color:#cc362b;'>Ahora cerrado </span><span> (abre en "+s+" mins)</span>"):(t="<span style='color:#cc362b;font-weight: 100;'>(cerrado)</span>","<span style='color:#cc362b;'>Ahora cerrado </span><span> (abre hoy a las "+(l=[(l+="").slice(0,-2),":",l.slice(-2)].join(""))+")</span>"),o=!0):l<n&&n<e?(s=gmwa.controllers.comercio.enhanceHoursCalulateDelta(e,n),r=s<100?(t="<span style='color:#c74802;font-weight: 100;'>(cierra en "+s+" mins)</span>","<span style='color:#c74802'>Ahora abierto </span><span> (cierra en "+s+" mins)</span>"):(t="<span style='color:#2f7733;font-weight: 100;'>(abierto)</span>","<span style='color:#2f7733'>Ahora abierto</span>"),o=!0):e<l&&l<n&&n<2400?(t="<span style='color:#2f7733;font-weight: 100;'>(abierto)</span>",r="<span style='color:#2f7733;'>Ahora abierto</span>",o=!0):(t="<span style='color:#cc362b;font-weight: 100;'>(cerrado)</span>",r="<span style='color:#cc362b'>Ahora cerrado</span>"))});var i=0==(i=a.getDay())?6:i-1;if(!o)for(var r="<span style='color:#F44336;'>Ahora cerrado</span>",c=1+i,d=$(".hours-table>tbody>tr"),m=null,g=null,u=0;u<d.length;u++)if(c>=d.length-1&&(c=0),0<(m=d.eq(c)).children().eq(1).children().length){g=[(g=m.children().eq(1).children().eq(0).data("start")+"").slice(0,-2),":",g.slice(-2)].join(""),r+=i==c?" <span> (abre hoy a las "+g+")</span>":c-i==1?" <span> (abre mañana a las "+g+")</span>":" <span> (abre el "+m.children().eq(0).text()+" a las "+g+")</span>";break}$("#hoursIsToday td:nth-child(2)").append($("<div style='display: block;'>"+t+"<div>")),$(".horario").append($(r))},gmwa.controllers.comercio.toggleFavorite=function(e,o,t,r){$.ajax({type:"POST",url:"/local/fav",data:JSON.stringify({op:t,retailer:e,store:o}),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){"0"==e.outcode?r(!0):(999==e.outcode?gmwa.utils.showError("Inicia sesión","Para poder guardar tus lugares favoritos"):gmwa.logger.error("toggleFavorite | Server returned "+e.outcode+" ("+e.outmsg+")"),r(!1))}).fail(function(e){gmwa.logger.error("toggleFavorite | API returned error: "+JSON.stringify(e)),r(!1)})},gmwa.controllers.comercio.sendReview=function(e,o){$.ajax({type:"POST",url:"/local/comment",data:JSON.stringify(e),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){"0"==e.outcode?o(!0):(999==e.outcode?gmwa.utils.showError("Inicia sesión","Para poder agregar comentarios"):gmwa.logger.error("sendReview | Server returned "+e.outcode+" ("+e.outmsg+")"),o(!1))}).fail(function(e){gmwa.logger.error("sendReview | API returned error: "+JSON.stringify(e)),o(!1)})},gmwa.controllers.comercio.sendReviewAndLike=function(e,o){gmwa.controllers.comercio.initFastLogin(e,o);var t=document.querySelector("#ficha").getAttribute("data-username");t&&0<t.length?gmwa.controllers.comercio.doSendReviewAndLike(e,o):$("#fastLoginModal").foundation("open")},gmwa.controllers.comercio.doSendReviewAndLike=function(e,o){$.ajax({type:"POST",url:"/local/commentLike",data:JSON.stringify(e),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){"0"==e.outcode||"139"==e.outcode?o(e):(999==e.outcode?gmwa.utils.showError("Inicia sesión","Para poder agregar comentarios"):151==e.outcode?gmwa.utils.showError("No se pudo iniciar sesión","El usuario o la contraseña no son los correctos"):gmwa.logger.error("sendReviewAndLike | Server returned "+e.outcode+" ("+e.outmsg+")"),o(!1))}).fail(function(e){gmwa.logger.error("sendReviewAndLike | API returned error: "+JSON.stringify(e)),o(!1)})},gmwa.controllers.comercio.initFastLogin=function(e,t){gmwa.controllers.comercio.lblflEmail||(gmwa.controllers.comercio.flDesc=document.getElementById("flDesc"),gmwa.controllers.comercio.flErr=document.getElementById("flErr"),gmwa.controllers.comercio.lblflEmail=document.getElementById("lblflEmail"),gmwa.controllers.comercio.flEmail=document.getElementById("flEmail"),gmwa.controllers.comercio.lblflName=document.getElementById("lblflName"),gmwa.controllers.comercio.flName=document.getElementById("flName"),gmwa.controllers.comercio.lblflPass=document.getElementById("lblflPass"),gmwa.controllers.comercio.flPass=document.getElementById("flPass"),gmwa.controllers.comercio.btnFastLoginNext1=document.getElementById("btnFastLoginNext1"),gmwa.controllers.comercio.btnFastLoginNext2=document.getElementById("btnFastLoginNext2"),gmwa.controllers.comercio.btnFastLoginNext1.addEventListener("click",function(e){gmwa.controllers.comercio.fastLoginFormMove(1),gmwa.controllers.comercio.flEmail.value&&0!=gmwa.controllers.comercio.flEmail.value.length&&gmwa.utils.isEmail(gmwa.controllers.comercio.flEmail.value)?(gmwa.controllers.comercio.fastLoginFormMailExists=!1,$.ajax({type:"GET",url:"/checkuser/"+encodeURIComponent(gmwa.controllers.comercio.flEmail.value),contentType:"application/json; charset=utf-8"}).done(function(e){e?(gmwa.controllers.comercio.fastLoginFormMove(2),e.exists?(gmwa.controllers.comercio.fastLoginFormMailExists=!0,gmwa.controllers.comercio.fastLoginFormMove(3)):gmwa.controllers.comercio.fastLoginFormMove(4),gmwa.controllers.comercio.btnFastLoginNext2.style.display="block"):(gmwa.utils.showError("Verificación de correo","No se pudo verificar el correo, por favor inténtelo más tarde."),gmwa.controllers.comercio.fastLoginFormMove(0),t(!1))}).fail(function(e){gmwa.controllers.comercio.fastLoginFormMove(0),gmwa.utils.showError("Verificación de correo","No se pudo verificar el correo, por favor inténtelo más tarde. [2]"),t(!1)})):(gmwa.controllers.comercio.fastLoginFormMove(0),gmwa.controllers.comercio.fastLoginShowError("Ingrese una dirección de correo electrónico válido"))}),gmwa.controllers.comercio.btnFastLoginNext2.addEventListener("click",function(){gmwa.controllers.comercio.fastLoginFormMailExists||gmwa.controllers.comercio.flName.value&&!(gmwa.controllers.comercio.flName.value.length<3)?!gmwa.controllers.comercio.flPass.value||gmwa.controllers.comercio.flPass.value.length<4?(gmwa.controllers.comercio.fastLoginFormMailExists?gmwa.controllers.comercio.fastLoginFormMove(3):gmwa.controllers.comercio.fastLoginFormMove(4),gmwa.controllers.comercio.fastLoginShowError("Ingrese una contraseña válida")):(e.name=gmwa.controllers.comercio.flName.value,e.email=encodeURIComponent(gmwa.controllers.comercio.flEmail.value),e.password=gmwa.controllers.comercio.flPass.value,gmwa.controllers.comercio.fastLoginFormMove(5),gmwa.controllers.comercio.doSendReviewAndLike(e,function(e){var o;e?(o=new Date(1e3*e.r.user.cookieTTL),document.cookie=e.r.user.cookieName+"="+e.r.user.token+"; expires="+o.toUTCString()+"; path=/",gmwa.controllers.comercio.fastLoginFormMove(0),$("#fastLoginModal").foundation("close"),t(e)):gmwa.controllers.comercio.fastLoginFormReset()})):(gmwa.controllers.comercio.fastLoginFormMove(4),gmwa.controllers.comercio.fastLoginShowError("Ingrese un nombre"))}))},gmwa.controllers.comercio.fastLoginFormReset=function(){gmwa.controllers.comercio.btnFastLoginNext1.style.display="block",gmwa.controllers.comercio.btnFastLoginNext2.style.display="none",gmwa.controllers.comercio.flDesc.innerText="Para poder enviar tu comentario es necesario inciar sesión",gmwa.controllers.comercio.flDesc.style.display="block",gmwa.controllers.comercio.lblflPass.style.display="none",gmwa.controllers.comercio.flPass.style.display="none",gmwa.controllers.comercio.lblflEmail.style.display="block",gmwa.controllers.comercio.flEmail.style.display="block",gmwa.controllers.comercio.btnFastLoginNext1.disabled=!1,gmwa.controllers.comercio.btnFastLoginNext2.disabled=!1,gmwa.controllers.comercio.flName.disabled=!1,gmwa.controllers.comercio.flPass.disabled=!1,gmwa.controllers.comercio.flEmail.disabled=!1,gmwa.controllers.comercio.inlineSpinner.style.display="none",$("#commentMsg").prop("disabled",!1),$("#commentBtn").prop("disabled",!1)},gmwa.controllers.comercio.fastLoginFormMove=function(e){gmwa.controllers.comercio.flErr.style.display="none",0==e?(gmwa.controllers.comercio.lblflEmail.style.display="block",gmwa.controllers.comercio.flEmail.style.display="block",gmwa.controllers.comercio.btnFastLoginNext1.style.display="block",gmwa.controllers.comercio.flEmail.disabled=!1,gmwa.controllers.comercio.btnFastLoginNext1.disabled=!1):1==e?(gmwa.controllers.comercio.flEmail.disabled=!0,gmwa.controllers.comercio.btnFastLoginNext1.disabled=!0):2==e?(gmwa.controllers.comercio.lblflEmail.style.display="none",gmwa.controllers.comercio.flEmail.style.display="none",gmwa.controllers.comercio.btnFastLoginNext1.style.display="none"):3==e?(gmwa.controllers.comercio.flDesc.innerText="Ya existe una cuenta con ese correo, ingresa tu contraseña para continuar",gmwa.controllers.comercio.flDesc.style.display="block",gmwa.controllers.comercio.lblflPass.style.display="block",gmwa.controllers.comercio.flPass.style.display="block",gmwa.controllers.comercio.btnFastLoginNext2.style.display="block"):4==e?(gmwa.controllers.comercio.flDesc.innerText="No existe una cuenta con ese correo, ingresa tu nombre y una contraseña para continuar",gmwa.controllers.comercio.flDesc.style.display="block",gmwa.controllers.comercio.lblflName.style.display="block",gmwa.controllers.comercio.flName.style.display="block",gmwa.controllers.comercio.lblflPass.style.display="block",gmwa.controllers.comercio.flPass.style.display="block",gmwa.controllers.comercio.btnFastLoginNext2.style.display="block"):5==e&&(gmwa.controllers.comercio.lblflName.disabled=!0,gmwa.controllers.comercio.flName.disabled=!0,gmwa.controllers.comercio.lblflPass.disabled=!0,gmwa.controllers.comercio.flPass.disabled=!0,gmwa.controllers.comercio.btnFastLoginNext2.disabled=!0)},gmwa.controllers.comercio.fastLoginShowError=function(e){gmwa.controllers.comercio.flErr.innerText=e,gmwa.controllers.comercio.flErr.style.display="block"},gmwa.controllers.comercio.doReview=function(){var e={},o=(e.body=$("#commentMsg").val(),e.retailer=$("#ficha").data("idr"),e.store=$("#ficha").data("ids"),e.like=gmwa.controllers.comercio.commentLike,$("#ficha").data("name"));null==e.body||0==e.body.length?$("#commentErrMsg").html("Ingresa tu comentario para poder enviarlo"):($("#commentErrMsg").html(""),null==e.like?$("#commentErrMsg").html("Selecciona si recomiendas este lugar"):(gmwa.logger.info("sendReview | Sending review ..."),gmwa.controllers.comercio.inlineSpinner.style.display="inline",$("#commentMsg").prop("disabled",!0),$("#commentBtn").prop("disabled",!0),gmwa.controllers.comercio.sendReviewAndLike(e,function(e){e&&0==e.outcode?$("#cmntCntr").html('<div style="padding: 40px 0px 80px 0px;text-align:center"><svg style="width: 45px;height: 45px;margin: 10px 0px;fill: #9e9e9e;" height="511pt" viewBox="1 0 511 511.99995" width="511pt" xmlns="http://www.w3.org/2000/svg"><path d="m450.675781 125.457031-63.636719-63.636719-118.496093 119.488282 63.648437 63.644531zm0 0"/><path d="m211.527344 282.316406c-5.152344 12.371094 7.269531 24.777344 19.632812 19.609375l76.175782-39.40625-56.4375-56.4375zm0 0"/><path d="m508.105469 68.027344c5.859375-5.859375 5.859375-15.355469 0-21.214844l-42.421875-42.417969c-5.859375-5.859375-15.355469-5.859375-21.214844 0l-36.214844 36.214844 63.632813 63.636719zm0 0"/><path d="m45.5 421h15v76c0 6.0625 3.648438 11.542969 9.257812 13.855469 5.527344 2.308593 12.015626 1.078125 16.347657-3.25l86.605469-86.605469h174.789062c24.8125 0 45-20.1875 45-45v-148.933594l-47.316406 47.316406c-4.128906 4.132813-8.949219 7.382813-14.355469 9.652344l-85.882813 44.53125c-7.808593 3.371094-13.667968 4.558594-19.644531 4.558594-4.464843 0-8.769531-.859375-12.929687-2.125h-106.871094c-8.292969 0-15-6.710938-15-15 0-8.292969 6.707031-15 15-15h75.957031c-2.960937-9.820312-1.691406-20.457031 2.390625-30.21875l46.289063-89.898438c1.316406-3.324218 4.570312-8.160156 8.6875-12.273437l47.609375-47.609375h-240.933594c-24.8125 0-45 20.1875-45 45v210c0 24.8125 20.1875 45 45 45zm0 0"/></svg><div style="font-weight: 600;font-size: 18px;">Gracias por tu opinión!</div><div style="">Tu comentario será agregado al perfil de '+o+" en las próximas 24 horas</div></div>"):e&&139==e.outcode?$("#cmntCntr").html('<div style="padding: 40px 0px 80px 0px;text-align:center"><svg style="width: 45px;height: 45px;margin: 10px 0px;fill: #9e9e9e;" height="511pt" viewBox="1 0 511 511.99995" width="511pt" xmlns="http://www.w3.org/2000/svg"><path d="m450.675781 125.457031-63.636719-63.636719-118.496093 119.488282 63.648437 63.644531zm0 0"/><path d="m211.527344 282.316406c-5.152344 12.371094 7.269531 24.777344 19.632812 19.609375l76.175782-39.40625-56.4375-56.4375zm0 0"/><path d="m508.105469 68.027344c5.859375-5.859375 5.859375-15.355469 0-21.214844l-42.421875-42.417969c-5.859375-5.859375-15.355469-5.859375-21.214844 0l-36.214844 36.214844 63.632813 63.636719zm0 0"/><path d="m45.5 421h15v76c0 6.0625 3.648438 11.542969 9.257812 13.855469 5.527344 2.308593 12.015626 1.078125 16.347657-3.25l86.605469-86.605469h174.789062c24.8125 0 45-20.1875 45-45v-148.933594l-47.316406 47.316406c-4.128906 4.132813-8.949219 7.382813-14.355469 9.652344l-85.882813 44.53125c-7.808593 3.371094-13.667968 4.558594-19.644531 4.558594-4.464843 0-8.769531-.859375-12.929687-2.125h-106.871094c-8.292969 0-15-6.710938-15-15 0-8.292969 6.707031-15 15-15h75.957031c-2.960937-9.820312-1.691406-20.457031 2.390625-30.21875l46.289063-89.898438c1.316406-3.324218 4.570312-8.160156 8.6875-12.273437l47.609375-47.609375h-240.933594c-24.8125 0-45 20.1875-45 45v210c0 24.8125 20.1875 45 45 45zm0 0"/></svg><div style="">Tu comentario para '+o+" ya fue enviado y será publicado en las siguientes 24 horas</div></div>"):gmwa.utils.showError("Ocurrió un error","No fue posible procesar su comentario en este momento."),$("#commentBtn #galspinner").remove(),$("#cmntsEmpty").remove(),$("#commentMsg").prop("disabled",!1),$("#commentBtn").prop("disabled",!1)})))},gmwa.controllers.comercio.sendLike=function(e,o){$.ajax({type:"POST",url:"/local/like",data:JSON.stringify(e),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){"0"==e.outcode?o(!0):(999==e.outcode?gmwa.utils.showError("Inicia sesión","Para poder recomendar un lugar"):gmwa.logger.error("sendLike | Server returned "+e.outcode+" ("+e.outmsg+")"),o(!1))}).fail(function(e){gmwa.logger.error("sendLike | API returned error: "+JSON.stringify(e)),o(!1)})},gmwa.controllers.comercio.doLike=function(e){var t={};t.retailer=$("#ficha").data("idr"),t.store=$("#ficha").data("ids"),t.recommend=e?1:0,$("#commentLike").prop("disabled",!0),$("#commentDislike").prop("disabled",!0),gmwa.logger.info("sendLike | Sending like to idr="+t.retailer+", ids="+t.store+", like="+t.recommend+"..."),gmwa.controllers.comercio.sendLike(t,function(e){var o;e?1==t.recommend?(o='Haz recomendado este lugar <i class="fa fa-thumbs-o-up" aria-hidden="true"></i><div id="commentStopLike"><small><i class="fa fa-thumbs-o-down" aria-hidden="true"></i> Dejar de recomendar</small></div>',$("#liked").html(o),$("#commentStopLike").click(function(e){gmwa.controllers.comercio.doLike(!1)})):(o='No recomiendas este lugar <i class="fa fa-thumbs-o-down" aria-hidden="true"></i><div id="commentStartLike"><small><i class="fa fa-thumbs-o-up" aria-hidden="true"></i> Empezar a recomendar</small></div>',$("#liked").html(o),$("#commentStartLike").click(function(e){gmwa.controllers.comercio.doLike(!0)})):(gmwa.utils.showError("Ocurrió un error","No fue posible procesar su comentario en este momento."),$("#liked #galspinner").remove()),$("#commentLike").prop("disabled",!1),$("#commentDislike").prop("disabled",!1)})},gmwa.controllers.comercio.openDirections=function(e){e.preventDefault();var e=$("#btn-getdir").data("addr"),o=$("#btn-getdir").data("lat"),t=$("#btn-getdir").data("lon"),r="",r=-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPad")||-1!=navigator.platform.indexOf("iPod")?encodeURI("maps://maps.google.com/maps?daddr="+o+","+t+"&amp;ll="):e&&0<e.length?encodeURI("https://maps.google.com/maps?daddr="+e+"@"+o+","+t+"&amp;ll="):encodeURI("https://maps.google.com/maps?daddr="+o+","+t+"&amp;ll=");window.open(r)},gmwa.controllers.comercio.sendShareEvent=function(e){e=e+"|"+$("#ficha").data("name")+"|"+$("#ficha").data("idr")+"|"+$("#ficha").data("ids");gmwa.utils.sendGAEvent("Profile","Share",e)},gmwa.controllers.comercio.coversCarrousel=null,gmwa.controllers.comercio.coversCarrouselInterval=0,gmwa.controllers.comercio.initKeenSlider=function(){gmwa.controllers.comercio.coversCarrouselInterval=0;var e=document.getElementById("keenCovers");e&&(gmwa.controllers.comercio.coversCarrousel=new KeenSlider(e,{loop:!0,duration:1e3,dragStart:function(){gmwa.controllers.comercio.carrouselAutoplay(!1)},dragEnd:function(){gmwa.controllers.comercio.carrouselAutoplay(!0)},created:function(){e.style.display="flex",document.querySelectorAll(".keen-slider__slide").forEach(function(e,o){0<o&&(e.style.display="block")})},slideChanged:function(e){var t=e.details().relativeSlide;document.querySelectorAll(".story-dot ").forEach(function(e,o){o==t?e.classList.add("story-dot--active"):e.classList.remove("story-dot--active")})}}),gmwa.controllers.comercio.carrouselAutoplay(!0))},gmwa.controllers.comercio.carrouselAutoplay=function(e){clearInterval(gmwa.controllers.comercio.coversCarrouselInterval),gmwa.controllers.comercio.coversCarrouselInterval=setInterval(function(){e&&gmwa.controllers.comercio.coversCarrousel&&gmwa.controllers.comercio.coversCarrousel.next()},5e3)};var gmwa,gmwa,gmwa,gmwa,gmwa,gmwa,gmwa,gmwa,gmwa,gmwa,gmwa}(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.contact={},gmwa.controllers.contact.init=function(){gmwa.logger.log("Contact|Init..."),gmwa.components.header.init();var e=document.createElement("script");e.src="/js/vendors/parsley/i18n/es.js",e.onload=function(){var e=document.createElement("script");e.src="/js/vendors/parsley/parsley.min.js",e.onload=function(){window.ParsleyValidator.setLocale("es");var t=!1,r=document.getElementById("contactForm"),a=document.getElementById("btnSend");$("#contactForm").parsley(),$.listen("parsley:form:validated",function(e){var o;$.each(e.fields,function(e,o){var t=o.$element.next("ul.parsley-errors-list:first");o.$element.parents("div:first").find("small.error:first").hide(),t.find("li:first").length&&(t=t.find("li:first").text(),o.$element.parents("div:first").find("small.error:first").text(t).show(),t=o.$element.data("parsley-id"),$("#parsley-id-"+t).show())}),!t&&e.isValid()&&(e.validationResult=!1,$("#btnSend").prop("disabled",!0),$("#btnSend").text("Enviando..."),o=null,o=0<=window.location.hostname.toLowerCase().indexOf("buscoinfo")?(console.info("Sending as BI"),"6LfzeqEaAAAAAFmSgGiocTLX0ObFqJJ_JzXDpQHB"):(console.info("Sending as GM"),"6LcIPzwUAAAAAEAKqChvPCt0sx_y03vZM4GiiX5Y"),o=grecaptcha.render(a,{sitekey:o,size:"invisible",callback:function(){e.validationResult=!0,r.submit()}}),grecaptcha.reset(o),grecaptcha.execute(o),t=!0)})},document.body.appendChild(e)},document.body.appendChild(e),$(document).on("submit","form",function(){$("#btnSend").prop("disabled",!0),$("#btnSend").text("Enviando...")}),gmwa.logger.log("Contact|Adding referrer as ["+document.referrer+"]"),$("<input>").attr({type:"hidden",id:"refPage",name:"refPage",value:document.referrer}).appendTo("#contactForm")},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.favorites={},gmwa.controllers.favorites.init=function(){$(".savedDelete").click(function(e){var o=$(this).data("fav");gmwa.controllers.comercio.toggleFavorite($(this).data("idr"),$(this).data("ids"),"del",function(e){e&&$("#fav-"+o).remove()})}),gmwa.components.header.init(),$(".btns-rem").each(function(e){$(this).on("click",function(e){e.preventDefault();var o={};o.retailer=$(this).data("idr"),o.store=$(this).data("ids"),o.op="del",$.ajax({type:"POST",url:"/local/fav",data:JSON.stringify(o),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){"0"==e.outcode?$("#fav-"+(1e4*o.retailer+o.store)).remove():gmwa.logger.error("toggleFavorite | Server returned "+e.outcode+" ("+e.outmsg+")")}).fail(function(e){gmwa.logger.error("toggleFavorite | API returned error: "+JSON.stringify(e))})})}),gmwa.controllers.comercio.toggleFavorite=function(e,o,t,r){$.ajax({type:"POST",url:"/local/fav",data:JSON.stringify({op:t,retailer:e,store:o}),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){"0"==e.outcode?r(!0):(999==e.outcode?gmwa.utils.showError("Inicia sesión","Para poder guardar tus lugares favoritos"):gmwa.logger.error("toggleFavorite | Server returned "+e.outcode+" ("+e.outmsg+")"),r(!1))}).fail(function(e){gmwa.logger.error("toggleFavorite | API returned error: "+JSON.stringify(e)),r(!1)})}},gmwa.controllers=gmwa.controllers||{},gmwa.controllers.gals={},gmwa.controllers.gals.init=function(){var e;gmwa.logger.log("Gals|Init..."),gmwa.components.header.init(),gmwa.controllers.gals.buildSpecialHoursStatus(),gmwa.controllers.gals.smiImg=document.getElementById("smiImg"),gmwa.utils.isMobile()?(e=document.getElementById("tabInfo"))&&e.addEventListener("click",function(e){gmwa.controllers.gals.map||(gmwa.controllers.gals.smiImg?gmwa.controllers.gals.smiImg.addEventListener("click",function(e){gmwa.controllers.gals.initializeMap()}):gmwa.controllers.gals.initializeMap())}):gmwa.controllers.gals.smiImg?gmwa.controllers.gals.smiImg.addEventListener("click",function(e){gmwa.controllers.gals.initializeMap()}):gmwa.controllers.gals.initializeMap()},gmwa.controllers.gals.initializeGoogleMap=function(){var e,o,t,r=$("#mapa");0!=r.length&&(e=r.data("lat"),o=r.data("lng"),t=r.data("im"),""!=e)&&""!=o&&0!=e&&0!=o&&(e=new google.maps.LatLng(e,o),o=t?{zoom:15,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!1,scrollwheel:!1,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}}:{zoom:15,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!0,scrollwheel:!0,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}},t=new google.maps.Map(r[0],o),new google.maps.Marker({position:e,map:t}))},gmwa.controllers.gals.initializeMap=function(){var e=$("#mapa"),o=e.data("lat"),t=e.data("lng"),e=e.data("im");""==o||""==t||0==o||0==t||isNaN(o)||isNaN(t)||(gmwa.logger.log("Initializing Maps..."),gmwa.components.maps.instance.initMapAsync("mapa",o,t,16,e,function(e){gmwa.controllers.gals.map=e,gmwa.components.maps.instance.addMarkerSimple(gmwa.controllers.gals.map,o,t),gmwa.controllers.gals.smiImg&&(gmwa.controllers.gals.smiImg.style.display="none")}))},gmwa.controllers.gals.buildSpecialHoursStatus=function(){var e,o,t={color:"darkorange",text:"text",show:!0,htext:"text",specialDate:null},r=window.hrsps,a=null;a=(a=new Date).getFullYear()+"-"+(0+String(a.getMonth()+1)).slice(-2)+"-"+(0+String(a.getDate())).slice(-2),r.length&&(t.color="#7CB342",a=dayjs(r[0].d+" 00:00:00"),t.specialDate=gmwa.controllers.gals.convertDateToString(a,!0),r[0].dsc&&(t.specialDate=r[0].dsc+", "+gmwa.controllers.gals.convertDateToString(a,!0)),r[0].cf?(r[0].hp?(e=" abierto de ",o=[],r[0].hp.forEach(function(e){o.push(gmwa.controllers.gals.buildHourLabel(e.start)+" a "+gmwa.controllers.gals.buildHourLabel(e.end))}),e+=o.join(", ")):(e=" cerrado",t.color="#FF5722"),r[0].dsc?t.htext=gmwa.controllers.gals.convertDateToString(a,!0)+' "'+r[0].dsc+'" '+e:t.htext=gmwa.controllers.gals.convertDateToString(a,!0)+e):(t.color="#FF9800",(new Date).getDay()==parseInt(a.format("d"))?t.htext="El horario de hoy puede variar":t.htext="El horario para el "+gmwa.controllers.gals.convertDateToString(a,!0)+(r[0].dsc?" "+r[0].dsc:"")+" puede variar"),$("#horarioEspecial").append($('<div style="color: '+t.color+'">'+t.htext+"</div>")))},gmwa.controllers.gals.convertDateToString=function(e,o){return o?e.format("dddd D [de] MMMM"):e.format("D [de] MMMM")},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.home={},gmwa.controllers.home.init=function(){gmwa.logger.log("Home|Init...");gmwa.utils.isMobile();$("#mi-home").addClass("u-tb-item-selected"),$("#bPushRegister").click(function(e){gmwa.webpush.subscribe()}),$("#bPushUnregister").click(function(e){gmwa.webpush.unsubscribe()}),gmwa.components.header.init()},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.login={},gmwa.controllers.login.inlineSpinner='<div id="galspinner" class="spinner spinnerInline spinnerWhite"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>',gmwa.controllers.login.init=function(){gmwa.logger.log("Login|Init..."),gmwa.components.header.init(),$("#forgotPassBtn").click(function(e){e.preventDefault(),$("#boxLogin").hide(),$("#boxForgotPass").show()}),$("#reInit").click(function(e){e.preventDefault(),$("#boxForgotPass").hide(),$("#boxLogin").show()}),$("#regreInit").click(function(e){e.preventDefault(),$("#boxRegister").hide(),$("#boxLogin").show()}),$("#gotoRegister").click(function(e){e.preventDefault(),$("#boxLogin").hide(),$("#boxRegister").show()}),$("#btnRecoverPas").click(function(e){e.preventDefault();e=$("#recoverEmail").val();null==e||0==e.length?$("#recoverError").html("Ingrese su direccion de correo electronico para recuperar su contraseña"):(e=encodeURIComponent(e),$.ajax({type:"GET",url:"/resetPass?email="+e}).done(function(e){$("#recoverRequest").hide(),$("#recoverRequested").show()}).fail(function(e){gmwa.logger.error("btnRecoverPas | API returned error: "+JSON.stringify(e)),$("#recoverError").html("No fue posible solicitar la recuperacion en este momento.")}))}),$("#btnRegister").click(function(e){e.preventDefault(),$("#reg_error").text(""),$("#reg_error").hide();var o,t,r,e=$("#reg_email").val();null==e||0==e.length?($("#reg_error").text("Ingrese su direccion de correo electronico"),$("#reg_error").show()):(e=encodeURIComponent(e),null==(o=$("#reg_username").val())||0==o.length?($("#reg_error").text("Ingrese su nombre"),$("#reg_error").show()):null==(t=$("#reg_pass").val())||0==t.length?($("#reg_error").text("Ingrese una contraseña válida"),$("#reg_error").show()):(r={reg_email:e,reg_username:o,reg_pass:t},$("#btnRegister").html("Espere..."),$("#btnRegister").append(gmwa.controllers.login.inlineSpinner),$("#btnRegister").prop("disabled",!0),$.ajax({type:"POST",url:"/register",data:JSON.stringify(r),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){$("#btnRegister").html("Crear usuario"),$("#btnRegister #galspinner").remove(),$("#btnRegister").prop("disabled",!1),console.log(e),999==e.outcode?($("#reg_error").html('<i class="fa fa-exclamation" aria-hidden="true"></i> Ingrese su direccion de correo electronico'),$("#reg_error").show()):998==e.outcode?($("#reg_error").html('<i class="fa fa-exclamation" aria-hidden="true"></i> Ingrese su nombre'),$("#reg_error").show()):997==e.outcode?($("#reg_error").html('<i class="fa fa-exclamation" aria-hidden="true"></i> Ingrese una contraseña válida'),$("#reg_error").show()):142==e.outcode?($("#reg_error").html('<i class="fa fa-exclamation" aria-hidden="true"></i> La dirección de correo ingresada ya está registrada'),$("#reg_error").show()):0==e.outcode?(r.reg_email=decodeURIComponent(r.reg_email),$("#boxRegister").hide(),$("#boxLogin").show(),$("#lblRegOk").html('<strong style="color: #1497d8;"><i class="fa fa-check-circle-o" aria-hidden="true"></i> Bienvenido '+r.reg_username+"!</strong> <br>Por favor inicia sesion con tu clave ahora."),$("#lblRegOk").show(),$("#username").val(r.reg_email)):($("#reg_error").html('<i class="fa fa-exclamation" aria-hidden="true"></i> No es posible realizar el registro en este momento. ('+e.outcode+")"),$("#reg_error").show())}).fail(function(e){$("#btnRegister").html("Crear usuario"),$("#btnRegister #galspinner").remove(),$("#btnRegister").prop("disabled",!1),gmwa.logger.error("btnRegister | API returned error: "+JSON.stringify(e)),$("#reg_error").html('<i class="fa fa-exclamation" aria-hidden="true"></i> No fue posible realizar el registro en este momento.')})))})},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.reportarError={},gmwa.controllers.reportarError.map=null,gmwa.controllers.reportarError.init=function(){gmwa.logger.log("ReportarError|Init..."),gmwa.components.header.init(),$("#vermapa, #lblvermapa").on("click",function(){this.checked?$("#mapaVer").show("fast",function(){var e=parseFloat($("#errorForm").data("lat")),o=parseFloat($("#errorForm").data("lon"));gmwa.controllers.reportarError.initializeMap(e,o)}):$("#mapaVer").hide()});var e=document.createElement("script");e.src="/js/vendors/parsley/i18n/es.js",e.onload=function(){var e=document.createElement("script");e.src="/js/vendors/parsley/parsley.min.js",e.onload=function(){window.ParsleyValidator.setLocale("es"),$("#errorForm").parsley(),$.listen("parsley:form:validated",function(e){$.each(e.fields,function(e,o){var t=o.$element.next("ul.parsley-errors-list:first");o.$element.parents("div:first").find("small.error:first").hide(),t.find("li:first").length&&(t.find("li:first").text(),o.$element.parents("div:first").find("ul").show())})})},document.body.appendChild(e)},document.body.appendChild(e),$(document).on("submit","form",function(){$("#btnSend").prop("disabled",!0),$("#btnSend").text("Enviando...")})},gmwa.controllers.reportarError.initializeMap=function(o,t){var e;null==gmwa.controllers.reportarError.map&&(e=$("#us3").data("im"),""!=o)&&""!=t&&0!=o&&0!=t&&(gmwa.logger.log("Initializing Maps..."),gmwa.components.maps.instance.initMapAsync("mapa",o,t,16,e,function(e){gmwa.controllers.reportarError.map=e,gmwa.controllers.reportarError.marker=gmwa.components.maps.instance.addMarkerDraggable(gmwa.controllers.reportarError.map,o,t),gmwa.controllers.reportarError.marker.on("dragend",function(e){var e=e.target,o=e.getLatLng(),t=o.lat+","+o.lng;e.setLatLng(new L.LatLng(o.lat,o.lng),{draggable:"true"}),gmwa.controllers.reportarError.map.panTo(new L.LatLng(o.lat,o.lng)),$("#storeloc").val(t)})}))},gmwa.controllers=gmwa.controllers||{},gmwa.controllers.reserve={},gmwa.controllers.reserve.init=function(){var e;gmwa.logger.log("Reserve|Init..."),gmwa.components.header.init(),gmwa.controllers.reserve.buildSpecialHoursStatus(),gmwa.utils.isMobile()?(e=document.getElementById("tabInfo"))&&e.addEventListener("click",function(e){gmwa.controllers.reserve.map||gmwa.controllers.reserve.initializeMap()}):gmwa.controllers.reserve.initializeMap(),gmwa.controllers.reserve.initKeenSlider()},gmwa.controllers.reserve.initializeGoogleMap=function(){var e,o,t,r=$("#mapa");0!=r.length&&(e=r.data("lat"),o=r.data("lng"),t=r.data("im"),""!=e)&&""!=o&&0!=e&&0!=o&&(e=new google.maps.LatLng(e,o),o=t?{zoom:15,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!1,scrollwheel:!1,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}}:{zoom:15,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!0,scrollwheel:!0,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}},t=new google.maps.Map(r[0],o),new google.maps.Marker({position:e,map:t}))},gmwa.controllers.reserve.initializeMap=function(){var e=$("#mapa"),o=e.data("lat"),t=e.data("lng"),e=e.data("im");""==o||""==t||0==o||0==t||isNaN(o)||isNaN(t)||(gmwa.logger.log("Initializing Maps..."),gmwa.components.maps.instance.initMapAsync("mapa",o,t,16,e,function(e){gmwa.controllers.reserve.map=e,gmwa.components.maps.instance.addMarkerSimple(gmwa.controllers.reserve.map,o,t)}))},gmwa.controllers.reserve.buildSpecialHoursStatus=function(){var e,o,t={color:"darkorange",text:"text",show:!0,htext:"text",specialDate:null},r=window.hrsps,a=null;a=(a=new Date).getFullYear()+"-"+(0+String(a.getMonth()+1)).slice(-2)+"-"+(0+String(a.getDate())).slice(-2),r.length&&(t.color="#7CB342",a=dayjs(r[0].d+" 00:00:00"),t.specialDate=gmwa.controllers.reserve.convertDateToString(a,!0),r[0].dsc&&(t.specialDate=r[0].dsc+", "+gmwa.controllers.reserve.convertDateToString(a,!0)),r[0].cf?(r[0].hp?(e=" abierto de ",o=[],r[0].hp.forEach(function(e){o.push(gmwa.controllers.reserve.buildHourLabel(e.start)+" a "+gmwa.controllers.reserve.buildHourLabel(e.end))}),e+=o.join(", ")):(e=" cerrado",t.color="#FF5722"),r[0].dsc?t.htext=gmwa.controllers.reserve.convertDateToString(a,!0)+' "'+r[0].dsc+'" '+e:t.htext=gmwa.controllers.reserve.convertDateToString(a,!0)+e):(t.color="#FF9800",(new Date).getDay()==parseInt(a.format("d"))?t.htext="El horario de hoy puede variar":t.htext="El horario para el "+gmwa.controllers.reserve.convertDateToString(a,!0)+(r[0].dsc?" "+r[0].dsc:"")+" puede variar"),$("#horarioEspecial").append($('<div style="color: '+t.color+'">'+t.htext+"</div>")))},gmwa.controllers.reserve.convertDateToString=function(e,o){return o?e.format("dddd D [de] MMMM"):e.format("D [de] MMMM")},gmwa.controllers.reserve.coversCarrousel=null,gmwa.controllers.reserve.coversCarrouselInterval=0,gmwa.controllers.reserve.initKeenSlider=function(){gmwa.controllers.reserve.coversCarrouselInterval=0;var e=document.getElementById("keenCovers");e&&(gmwa.controllers.reserve.coversCarrousel=new KeenSlider(e,{loop:!0,duration:1e3,dragStart:function(){gmwa.controllers.reserve.carrouselAutoplay(!1)},dragEnd:function(){gmwa.controllers.reserve.carrouselAutoplay(!0)},created:function(){e.style.display="flex",document.querySelectorAll(".keen-slider__slide").forEach(function(e,o){0<o&&(e.style.display="block")})},slideChanged:function(e){var t=e.details().relativeSlide;document.querySelectorAll(".story-dot ").forEach(function(e,o){o==t?e.classList.add("story-dot--active"):e.classList.remove("story-dot--active")})}}),gmwa.controllers.reserve.carrouselAutoplay(!0))},gmwa.controllers.reserve.carrouselAutoplay=function(e){clearInterval(gmwa.controllers.reserve.coversCarrouselInterval),gmwa.controllers.reserve.coversCarrouselInterval=setInterval(function(){e&&gmwa.controllers.reserve.coversCarrousel&&gmwa.controllers.reserve.coversCarrousel.next()},5e3)},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.resultlist={},gmwa.controllers.resultlist.markersItems=[],gmwa.controllers.resultlist.init=function(){gmwa.logger.log("ResultList|Init..."),gmwa.components.header.init(),$(".related-list-opener").on("click",function(){var e=$(this);$(this).parents("ul:first").find("li.to-show").toggle(0,function(){"Ver más relacionados"==e.find("b:first").text()?e.find("b:first").text("Ocultar"):e.find("b:first").text("Ver más relacionados")})}),640<=window.innerWidth?($("#listMapCntr").sticky({topSpacing:10,zIndex:0}),gmwa.controllers.resultlist.loadStoresInMap()):(gmwa.controllers.resultlist.mapSwitchOn=!1,$("#fabMapSwitch").click(function(e){gmwa.controllers.resultlist.mapSwitchOn?($("#mapCntr").hide(),$(this).html('<i class="fa fa-map-o" aria-hidden="true"></i>')):($("#mapCntr").show(),void 0===gmwa.controllers.resultlist.map&&gmwa.controllers.resultlist.loadStoresInMap(),$(this).html('<i class="fa fa-list" aria-hidden="true"></i>')),gmwa.controllers.resultlist.mapSwitchOn=!gmwa.controllers.resultlist.mapSwitchOn}))},gmwa.controllers.resultlist.loadStoresInMap=function(){0==gmwa.mapsFW?gmwa.controllers.resultlist.loadStoresInGMap("listMap"):gmwa.controllers.resultlist.loadStoresInLMap("listMap")},gmwa.controllers.resultlist.loadStoresInLMap=function(e){var a;gmwa.logger.log("ResultList|Loading LMaps...."),$(".item-comercio").each(function(){var e=$(this).data("lat"),o=$(this).data("lng"),t=$(this).data("id"),r=null,a=$(this).find(".item-icon");0<a.length&&(r=(a=$(a[0])).hasClass("lazyload")?a.attr("data-src"):a.attr("src")),""!==e&&(a={latitude:parseFloat(e),longitude:parseFloat(o)},e="gmMarkerDot",o=$(this).find("h2").text().replace(/ /g,"-"),infoWContent='<div id="iwStore" class="rs-iw-cntr" data-id="'+t+'" data-name="'+o+'">',r&&0<r.length?infoWContent+='<img src="'+r+'" alt="'+o+'" witdh="31" height="31"><div style="margin-left: 55px;">':infoWContent+="<div>",infoWContent=infoWContent+("<h4>"+$(this).find("h2").text()+"</h4><p>"+$(this).find("h3").html())+"</p></div></div>",richMarkerHtml="vigente"==$(this).data("plan")&&r&&0<r.length?'<div class="gmMarkerPin4"><div><img src="'+r+'"  alt="'+o+'" witdh="31" height="31"></div></div>':'<div class="'+e+'"></div>',gmwa.controllers.resultlist.markersItems.push({locName:o,point:a,markerHtml:richMarkerHtml,infoWHtml:infoWContent}))}),0<gmwa.controllers.resultlist.markersItems.length&&(a=[],gmwa.components.maps.LMaps.initMapAsync(e,gmwa.controllers.resultlist.markersItems[0].point.latitude,gmwa.controllers.resultlist.markersItems[0].point.longitude,16,!1,function(e){gmwa.controllers.resultlist.map=e,gmwa.controllers.resultlist.map.on("popupopen",function(e){console.log("Hook open"),$("#iwStore").on("click",function(e){console.log("popup click"),window.location="/local/"+$(this).data("name").toLowerCase()+"/LOC"+$(this).data("id")})}),gmwa.controllers.resultlist.map.on("popupclose",function(e){console.log("Hook close"),$("#iwStore").off("click")});for(var o=0;o<gmwa.controllers.resultlist.markersItems.length;o++){var t=new L.marker([gmwa.controllers.resultlist.markersItems[o].point.latitude,gmwa.controllers.resultlist.markersItems[o].point.longitude],{icon:L.divIcon({html:gmwa.controllers.resultlist.markersItems[o].markerHtml})}),r=L.popup();r.setContent(gmwa.controllers.resultlist.markersItems[o].infoWHtml),t.bindPopup(r),t.addTo(gmwa.controllers.resultlist.map),gmwa.controllers.resultlist.markersItems[o].marker=t,a.push([gmwa.controllers.resultlist.markersItems[o].point.latitude,gmwa.controllers.resultlist.markersItems[o].point.longitude])}gmwa.controllers.resultlist.map.fitBounds(a,{padding:[20,20]})}))},gmwa.controllers.resultlist.loadStoresInGMap=function(e){var n,l,o,e=document.getElementById(e);null!==e&&(gmwa.controllers.resultlist.map=new google.maps.Map(e,{center:new google.maps.LatLng(-27.747,-62.987952),zoom:13,mapTypeId:"roadmap",styles:gmwa.controllers.resultlist.noPoi,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM},streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM}}),gmwa.controllers.resultlist.map.initialZoom=!0,google.maps.event.addListener(gmwa.controllers.resultlist.map,"zoom_changed",function(){var o=google.maps.event.addListener(gmwa.controllers.resultlist.map,"bounds_changed",function(e){15<this.getZoom()&&!0===gmwa.controllers.resultlist.map.initialZoom&&(this.setZoom(15),gmwa.controllers.resultlist.map.initialZoom=!1),google.maps.event.removeListener(o)})}),bounds=new google.maps.LatLngBounds,n=0,l="",$(".item-comercio").each(function(){var e,o=$(this).data("lat"),t=$(this).data("lng"),r=$(this).data("id"),a=$(this).find(".item-icon").attr("src");null==a&&(a=$(this).find(".item-icon").attr("data-src")),""!==o&&(o=new google.maps.LatLng(parseFloat(o),parseFloat(t)),t=0,e=$(this).find("h2").text().replace(/ /g,"-"),l='<div id="iwStore" class="rs-iw-cntr" data-id="'+r+'" data-name="'+e+'">',a&&0<a.length&&(l+='<img src="'+a+'">'),l=l+("<div><h4>"+$(this).find("h2").text()+"</h4><p>"+$(this).find("h3").html())+'</p><div style="bottom: 0px;position: absolute;right: 0px;font-weight:100">Ver mas</div></div></div>',(infoW=new google.maps.InfoWindow({content:l})).idr=1e3,google.maps.event.addListener(infoW,"domready",function(){$("#iwStore").on("click",function(e){window.location.href="/local/"+$(this).data("name").toLowerCase()+"/LOC"+$(this).data("id")})}),"vigente"==$(this).data("plan")?(richMarkerHtml="<div class='gmMarkerPin4'><div><img src='"+a+"'></div></div>",t=1):richMarkerHtml="<div class='gmMarkerDot'></div>",r=new RichMarker({position:o,draggable:!1,flat:!0,anchor:RichMarkerPosition.BOTTOM,content:richMarkerHtml,map:gmwa.controllers.resultlist.map,piid:0,type:t,infoW:infoW}),gmwa.controllers.resultlist.markersItems[n++]=r,gmwa.controllers.resultlist.buildMarker(r,gmwa.controllers.resultlist.map,0),bounds.extend(o),Foundation.MediaQuery.atLeast("medium"))&&($(this).get(0).marker=r,$(this).mouseenter(function(e){var o=e.currentTarget.marker.a;0===e.currentTarget.marker.type?o.children[0].children[0].className="gmMarkerDotSelected":o.children[0].children[0].className="gmMarkerPin4Selected",void 0===o.style.zIndex||null===o.style.zIndex||0===o.style.zIndex.length?o.prevZIndex=1:o.prevZIndex=o.style.zIndex,o.style.zIndex=parseInt(o.prevZIndex)+1e3}),$(this).mouseleave(function(e){var o=e.currentTarget.marker.a;0===e.currentTarget.marker.type?o.children[0].children[0].className="gmMarkerDot":o.children[0].children[0].className="gmMarkerPin4",e.currentTarget.marker.hovered=!0,o.style.zIndex=o.prevZIndex}))}),0===n&&(e=new google.maps.LatLng("-27.747508","-62.987952"),o=new google.maps.LatLng("-18.881115","-54.440589"),bounds=new google.maps.LatLngBounds(e,o)),gmwa.controllers.resultlist.reArrangeMap(bounds))},gmwa.controllers.resultlist.reArrangeMap=function(e){google.maps.event.addListener(gmwa.controllers.resultlist.map,"zoom_changed",function(){var o=google.maps.event.addListener(gmwa.controllers.resultlist.map,"bounds_changed",function(e){15<this.getZoom()&&!0===gmwa.controllers.resultlist.map.initialZoom&&(this.setZoom(15),gmwa.controllers.resultlist.map.initialZoom=!1),google.maps.event.removeListener(o)})}),gmwa.controllers.resultlist.bounds=e,gmwa.controllers.resultlist.map.fitBounds(gmwa.controllers.resultlist.bounds),gmwa.controllers.resultlist.map.setCenter(gmwa.controllers.resultlist.map.getCenter())},gmwa.controllers.resultlist.buildMarker=function(e,o,t){google.maps.event.addListener(e,"click",function(){gmwa.controllers.resultlist.lastMarkerSelected&&(0===gmwa.controllers.resultlist.lastMarkerSelected.type?gmwa.controllers.resultlist.lastMarkerSelected.a.children[0].children[0].className="gmMarkerDot":gmwa.controllers.resultlist.lastMarkerSelected.a.children[0].children[0].className="gmMarkerPin4"),0===this.type?this.a.children[0].children[0].className="gmMarkerDotSelected":this.a.children[0].children[0].className="gmMarkerPin4Selected",gmwa.controllers.resultlist.lastMarkerSelected=this,void 0!==gmwa.controllers.resultlist.prevInfoWindow&&gmwa.controllers.resultlist.prevInfoWindow.close(),this.infoW.open(gmwa.controllers.resultlist.map,this),gmwa.controllers.resultlist.prevInfoWindow=this.infoW})},(gmwa=gmwa||{}).services=gmwa.services||{},gmwa.services.worker={},gmwa.services.worker.register=function(){"serviceWorker"in navigator?navigator.serviceWorker.register("/service-worker.js").then(gmwa.services.worker.initialiseState):gmwa.isSafari?(gmwa.logger.log("App|Safari delaying check...."),setTimeout(function(){gmwa.services.worker.initialiseState()},500)):gmwa.logger.log("App|Service workers aren't supported in this browser.")},gmwa.services.worker.onInitializeState=function(e){void 0===gmwa.services.worker.eventSubsInitializeState&&(gmwa.services.worker.eventSubsInitializeState=[]),gmwa.services.worker.eventSubsInitializeState.push(e)},gmwa.services.worker.triggerInitializeState=function(e,o,t){if(void 0!==gmwa.services.worker.eventSubsInitializeState)for(var r=0;r<gmwa.services.worker.eventSubsInitializeState.length;r++)gmwa.services.worker.eventSubsInitializeState[r]({isPushSupported:e,isPushEnabled:o,isPushBlocked:t})},gmwa.services.worker.initialiseState=function(){var e;gmwa.isSafari?"safari"in window&&"pushNotification"in window.safari?(e=window.safari.pushNotification.permission(gmwa.webpush.pushId),gmwa.webpush.isPushSupported=!0,"denied"===e.permission?(gmwa.logger.log("App|InitState|The user has blocked notifications."),gmwa.webpush.isBlocked=!0,gmwa.services.worker.triggerInitializeState(!0,!1,!0)):"granted"===e.permission&&(gmwa.logger.log("User is already subscriberd with token: "+e.deviceToken),gmwa.router.sendPushSubscription&&(gmwa.logger.log("App|PushManager|Found existing push registration, synching with server..."),gmwa.webpush.sendSubscriptionToServer({isAPN:!0,endpoint:e.deviceToken})),gmwa.webpush.isPushEnabled=!0,gmwa.services.worker.triggerInitializeState(!0,!0,!1))):(gmwa.logger.log("App|InitState|Notifications aren't supported."),gmwa.services.worker.triggerInitializeState(!1,!1,!1)):"showNotification"in ServiceWorkerRegistration.prototype?(gmwa.webpush.isPushSupported=!0,"denied"===Notification.permission?(gmwa.logger.log("App|InitState|The user has blocked notifications."),gmwa.webpush.isBlocked=!0,gmwa.services.worker.triggerInitializeState(!0,!1,!0)):"PushManager"in window?navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){e?(gmwa.router.sendPushSubscription&&(gmwa.logger.log("App|PushManager|Found existing push registration, synching with server..."),gmwa.webpush.sendSubscriptionToServer(e)),gmwa.webpush.isPushEnabled=!0,gmwa.services.worker.triggerInitializeState(!0,!0,!1)):(gmwa.logger.log("App|PushManager|No push registration detected. User must request it."),gmwa.services.worker.triggerInitializeState(!0,!1,!1))}).catch(function(e){gmwa.logger.error("App|PushManager|Error during getSubscription()",e)})}):(gmwa.logger.log("App|InitState|Push messaging isn't supported."),gmwa.services.worker.triggerInitializeState(!0,!1,!0))):(gmwa.logger.log("App|InitState|Notifications aren't supported."),gmwa.services.worker.triggerInitializeState(!1,!1,!1))},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.promosAll={},gmwa.controllers.promosAll.init=function(){gmwa.components.header.init(),$("#mi-prms").addClass("u-tb-item-selected")},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.promosFicha={},gmwa.controllers.promosFicha.init=function(){$("#mi-prms").addClass("u-tb-item-selected"),gmwa.components.header.init()},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.promosHome={},gmwa.controllers.promosHome.init=function(){$("#mi-prms").addClass("u-tb-item-selected"),gmwa.components.header.init(),$("div[id^='prm-categ-']").each(function(){var e=$(this).data("id"),o=3.4;gmwa.utils.isMobile()&&(o=1.2),new Swiper("#prm-categ-"+e,{slidesPerView:o,paginationClickable:!1,navigation:{nextEl:"#next-categ-prm-"+e,prevEl:"#prev-categ-prm-"+e},spaceBetween:10})})},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.promosSponsor={},gmwa.controllers.promosSponsor.init=function(){$("#mi-prms").addClass("u-tb-item-selected"),gmwa.components.header.init()},gmwa.controllers=gmwa.controllers||{},gmwa.controllers.azar={},gmwa.controllers.azar.init=function(){gmwa.logger.log("Azar|Init..."),$("#mi-azar").addClass("u-tb-item-selected"),gmwa.components.header.init(),$("#bPanel2").on("click",function(e){e.preventDefault(),gmwa.controllers.azar.quinielaLoaded||$.ajax({url:"/azar/quiniela",contentType:"application/json; charset=utf-8"}).done(function(e){e&&($("#quinTitle1").text(e.tipo1),$("#quinFecha1").text(e.fecha1),$("#quinNum1").html('<li><span class="badge">01</span> '+e.num1_01+'</li><li><span class="badge">02</span> '+e.num1_02+'</li><li><span class="badge">03</span> '+e.num1_03+'</li><li><span class="badge">04</span> '+e.num1_04+'</li><li><span class="badge">05</span> '+e.num1_05+"</li>"),$("#quinNum2").html('<li><span class="badge">06</span> '+e.num1_06+'</li><li><span class="badge">07</span> '+e.num1_07+'</li><li><span class="badge">08</span> '+e.num1_08+'</li><li><span class="badge">09</span> '+e.num1_09+'</li><li><span class="badge">10</span> '+e.num1_10+"</li>"),$("#quinNum3").html('<li><span class="badge">11</span> '+e.num1_11+'</li><li><span class="badge">12</span> '+e.num1_12+'</li><li><span class="badge">13</span> '+e.num1_13+'</li><li><span class="badge">14</span> '+e.num1_14+'</li><li><span class="badge">15</span> '+e.num1_15+"</li>"),$("#quinNum4").html('<li><span class="badge">16</span> '+e.num1_16+'</li><li><span class="badge">17</span> '+e.num1_17+'</li><li><span class="badge">18</span> '+e.num1_18+'</li><li><span class="badge">19</span> '+e.num1_19+'</li><li><span class="badge">20</span> '+e.num1_20+"</li>"),$("#quinTitle2").text(e.tipo2),$("#quinFecha2").text(e.fecha2),$("#quinNum21").html('<li><span class="badge">01</span> '+e.num2_01+'</li><li><span class="badge">02</span> '+e.num2_02+'</li><li><span class="badge">03</span> '+e.num2_03+'</li><li><span class="badge">04</span> '+e.num2_04+'</li><li><span class="badge">05</span> '+e.num2_05+"</li>"),$("#quinNum22").html('<li><span class="badge">06</span> '+e.num2_06+'</li><li><span class="badge">07</span> '+e.num2_07+'</li><li><span class="badge">08</span> '+e.num2_08+'</li><li><span class="badge">09</span> '+e.num2_09+'</li><li><span class="badge">10</span> '+e.num2_10+"</li>"),$("#quinNum23").html('<li><span class="badge">11</span> '+e.num2_11+'</li><li><span class="badge">12</span> '+e.num2_12+'</li><li><span class="badge">13</span> '+e.num2_13+'</li><li><span class="badge">14</span> '+e.num2_14+'</li><li><span class="badge">15</span> '+e.num2_15+"</li>"),$("#quinNum24").html('<li><span class="badge">16</span> '+e.num2_16+'</li><li><span class="badge">17</span> '+e.num2_17+'</li><li><span class="badge">18</span> '+e.num2_18+'</li><li><span class="badge">19</span> '+e.num2_19+'</li><li><span class="badge">20</span> '+e.num2_20+"</li>"),gmwa.controllers.azar.quinielaLoaded=!0)}).fail(function(e){gmwa.logger.error("Could not get quinela info: "+JSON.stringify(e))})}),$("#bPanel3").on("click",function(e){e.preventDefault(),gmwa.controllers.azar.tombolaLoaded||$.ajax({url:"/azar/tombola",contentType:"application/json; charset=utf-8"}).done(function(e){e&&($("#tombTitle1").text(e.tipo1),$("#tombFecha1").text(e.fecha1),$("#tombNum1").html('<li><span class="badge">01</span> '+e.num1_01+'</li><li><span class="badge">02</span> '+e.num1_02+'</li><li><span class="badge">03</span> '+e.num1_03+'</li><li><span class="badge">04</span> '+e.num1_04+'</li><li><span class="badge">05</span> '+e.num1_05+"</li>"),$("#tombNum2").html('<li><span class="badge">06</span> '+e.num1_06+'</li><li><span class="badge">07</span> '+e.num1_07+'</li><li><span class="badge">08</span> '+e.num1_08+'</li><li><span class="badge">09</span> '+e.num1_09+'</li><li><span class="badge">10</span> '+e.num1_10+"</li>"),$("#tombNum3").html('<li><span class="badge">11</span> '+e.num1_11+'</li><li><span class="badge">12</span> '+e.num1_12+'</li><li><span class="badge">13</span> '+e.num1_13+'</li><li><span class="badge">14</span> '+e.num1_14+'</li><li><span class="badge">15</span> '+e.num1_15+"</li>"),$("#tombNum4").html('<li><span class="badge">16</span> '+e.num1_16+'</li><li><span class="badge">17</span> '+e.num1_17+'</li><li><span class="badge">18</span> '+e.num1_18+'</li><li><span class="badge">19</span> '+e.num1_19+'</li><li><span class="badge">20</span> '+e.num1_20+"</li>"),$("#tombTitle2").text(e.tipo2),$("#tombFecha2").text(e.fecha2),$("#tombNum21").html('<li><span class="badge">01</span> '+e.num2_01+'</li><li><span class="badge">02</span> '+e.num2_02+'</li><li><span class="badge">03</span> '+e.num2_03+'</li><li><span class="badge">04</span> '+e.num2_04+'</li><li><span class="badge">05</span> '+e.num2_05+"</li>"),$("#tombNum22").html('<li><span class="badge">06</span> '+e.num2_06+'</li><li><span class="badge">07</span> '+e.num2_07+'</li><li><span class="badge">08</span> '+e.num2_08+'</li><li><span class="badge">09</span> '+e.num2_09+'</li><li><span class="badge">10</span> '+e.num2_10+"</li>"),$("#tombNum23").html('<li><span class="badge">11</span> '+e.num2_11+'</li><li><span class="badge">12</span> '+e.num2_12+'</li><li><span class="badge">13</span> '+e.num2_13+'</li><li><span class="badge">14</span> '+e.num2_14+'</li><li><span class="badge">15</span> '+e.num2_15+"</li>"),$("#tombNum24").html('<li><span class="badge">16</span> '+e.num2_16+'</li><li><span class="badge">17</span> '+e.num2_17+'</li><li><span class="badge">18</span> '+e.num2_18+'</li><li><span class="badge">19</span> '+e.num2_19+'</li><li><span class="badge">20</span> '+e.num2_20+"</li>"),gmwa.controllers.azar.tombolaLoaded=!0)}).fail(function(e){gmwa.logger.error("Could not get tombola info: "+JSON.stringify(e))})}),$("#bPanel4").on("click",function(e){e.preventDefault(),gmwa.controllers.azar.loteriaLoaded||$.ajax({url:"/azar/loteria",contentType:"application/json; charset=utf-8"}).done(function(e){e&&($("#lotFecha1").text(e.fecha),$("#lotNum1").html('<li><span class="badge">01</span> '+e.num01+'</li><li><span class="badge">02</span> '+e.num02+'</li><li><span class="badge">03</span> '+e.num03+'</li><li><span class="badge">04</span> '+e.num04+'</li><li><span class="badge">05</span> '+e.num05+"</li>"),$("#lotNum2").html('<li><span class="badge">06</span> '+e.num06+'</li><li><span class="badge">07</span> '+e.num07+'</li><li><span class="badge">08</span> '+e.num08+'</li><li><span class="badge">09</span> '+e.num09+'</li><li><span class="badge">10</span> '+e.num10+"</li>"),$("#lotNum3").html('<li><span class="badge">11</span> '+e.num11+'</li><li><span class="badge">12</span> '+e.num12+'</li><li><span class="badge">13</span> '+e.num13+'</li><li><span class="badge">14</span> '+e.num14+'</li><li><span class="badge">15</span> '+e.num15+"</li>"),$("#lotNum4").html('<li><span class="badge">16</span> '+e.num16+'</li><li><span class="badge">17</span> '+e.num17+'</li><li><span class="badge">18</span> '+e.num18+'</li><li><span class="badge">19</span> '+e.num19+'</li><li><span class="badge">20</span> '+e.num20+"</li>"),$("#lotAprox1").text(e.aprox1),$("#lotAprox2").text(e.aprox2),$("#lotPrem01").text(e.prem01),$("#lotPrem02").text(e.prem02),$("#lotPrem03").text(e.prem03),$("#lotPrem04_05").text(e.prem04_05),$("#lotPrem06_10").text(e.prem06_10),$("#lotPrem11_20").text(e.prem11_20),$("#lotPremaprox").text(e.premaprox),gmwa.controllers.azar.loteriaLoaded=!0)}).fail(function(e){gmwa.logger.error("Could not get loteria info: "+JSON.stringify(e))})})},gmwa.controllers=gmwa.controllers||{},gmwa.controllers.cartelera={},gmwa.controllers.cartelera.init=function(){gmwa.logger.log("Cartelera|Init..."),$("#mi-cart").addClass("u-tb-item-selected"),gmwa.components.header.init()}}(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.horoscopo={},gmwa.controllers.horoscopo.init=function(){$("#mi-horo").addClass("u-tb-item-selected"),gmwa.components.header.init(),$("a.btnHor").each(function(){$(this).click(function(e){var o=$(this).find("img").attr("src"),t=$(this).find(".signo").text();$("#iconPrediction").attr("src",o),$("#signName").text(t),$.ajax({url:"/horoscopo/"+t}).done(function(e){$("#textPrediction").text(e.pronostico),void 0===gmwa.controllers.horoscopo.modal&&(gmwa.controllers.horoscopo.modal=$("#modalPrediction")),gmwa.controllers.horoscopo.modal.foundation("open")}).fail(function(e){gmwa.logger.error("Could not get horoscopo for sign : "+t),gmwa.logger.error(e)})})})};(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.orderCheckout={};var users=null,user=null,apto=!1;gmwa.controllers.orderCheckout.newLocation={},gmwa.controllers.orderCheckout.scheduleType=0,gmwa.controllers.orderCheckout.cartOpened=!1,gmwa.controllers.orderCheckout.coverageChecked=!1,gmwa.controllers.orderCheckout.coverageData=null,gmwa.controllers.orderCheckout.init=function(){gmwa.logger.log("OrderCheckout|Init..."),gmwa.controllers.orderCheckout.isMobile=gmwa.utils.isMobile(),gmwa.components.header.init(),null!=window.preUser&&(0<(users=window.preUser).length?void 0!==(user=users[users.length-1]).address&&null!==user.address&&0<user.address.address.length?(user.selectedAddress=user.address,gmwa.controllers.orderCheckout.isFirstAddress=!1):user.selectedAddress=null:gmwa.controllers.orderCheckout.isFirstAddress=!0),!window.isOpened&&window.outOfHours&&(gmwa.controllers.orderCheckout.scheduleType=1),$("#verModal").click(function(e){null===user||gmwa.controllers.orderCheckout.isFirstAddress?(1==gmwa.controllers.orderCheckout.entrega?$("#modalAddAddressGeo").show():$("#modalAddAddressGeo").hide(),gmwa.controllers.orderCheckout.openAddLocation()):gmwa.controllers.orderCheckout.openLocationSelector()}),$("#lblSpInstr").click(function(e){$("#lblSpInstr").hide(),$("#txtSpInstr").show(0,function(){$("#textArea").focus()})}),$("#textArea").focusout(function(e){0===$("#textArea").val().length&&($("#lblSpInstr").show(),$("#txtSpInstr").hide())}),$("#cart-table-title").on("click",function(e){gmwa.controllers.orderCheckout.isMobile&&(gmwa.controllers.orderCheckout.cartOpened?$("#cart-table").hide():$("#cart-table").show(),gmwa.controllers.orderCheckout.cartOpened=!gmwa.controllers.orderCheckout.cartOpened)});var e=dayjs().add(3,"d").toDate(),o=document.createElement("script");o.src="/js/vendors/foundation-datepicker/foundation-datepicker.min.js",o.onload=function(){$("#optPickDate").fdatepicker({language:"es",initialDate:e,startDate:e}).on("changeDate",function(e){var o=dayjs.utc(e.date),e=(o.add(e.date.getTimezoneOffset(),"minutes"),$("#optPickDate").html("<div>"+o.format("dddd")+"</div><p>"+o.format("DD")+"</p><div>"+o.format("MMM").toUpperCase()+"</div>"),$(".optionsDays div").removeClass("selected"),$(this).addClass("selected"),o.format("e")),e=gmwa.controllers.orderCheckout.buildHoursOptions(e);$("#opt-list-X-sel").html(e),void 0===gmwa.controllers.orderCheckout.previousScheduleTable&&(gmwa.controllers.orderCheckout.previousScheduleTable=$("#opt-list-1")),gmwa.controllers.orderCheckout.previousScheduleTable.hide(),gmwa.controllers.orderCheckout.previousScheduleTable=$("#opt-list-X"),gmwa.controllers.orderCheckout.previousScheduleTableSelect=gmwa.controllers.orderCheckout.previousScheduleTable.find("select"),gmwa.controllers.orderCheckout.previousScheduleTable.show(),void 0===gmwa.controllers.orderCheckout.scheduleValue&&(gmwa.controllers.orderCheckout.scheduleValue={}),gmwa.controllers.orderCheckout.scheduleValue.date=o.format("YYYY/MM/DD"),gmwa.controllers.orderCheckout.scheduleValue.hour="-1",gmwa.controllers.orderCheckout.previousScheduleTableSelect.val($("#opt-list-X select option:first").val())})},document.body.appendChild(o),gmwa.services.worker.onInitializeState(function(e){gmwa.logger.log("onInitializeState | "+JSON.stringify(e)),e.isPushSupported?e.isPushEnabled?(gmwa.logger.log("Push ON"),$("#qrNotifyMe").prop("checked",!0),gmwa.isSafari&&$("#qrNotifyMe").prop("disabled",!0)):gmwa.isSafari&&$("#qrNotifyMe").prop("disabled",!1):$("#qrNotifyMeCntr").hide()}),$("#qrNotifyMe").click(function(e){$("#qrNotifyMe").prop("disabled",!0),e.preventDefault(),$(this).is(":checked")?gmwa.webpush.subscribe(function(e){0===e?$("#qrNotifyMe").prop("checked",!0):-1==e?($("#qrNotifyMeError1").show(),$("#qrNotifyMe").prop("checked",!1)):-2==e&&($("#qrNotifyMeError2").show(),$("#qrNotifyMe").prop("checked",!1)),$("#qrNotifyMe").prop("disabled",!1)}):gmwa.webpush.unsubscribe(function(e){0===e?$("#qrNotifyMe").prop("checked",!1):-1==e&&gmwa.logger.error("Unubscribe returned "+e),$("#qrNotifyMe").prop("disabled",!1)})}),gmwa.controllers.orderCheckout.drawUserData(),gmwa.controllers.orderCheckout.checkoutOptions(),gmwa.controllers.orderCheckout.hookSchedule(),gmwa.controllers.orderCheckout.checkDeliveryCoverage()},gmwa.controllers.orderCheckout.drawUserData=function(){var e="",o="";null===user?(1==gmwa.controllers.orderCheckout.entrega?(e="<div>Por favor ingresa tus datos y tu ubicación para poder solicitar la entrega</div>",$("#datosUsuarioMap").html('<i class="fa fa-map-marker" aria-hidden="true" style="position: absolute;left: 30px;top: 20px;font-size: 50px;color: #DDD;"></i>')):(e="<div>Por favor ingresa tus datos para identificarte al momento de levantar el pedido</div>",$("#datosUsuarioMap").html('<i class="fa fa-shopping-bag" aria-hidden="true" style="position: absolute;left: 30px;top: 20px;font-size: 50px;color: #DDD;"></i>')),o="Agregar mis datos"):1==gmwa.controllers.orderCheckout.entrega?null!==user.selectedAddress?(e='<div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;color: grey;">'+user.name+"</div>",e=(e+="<div style='color: grey; display: inline;'>Tel: "+user.phone+"</div>")+'<div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;color: grey;">'+user.selectedAddress.address+"</div>",o="Cambiar"):(e="Para solicitar entrega a domicilio necesitamos los datos de tu dirección.",o="Ingresar mi dirección",$("#datosUsuarioMap").hide()):(e='<div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;color: grey;">'+user.name+"</div>",e+="<div style='color: grey; display: inline;'>Tel: "+user.phone+"</div>",o="Cambiar",$("#datosUsuarioMap").html('<i class="fa fa-shopping-bag" aria-hidden="true" style="position: absolute;left: 30px;top: 20px;font-size: 50px;color: #DDD;"></i>')),$("#datosUsuario").html(e),$("#verModal").html(o)},gmwa.controllers.orderCheckout.openLocationSelector=function(){void 0!==gmwa.controllers.orderCheckout.modalSelectAddress?gmwa.controllers.orderCheckout.modalSelectAddress.foundation("open"):(gmwa.controllers.orderCheckout.modalSelectAddress=$("#modalSelectAddress"),gmwa.controllers.orderCheckout.modalSelectAddress.foundation("open"),$(".u-address-card").click(gmwa.controllers.orderCheckout.selectAddressCard))},gmwa.controllers.orderCheckout.selectAddressCard=function(e){gmwa.controllers.orderCheckout.selectAddress($(this).attr("data-index"))},gmwa.controllers.orderCheckout.selectAddress=function(e){(user=users[e]).selectedAddress=user.address,gmwa.controllers.orderCheckout.modalSelectAddress&&gmwa.controllers.orderCheckout.modalSelectAddress.foundation("close"),gmwa.controllers.orderCheckout.drawUserData(),gmwa.controllers.orderCheckout.checkDeliveryCoverage()},gmwa.controllers.orderCheckout.checkDeliveryCoverage=function(){var e,o;1==gmwa.controllers.orderCheckout.entrega?($("#infoDelCost").html("Verificando cobertura..."),$("#infoDelCost").show(),e=(o=document.location.href.split("/"))[o.length-3],o=o[o.length-2],null===user||void 0===user.selectedAddress||null===user.selectedAddress?($("#infoDelCost").addClass("alert"),$("#infoDelCost").removeClass("success"),$("#infoDelCost").html("<div>Para poder solicitar entrega a domicilio, por favor ingrese sus datos y su dirección. Recuerde confirmar el punto en el mapa para asgurar que la entrega llegue a destino sin problemas.</div>")):void 0===user.selectedAddress.lat||null===user.selectedAddress.lat?($("#infoDelCost").addClass("alert"),$("#infoDelCost").removeClass("success"),$("#infoDelCost").html("<div>No se puede verificar su ubicación (1). Por favor vuelva a ingresar su dirección y confirma el punto en el mapa.</div>")):$.ajax({url:"/pedidos/checkDeliveryCoverageZone/"+e+"/"+o+"/"+user.selectedAddress.lat+"/"+user.selectedAddress.lng,contentType:"application/json; charset=utf-8"}).done(function(e){200==e.meta.status?(gmwa.logger.log("CoverageCheck | API returned OK. DATA= "+JSON.stringify(e)),gmwa.controllers.orderCheckout.coverageChecked=!0,gmwa.controllers.orderCheckout.coverageData=e.data,e.data.isInside?(0===e.data.amount?($("#infoDelCost").html("<div>Te encuentras dentro del area de cobertura. El envío es gratis.</div>"),gmwa.controllers.orderCheckout.updateCartTotal(0)):($("#infoDelCost").html("<div>Te encuentras dentro del area de cobertura. El costo de envío es $"+e.data.amount+"</div>"),gmwa.controllers.orderCheckout.updateCartTotal(e.data.amount)),$("#infoDelCost").addClass("success"),$("#infoDelCost").removeClass("alert")):($("#infoDelCost").addClass("alert"),$("#infoDelCost").removeClass("success"),$("#infoDelCost").html("<div>Lamentablemente te encuentras fuera del area de cobertura para entrega.</div>"),gmwa.controllers.orderCheckout.updateCartTotal(0))):(gmwa.logger.error("CoverageCheck | API returned error: "+JSON.stringify(e)),$("#infoDelCost").addClass("alert"),$("#infoDelCost").removeClass("success"),$("#infoDelCost").html("<div>Ocurrio un error verificando su ubicación (2). Por favor vuelva a ingresar su dirección y confirma el punto en el mapa.</div>"),gmwa.controllers.orderCheckout.updateCartTotal(0))}).fail(function(e){gmwa.logger.error("CoverageCheck | API returned error: "+JSON.stringify(e)),$("#infoDelCost").addClass("alert"),$("#infoDelCost").removeClass("success"),$("#infoDelCost div").html("<div>Ocurrio un error verificando su ubicación (3). Por favor vuelva a ingresar su dirección y confirma el punto en el mapa.</div>"),gmwa.controllers.orderCheckout.updateCartTotal(0)})):($("#infoDelCost").hide(),gmwa.controllers.orderCheckout.updateCartTotal(0))},gmwa.controllers.orderCheckout.updateCartTotal=function(e){$("#cartDeliveryCost").html(gmwa.utils.formatNumberHTML(e));var o=$("#cartTotalAmount").data("amount");$("#cartTotalAmount").html(gmwa.utils.formatNumberHTML(o+e)),$("#headerCartTotal").html(gmwa.utils.formatNumberHTML(o+e)),$("#cartTotalAmount").fadeTo("slow",.1).fadeTo("slow",1),$("#headerCartTotal").fadeTo("slow",.1).fadeTo("slow",1)},gmwa.controllers.orderCheckout.openAddLocation=function(){void 0!==gmwa.controllers.orderCheckout.modalAddAddress?gmwa.controllers.orderCheckout.modalAddAddress.foundation("open"):(gmwa.controllers.orderCheckout.modalAddAddress=$("#modalAddAddress"),gmwa.controllers.orderCheckout.modalAddAddress.foundation("open"),$("#datoAdd").click(function(e){var o={},t=(o.name=$("#txtNombre").val(),o.phone=$("#txtTelefono").val(),o.email=$("#txtEMail").val(),{}),r=$("#txtCalle").val(),a=$("#txtNro").val(),n=$("#txtCity").val(),l=$("#txtApto").val(),l=(l&&0<l.length?t.address=r+" "+a+" apto "+l:t.address=r+" "+a,n&&0<n.length&&(t.address+=", "+n),t.coords=gmwa.controllers.orderCheckout.newLocation,"");null!=o.name&&0!==o.name.length||(l="Nombre es requerido"),null!=o.phone&&0!==o.phone.length||(0<l.length&&(l+="<br>"),l+="Telefono es requerido"),1==gmwa.controllers.orderCheckout.entrega&&(null!=r&&0!==r.length||(0<l.length&&(l+="<br>"),l+="Calle es requerida"),null!=a&&0!==a.length||(0<l.length&&(l+="<br>"),l+="Numero de puerta es requerido"),null!=n&&0!==n.length||(0<l.length&&(l+="<br>"),l+="Ciudad es requerida"),void 0!==t.coords&&void 0!==t.coords.lat&&0!==t.coords.lat.length||(0<l.length&&(l+="<br>"),l+="Por favor confirma el punto en el mapa para garantizar estar dentro de la zona de cobertura para entregas. Completa el formulario y haz clic en 'Buscar dirección'")),0<l.length?($("#formError").html(l),$("#formError").show()):(o.selectedAddress={address:t.address,lat:t.coords.lat,lng:t.coords.lng},o.address=o.selectedAddress,r=!1,a=null,n='<div id="newAddrAdded" class="large-6 medium-6 small-12 columns" data-index="'+(a=0<$("#newAddrAdded").length?(r=!0,$("#addrCntr").children().length-1):$("#addrCntr").children().length)+'"><div class="u-address-card" " data-name="'+o.name+'" data-phone="'+o.phone+'" data-address="'+t.address+'" data-lat="'+t.coords.lat+'" data-lng="'+t.coords.lng+'" >',n=(n+="<p>"+o.name+"</p>")+"<p><strong>"+t.address+"</strong></p><p>Tel: "+o.phone+"</p></div></div>",r?(users[users.length-1]=o,$("#newAddrAdded").replaceWith($(n))):((users=null==users?[]:users).push(o),$("#addrCntr").append($(n))),$("#newAddrAdded").click(gmwa.controllers.orderCheckout.selectAddressCard),gmwa.controllers.orderCheckout.selectAddress(a),gmwa.controllers.orderCheckout.modalAddAddress.foundation("close"),gmwa.controllers.orderCheckout.drawUserData(),gmwa.controllers.orderCheckout.checkDeliveryCoverage())}),$("#searchAddr").click(function(e){$(this).prop("disabled",!0);var o=$("#txtCalle").val(),t=$("#txtNro").val(),r=$("#txtCity").val();$("#searchAddrInfo").html("Buscando..."),gmwa.controllers.orderCheckout.buscarCoordenadas(o,t,r,function(e){$(this).prop("disabled",!1),null==e?$("#searchAddrInfo").html('<div style="color: #F44336;">No se pudo ubicar la direccion, por favor ingresela de otra manera e intente nuevamente</div>'):(gmwa.controllers.orderCheckout.newLocation.lat=e.lat,gmwa.controllers.orderCheckout.newLocation.lng=e.lng,gmwa.controllers.orderCheckout.initializeLMap(e.lat,e.lng),$.ajax({url:"/pedido/zoneinfo/"+e.lat+"/"+e.lng,contentType:"application/json; charset=utf-8"}).done(function(e){e.found?gmwa.controllers.orderCheckout.newLocation.zone=e:gmwa.controllers.orderCheckout.newLocation.zone=null,$("#searchAddrInfo").html('<div style="color: #4CAF50;">Ubicacion encontrada. Arrastre el pin en el mapa para ajustarlo de ser necesario</div>'),$("#datoAdd").prop("disabled",!1),gmwa.logger.info(e)}).fail(function(e){$("#datoAdd").prop("disabled",!1),gmwa.logger.error("Could not get zone info: "+JSON.stringify(e))}))})}))},gmwa.controllers.orderCheckout.checkoutOptions=function(e,o,t){var r=$("#deliveryMethod").data("sdp"),a=$("#deliveryMethod").data("sdd"),n=(r&&a?gmwa.controllers.orderCheckout.entrega=2:!r&&a?gmwa.controllers.orderCheckout.entrega=1:r&&!a&&(gmwa.controllers.orderCheckout.entrega=2),1);$("#ingresarDatos").click(function(e){1==gmwa.controllers.orderCheckout.entrega?$("#modalAddAddressGeo").show():$("#modalAddAddressGeo").hide(),gmwa.controllers.orderCheckout.openAddLocation()}),$("#opciones").click(function(e){$("#formulario").css("display","none"),$("#opcionesDatos").css("display","flex")}),$("#ingresarDatosCancel").click(function(e){gmwa.controllers.orderCheckout.modalSelectAddress.foundation("close")}),$("#btnDeliveryMethod button").click(function(e){$(this).siblings().removeClass("is-active"),$(this).addClass("is-active"),("1"==$(this).attr("data-id")?(gmwa.controllers.orderCheckout.entrega=1,$("#deliveryMethodText-1").show(),$("#deliveryMethodText-2")):(gmwa.controllers.orderCheckout.entrega=2,$("#deliveryMethodText-2").show(),$("#deliveryMethodText-1"))).hide(),gmwa.controllers.orderCheckout.checkDeliveryCoverage(),gmwa.controllers.orderCheckout.drawUserData()}),$("#btnScheduleType button").click(function(e){$(this).siblings().removeClass("is-active"),$(this).addClass("is-active"),"1"==$(this).attr("data-id")?(gmwa.controllers.orderCheckout.scheduleType=1,$("#schedOptions").show()):(gmwa.controllers.orderCheckout.scheduleType=0,$("#schedOptions").hide())}),$(".tipoPago").click(function(e){n="1"==$(this).attr("data-id")?1:2}),$("#disclaimer").change(function(){$(this).prop("checked")}),$("#checkoutConfirm").click(function(){gmwa.controllers.orderCheckout.checkoutConfirm(n,e,o,t)}),$("#checkoutCancel").click(function(){})},gmwa.controllers.orderCheckout.checkoutConfirm=function(e,o,t,r){var a,n,l,s,i;window.isOpened||window.outOfHours?(n=document.location.href.split("/"),$("#totalPrice").html(),(a={}).token=n[n.length-1],a.idr=n[n.length-3],a.ids=n[n.length-2],a.shipping=gmwa.controllers.orderCheckout.entrega,a.description=$("#textArea").val(),0===gmwa.controllers.orderCheckout.scheduleType?(a.scheduleType=0,a.scheduleValue=""):(a.scheduleType=1,void 0!==gmwa.controllers.orderCheckout.scheduleValue?a.scheduleValue={date:gmwa.controllers.orderCheckout.scheduleValue.date,hour:gmwa.controllers.orderCheckout.scheduleValue.hour}:a.scheduleValue={}),a.paymentMethod=e,a.user={email:user.email,name:user.name,phone:user.phone,address:user.selectedAddress},void 0!==gmwa.controllers.orderCheckout.newLocation.zone&&null!==gmwa.controllers.orderCheckout.newLocation.zone&&(a.user.zone=gmwa.controllers.orderCheckout.newLocation.zone.zon),0<(n=gmwa.controllers.orderCheckout.validateCheckout(a)).length?(l="<ul>",n.forEach(function(e){l+="<li>"+e+"</li>"}),l+="</ul>",$("#errormsg").html(l),$("#errormsgCntr").show()):($("#errormsgCntr").hide(),s=!0,$('#cart-table tr[id*="line-id"]').each(function(){var e,o;s&&""!=(e=$(this).data("open-days"))&&(o=(0==a.scheduleType?new Date:new Date(a.scheduleValue.date)).getDay(),s=gmwa.controllers.orderCheckout.validateOpenDays(e,o))}),s?(i=JSON.stringify(a),gmwa.utils.showProgress("Enviando pedido","Espere por favor...",!0,!0),$.ajax({type:"POST",url:"/pedido/checkout",data:i,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){200==e.meta.status?(gmwa.logger.log("Order Add Product | API returned OK: "+JSON.stringify(e)),gmwa.logger.log(i),document.location.href="/pedidos/pedido/"+a.token):(gmwa.logger.error("Order Add Product | API returned error: "+JSON.stringify(e)),gmwa.utils.hideProgress(),gmwa.utils.showError("No se pudo enviar el pedido","Ocurrio un problema al enviar el pedido, por favor inténtelo más tarde."))}).fail(function(e){gmwa.utils.hideProgress(),gmwa.utils.showError("No se pudo enviar el pedido","Ocurrio un problema al enviar el pedido, por favor inténtelo más tarde."),gmwa.logger.error("Order Add Product | API returned error: "+JSON.stringify(e))})):(gmwa.utils.showError("Pedido invalido","Uno o mas de los productos no pueden venderse en el día seleccionado"),gmwa.logger.error("Order Add Product | Invalid day to buy product(s)")))):gmwa.utils.showError("No es posible pedir en este momento","Vuelve cuando estemos abiertos y confirma tu pedido. Puedes retomarlo en la seccion de Pedidos del menu principal.")},gmwa.controllers.orderCheckout.validateOpenDays=function(e,o){var t=[];return 64==(64&e)&&t.push(0),32==(32&e)&&t.push(1),16==(16&e)&&t.push(2),8==(8&e)&&t.push(3),4==(4&e)&&t.push(4),2==(2&e)&&t.push(5),1==(1&e)&&t.push(6),!!t.includes(o)},gmwa.controllers.orderCheckout.validateCheckout=function(e){var o=[];return 1!=e.shipping&&2!=e.shipping&&o.push("Selecciona un metodo de entrega"),0===gmwa.controllers.orderCheckout.scheduleType||void 0!==e.scheduleValue&&void 0!==e.scheduleValue.date&&0!==e.scheduleValue.date.length&&void 0!==e.scheduleValue.hour&&0!==e.scheduleValue.hour.length&&-1!=e.scheduleValue.hour||(1===e.shipping?o.push("Selecciona un dia y una hora para la entrega de tu pedido"):o.push("Selecciona un dia y una hora para levantar tu pedido.")),void 0!==e.user.name&&null!==e.user.name&&0!==e.user.name.length||2!=e.shipping||o.push("Por favor ingresa un nombre para poder identificarte al momento de levantar tu pedido"),void 0!==e.user.phone&&null!==e.user.phone&&0<e.user.phone.length&&e.user.phone.length<8&&o.push("Por favor ingresa un numero de télefono válido"),void 0===e.user.address&&1==e.shipping&&o.push("Por favor ingresa una dirección donde enviar el pedido"),1==e.shipping&&(void 0===e.user.address.address||0===e.user.address.address.length||void 0===e.user.address.lat||0===e.user.address.lat.length?o.push("Por favor ingresa una dirección valida y especifica el punto en el mapa para facilitar la entrega"):void 0===gmwa.controllers.orderCheckout.coverageData?o.push("Por favor ingresa una direccion valida y especifica el punto en el mapa para facilitar la entrega"):gmwa.controllers.orderCheckout.coverageData.isInside||o.push("La direccion de entrega se encuentra fuera de nuestra zona de cobertura.")),o},gmwa.controllers.orderCheckout.hookSchedule=function(){$(".optionsDays").on("click",function(e){gmwa.controllers.orderCheckout.scheduleType=1,void 0===gmwa.controllers.orderCheckout.previousScheduleTable&&(gmwa.controllers.orderCheckout.previousScheduleTable=$("#opt-list-1")),gmwa.controllers.orderCheckout.previousScheduleTable.hide();var o=$(this).data("id");gmwa.controllers.orderCheckout.previousScheduleTable=$("#opt-list-"+o),gmwa.controllers.orderCheckout.previousScheduleTableSelect=gmwa.controllers.orderCheckout.previousScheduleTable.find("select"),gmwa.controllers.orderCheckout.previousScheduleTable.show(),$(".optionsDays div").removeClass("selected"),$("#optPickDate").removeClass("selected"),$(this).children("div").addClass("selected"),void 0===gmwa.controllers.orderCheckout.scheduleValue&&(gmwa.controllers.orderCheckout.scheduleValue={}),gmwa.controllers.orderCheckout.scheduleValue.date=$(this).data("date"),gmwa.controllers.orderCheckout.scheduleValue.hour="-1",gmwa.controllers.orderCheckout.previousScheduleTableSelect.val($("#opt-list-"+o+" select option:first").val())}),$(".optionsHours").on("change",function(e){void 0!==gmwa.controllers.orderCheckout.scheduleValue&&(gmwa.controllers.orderCheckout.scheduleValue.hour=gmwa.controllers.orderCheckout.previousScheduleTableSelect.val(),gmwa.logger.log(JSON.stringify(gmwa.controllers.orderCheckout.scheduleValue)))})},gmwa.controllers.orderCheckout.buildHoursOptions=function(e){var o,t,r=window.optionsTable[e],a="",n=null,e=dayjs(),l=(parseInt(e.hour()),null);if(r.isOpen)for(var s=0;s<r.hours.length;s++){o=r.hours[s].start,t=((r.hours[s].end<o?2400:r.hours[s].end)-o)/50/2,(n=dayjs()).hour(parseInt(o/100)),n.minute(parseInt(o%100));for(var i=0;i<t;i++)(l={}).start=n.format("HH:mm"),n.add(30,"m"),l.end=n.format("HH:mm"),a+='<option value="'+l.start+" - "+l.end+'" >'+l.start+" - "+l.end+"</option>",(l={}).start=n.format("HH:mm"),n.add(30,"m"),l.end=n.format("HH:mm"),a+='<option value="'+l.start+" - "+l.end+'" >'+l.start+" - "+l.end+"</option>"}else a='<option value="-1" > CERRADO </option>';return a},gmwa.controllers.orderCheckout.removePunctuation=function(e){return e.replace(/[á]/g,"a").replace(/[é]/g,"e").replace(/[ó]/g,"o").replace(/[í]/g,"i").replace(/[ú]/g,"u")},gmwa.controllers.orderCheckout.matchNames=function(e,o){for(var t=e.split(" "),r=o.split(" "),a=r.length,n=0,l=0;l<t.length;l++)for(var s=0;s<r.length;s++)gmwa.controllers.orderCheckout.removePunctuation(t[l].toLowerCase())==gmwa.controllers.orderCheckout.removePunctuation(r[s].toLowerCase())&&(n+=1);var i=n/a;return gmwa.logger.info("Comparing A: ["+e+"] vs B: ["+o+" returned "+n+" over"+a+" ("+i+")"),.5<=i},gmwa.controllers.orderCheckout.buscarCoordenadas=function(l,e,s,i){var c="Uruguay";null!=l&&null!=s?$.ajax("/pedido/gc/"+l+" "+e+","+s+","+c).done(function(e){if(e.status=0<e.results.length){e.data;for(var o=!1,t=!1,r=!1,a=!1,n=0;n<e.results[0].address_components.length;n++)switch(e.results[0].address_components[n].types[0]){case"route":gmwa.controllers.orderCheckout.matchNames(e.results[0].address_components[n].long_name,l)&&(o=!0);break;case"locality":gmwa.controllers.orderCheckout.matchNames(e.results[0].address_components[n].long_name,s)&&(t=!0);break;case"administrative_area_level_1":gmwa.controllers.orderCheckout.matchNames(e.results[0].address_components[n].long_name,s)&&(r=!0);break;case"country":gmwa.controllers.orderCheckout.matchNames(e.results[0].address_components[n].long_name,c)&&(a=!0)}i(o&&(t||r)&&a?e.results[0].geometry.location:null)}}):i(null)},gmwa.controllers.orderCheckout.initializeGoogleMap=function(e,o){var t=$("#mapa");0!=t.length&&""!=e&&""!=o&&0!=e&&0!=o&&(o={zoom:17,center:e=new google.maps.LatLng(e,o),mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!0,scrollwheel:!0,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}},t=new google.maps.Map(t[0],o),new google.maps.Marker({position:e,map:t,draggable:!0}).addListener("dragend",function(e){gmwa.controllers.orderCheckout.newLocation.lat=e.latLng.lat(),gmwa.controllers.orderCheckout.newLocation.lng=e.latLng.lng()}),setTimeout(function(){gmwa.logger.log("resize!")},1e3))},gmwa.controllers.orderCheckout.initializeLMap=function(o,t){var e;null==gmwa.controllers.orderCheckout.map&&($("#mapa"),e=gmwa.controllers.orderCheckout.isMobile,""!=o)&&""!=t&&0!=o&&0!=t&&(gmwa.logger.log("Initializing LMaps..."),gmwa.components.maps.instance.initMapAsync("mapa",o,t,16,e,function(e){gmwa.controllers.orderCheckout.map=e,gmwa.controllers.orderCheckout.marker=gmwa.components.maps.instance.addMarkerDraggable(gmwa.controllers.orderCheckout.map,o,t),gmwa.controllers.orderCheckout.marker.on("dragend",function(e){e=e.target.getLatLng();gmwa.controllers.orderCheckout.newLocation.lat=e.lat,gmwa.controllers.orderCheckout.newLocation.lng=e.lng,gmwa.controllers.orderCheckout.map.panTo(new L.LatLng(e.lat,e.lng))})}))};(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.orderView={};var status=null,dateAccepted=null,estimatedTime=null,promised=null,scheduleType=null,scheduleValueDate=null,scheduleValueHour=null,openedCart=!1;gmwa.controllers.orderView.init=function(){var e;$("#mi-reqs").addClass("u-tb-item-selected"),gmwa.logger.log("OrderView|Init..."),gmwa.components.header.init(),dayjs.extend(window.dayjs_plugin_relativeTime),$("#orevprocessval").change(function(e){this.checked?($("#trwrongprocessval").hide(),$("#trwrongprocesscomplex").hide()):($("#trwrongprocessval").show(),$("#trwrongprocesscomplex").show())}),$("#orevshippingval").change(function(e){this.checked?($("#trwrongshippingsval").hide(),$("#trwrongshippingslow").hide(),$("#trwrongshippingbad").hide()):($("#trwrongshippingsval").show(),$("#trwrongshippingslow").show(),$("#trwrongshippingbad").show())}),$("#orevproductval").change(function(e){this.checked?($("#trwrongproductval").hide(),$("#trwrongproductdiff").hide()):($("#trwrongproductval").show(),$("#trwrongproductdiff").show())}),$("#doSendReview").click(gmwa.controllers.orderView.sendReview),"ACEPTADO"==(status=$("#dataStatus").attr("data-status"))&&(dateAccepted=$("#dataFecha").attr("data-date"),estimatedTime=$("#dataFecha").attr("data-estimated"),scheduleType=$("#dataFecha").attr("data-scheduletype"),scheduleValueDate=$("#dataFecha").attr("data-schedulevaluedate"),scheduleValueHour=$("#dataFecha").attr("data-schedulevaluehour"),0==scheduleType?promised=dayjs(dateAccepted).add(estimatedTime,"m"):(promised=dayjs(scheduleValueDate),e=scheduleValueHour.replace(" ","").split("-")[0].split(":"),promised.hour(e[0]),promised.minute(e[1]),promised.second(0)),gmwa.controllers.orderView.reloj()),$("#cart-checkedout-title").click(function(){openedCart?($("#cart-checked-table").hide(),$("#cart-checkedout-title > i").removeClass("fa-caret-left"),$("#cart-checkedout-title > i").addClass("fa-caret-down")):($("#cart-checked-table").show(),$("#cart-checkedout-title > i").removeClass("fa-caret-down"),$("#cart-checkedout-title > i").addClass("fa-caret-left")),openedCart=!openedCart})},gmwa.controllers.orderView.reloj=function(){var e,o=dayjs().to(promised);dayjs()>=promised?(e=$('<div style="font-size: 17px;line-height: 20px;">El pedido ya deberia haberse entregado</div>'),$("#minutes").html(e)):$("#minutes").html(o),setTimeout(function(){gmwa.controllers.orderView.reloj()},6e4)},gmwa.controllers.orderView.sendReview=function(e){e.preventDefault();e={token:$("#orevToken").val(),text:$("#orevDesc").val(),processVal:$("#orevprocessval").is(":checked")?1:0,shippingVal:$("#orevshippingval").is(":checked")?1:0,productVal:$("#orevproductval").is(":checked")?1:0,wrongProcessComplex:$("#orevwrongprocesscomplex").is(":checked")?1:0,wrongShippingSlow:$("#qrevwrongshippingslow").is(":checked")?1:0,wrongShippingBad:$("#orevwrongshippingbad").is(":checked")?1:0,wrongProductDiff:$("#qrevwrongproductdiff").is(":checked")?1:0},e=JSON.stringify(e);$.ajax({type:"POST",url:"/pedido/review",data:e,contentType:"application/json"}).done(function(e){void 0===gmwa.controllers.orderView.reviewDoneModal&&($("body").append($('<div class="tiny reveal u-reveal" id="cord" data-reveal data-animation-in="fade-in" data-animation-out="fade-out" data-close-on-click="false" data-close-on-esc="false"><div class="u-reveal-body"></div><div class="u-reveal-footer"><button id="cordClose" type="button" class="alert button">Cerrar</button></div></div>')),gmwa.controllers.orderView.reviewDoneModal=$("#cord"),gmwa.controllers.orderView.reviewDoneModal.foundation()),$("#cord .u-reveal-body").html(e),$("#cordClose").click(function(e){gmwa.controllers.orderView.reviewDoneModal.foundation("close"),document.location.href="/pedidos"}),gmwa.controllers.orderView.reviewDoneModal.foundation("open")}).fail(function(e){gmwa.logger.error("Order Review | API returned error: "+JSON.stringify(e))})};(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.productOrderMenu={};var currentItem={},actualPrice=0,selectPrice=0,originalPrice=0;gmwa.controllers.productOrderMenu.init=function(){gmwa.components.header.init(),console.log("---------------- INICIANDO PRODUCT ORDER MENU"),currentItem.customFields=[],currentItem.quantity=1,actualPrice=parseFloat($("#price").val()),currentItem.price=actualPrice,currentItem.originalPrice=actualPrice,originalPrice=actualPrice,gmwa.controllers.storeSmall.initProductControls();var e=document.createElement("script");e.src="https://cdn.rawgit.com/igorlino/elevatezoom-plus/1.1.6/src/jquery.ez-plus.js",e.onload=function(){var e=document.createElement("script");e.src="/js/vendors/photoswipe/dist/photoswipe.min.js",e.onload=function(){var e=document.createElement("script");e.src="/js/vendors/photoswipe/dist/photoswipe-ui-default.min.js",e.onload=function(){gmwa.controllers.productOrderMenu.pswp=$(".pswp")[0],gmwa.controllers.productOrderMenu.pswpItems=[],$(".additional-image, #adImgGal img").each(function(){var e,o,t;"moreImages"!=$(this).attr("id")&&(e=$(this).data("zoom-image"),o=(t=$(this).data("size").split("x"))[0],t=t[1],gmwa.controllers.productOrderMenu.pswpItems.push({src:e,w:o,h:t}))}),gmwa.utils.isMobile()?(gmwa.controllers.productOrderMenu.imagesSwiper=new Swiper("#adImgGal",{slidesPerView:1,paginationClickable:!1,spaceBetween:0,pagination:{el:"#adImgGalPag",type:"bullets"}}),gmwa.controllers.productOrderMenu.imagesSwiper=new Swiper("#relProds",{slidesPerView:1.3,paginationClickable:!1,spaceBetween:0,pagination:{el:"#relProdsPag",type:"bullets"}}),$("#adImgGal img").on("click",function(e){e.preventDefault();e=parseInt($(this).data("index"));new PhotoSwipe(gmwa.controllers.productOrderMenu.pswp,PhotoSwipeUI_Default,gmwa.controllers.productOrderMenu.pswpItems,{index:e,bgOpacity:.7,showHideOpacity:!0,shareEl:!1,fullscreenEl:!1,tapToClose:!0,preload:[0,0]}).init()})):($(".additional-image").mouseover(function(){var e=$(this).attr("data-image"),e=($("#principal-image").attr("src",e),$(".zoomContainer").remove(),$("#principal-image").removeData("ezPlus"),$("#principal-image").data("zoom-image",$(this).data("zoom-image")),$(this).data("index"));$("#principal-image").data("index",e),$("#principal-image").ezPlus({zoomType:"inner",cursor:"crosshair"})}),$("#principal-image").ezPlus({zoomType:"inner",cursor:"crosshair"}),$("#principal-image").on("click",function(e){e.preventDefault();e=parseInt($("#principal-image").data("index"));new PhotoSwipe(gmwa.controllers.productOrderMenu.pswp,PhotoSwipeUI_Default,gmwa.controllers.productOrderMenu.pswpItems,{index:e,bgOpacity:.7,showHideOpacity:!0,shareEl:!1,fullscreenEl:!1,tapToClose:!0,preload:[0,0]}).init()}))},document.body.appendChild(e)},document.body.appendChild(e)},document.body.appendChild(e),$("#pdForm").submit(function(e){gmwa.controllers.storeSmall.addProductCheckMandatories()?($("#lblError").html(""),$("#ay mama").prop("disabled",!0),$("#ompaModify").prop("disabled",!0),gmwa.utils.showProgress("Enviando","Agregando producto al carrito...",!0,!0)):($("#lblError").html("<strong>Campos invalidos</strong> Ingrese todos los datos obligatorios"),e.preventDefault())}),$("#pdForm input[type=radio]").on("change invalid",function(){var e=$(this).get(0);e.setCustomValidity(""),e.validity.valid||e.setCustomValidity("Porfavor seleccione una de estas opciones")})};(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.quoteRequest={},gmwa.controllers.quoteRequest.videoDevices=[],gmwa.controllers.quoteRequest.videoDevicesIndex=0,gmwa.controllers.quoteRequest.stream=void 0,gmwa.controllers.quoteRequest.addStoresToggle=!1,gmwa.controllers.quoteRequest.init=function(){gmwa.components.header.init(),gmwa.services.worker.onInitializeState(function(e){gmwa.logger.log("onInitializeState | "+JSON.stringify(e)),e.isPushSupported?(gmwa.controllers.quoteRequest.isPushEnabled=e.isPushEnabled,e.isPushEnabled?($("#qrNotifyMe i").removeClass("fa-bell-slash-o"),$("#qrNotifyMe i").addClass("fa-bell-o"),$("#qrNotifyMeDesc").html('<span style="color: #4CAF50;">Recibiras notificaciones en este dispositivo</span>')):($("#qrNotifyMe i").removeClass("fa-bell-o"),$("#qrNotifyMe i").addClass("fa-bell-slash-o"),$("#qrNotifyMeDesc").html('<span style="color: #FF9800;">No recibiras notificaciones</span>'))):$("#qrNotifyMeCntr").hide()}),$("#qrNotifyMe").click(function(e){$("#qrNotifyMe").prop("disabled",!0),e.preventDefault(),gmwa.controllers.quoteRequest.isPushEnabled?gmwa.webpush.unsubscribe(function(e){0===e?($("#qrNotifyMe i").removeClass("fa-bell-o"),$("#qrNotifyMe i").addClass("fa-bell-slash-o"),gmwa.controllers.quoteRequest.isPushEnabled=!1,$("#qrNotifyMeDesc").html('<span style="color: #FF9800;">No recibiras notificaciones</span>')):-1==e&&gmwa.logger.error("Unubscribe returned "+e),$("#qrNotifyMe").prop("disabled",!1)}):gmwa.webpush.subscribe(function(e){0===e?($("#qrNotifyMe i").removeClass("fa-bell-slash-o"),$("#qrNotifyMe i").addClass("fa-bell-o"),$("#qrNotifyMeDesc").html('<span style="color: #4CAF50;">Recibiras notificaciones en este dispositivo</span>'),gmwa.controllers.quoteRequest.isPushEnabled=!0):-1==e?($("#qrNotifyMeError1").show(),$("#qrNotifyMe i").removeClass("fa-bell-o"),$("#qrNotifyMe i").addClass("fa-bell-slash-o"),gmwa.controllers.quoteRequest.isPushEnabled=!1):-2==e&&($("#qrNotifyMeError2").show(),$("#qrNotifyMe i").removeClass("fa-bell-o"),$("#qrNotifyMe i").addClass("fa-bell-slash-o"),gmwa.controllers.quoteRequest.isPushEnabled=!1),$("#qrNotifyMe").prop("disabled",!1)})}),$("#qrSubmit").click(function(e){e.preventDefault(),gmwa.controllers.quoteRequest.addImagesToForm();e=gmwa.controllers.quoteRequest.validateForm();0<e.length?($("#errMsg").html(e),$("#errMsg").show()):($("#errMsg").hide(),gmwa.utils.showProgress("Enviando solicitud","Espere por favor...",!0,!0),grecaptcha.execute())}),gmwa.controllers.requestsList.initQuoteHandlers(),$("qBtnAccept").click(gmwa.controllers.requestsList.quoteAcceptClick),gmwa.controllers.requestsList.token=$("#req-info").data("token"),$("input[name=qrScheduleType]").change(function(){4==$("input[name=qrScheduleType]:checked").val()?$("#dpMonths").show():$("#dpMonths").hide()}),$("#qrevpriceval").change(function(){this.checked?($("#trpricevalwrong").hide(),$("#trwrongpriceexpensive").hide()):($("#trpricevalwrong").show(),$("#trwrongpriceexpensive").show())}),$("#qrevworkval").change(function(){this.checked?($("#trwrongworkbad").hide(),$("#trwrongworkslow").hide(),$("#trwrongworksloppy").hide()):($("#trwrongworkbad").show(),$("#trwrongworkslow").show(),$("#trwrongworksloppy").show())}),$("#photosAdd").click(function(e){$("#photoLoader").click()}),$("#photoLoader").change(function(e){var o,e=e.target.files[0];e.type.match(/image.*/)&&((o=new FileReader).onload=function(e){$("<img>",{src:e.target.result}).load(function(){var e=gmwa.controllers.quoteRequest.buildCanvasElement(this.naturalWidth,this.naturalHeight);e.element.getContext("2d").drawImage(this,0,0,this.naturalWidth,this.naturalHeight),$("#canvas-"+e.id+" > i").click(function(e){$(this).parent().remove(),gmwa.controllers.quoteRequest.checkAddPhotoButton()}),gmwa.controllers.quoteRequest.checkAddPhotoButton()})},o.readAsDataURL(e))}),$(".u-option input").click(function(e){var o=$(this).prop("name");null!=gmwa.controllers.quoteRequest[o]&&gmwa.controllers.quoteRequest[o]==$(this).prop("value")?($(this).prop("checked",!1),gmwa.controllers.quoteRequest[o]=void 0):gmwa.controllers.quoteRequest[o]=$(this).prop("value")}),gmwa.controllers.quoteRequest.initTakePhoto(),$("#changeUserLocation").on("click",function(e){e.preventDefault(),$("#qrLocation").val(""),$("#qrLocationCntrForm").show(),$("#qrLocationCntrLabel").hide(),$(this).hide()}),$("#changeUserData").on("click",function(e){e.preventDefault(),$("#qrUserName").val(""),$("#qrUserEmail").val(""),$("#qrUserTel").val(""),$("#qrUserDataForm").show(),$("#qrUserDataLabel").hide(),$(this).hide()}),$("#qrastoggle-all").on("click",function(e){$("#qras-cntr").find("input:checkbox").prop("checked",!gmwa.controllers.quoteRequest.addStoresToggle),gmwa.controllers.quoteRequest.addStoresToggle=!gmwa.controllers.quoteRequest.addStoresToggle,gmwa.controllers.quoteRequest.countAdditionalStores()}),$("#qras-cntr").find("input:checkbox").on("click",function(e){gmwa.controllers.quoteRequest.countAdditionalStores(),$(this).parent().hasClass("label-checked")?$(this).parent().removeClass("label-checked"):$(this).parent().addClass("label-checked")});var e=document.createElement("script");e.src="/js/vendors/foundation-datepicker/foundation-datepicker.min.js",e.onload=function(){$("#dpMonths").fdatepicker()},document.body.appendChild(e)};var quoteRequestSendRequest=function(e){console.log("reCaptcha user response :"),console.log(e),$("#qrForm").submit()};gmwa.controllers.quoteRequest.initTakePhoto=function(){navigator.mediaDevices&&($("#photosTake").show(),$("#photosTake").click(function(e){void 0===gmwa.controllers.quoteRequest.addPhotoPreview&&(gmwa.controllers.quoteRequest.addPhotoPreview=document.getElementById("addPhotoPreviewVideo")),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&gmwa.controllers.quoteRequest.addPhotoModal.foundation("open")}),$("body").append($('<div class="reveal u-reveal small" id="addPhotoModal" data-reveal style="background-color: #000;"><div class="u-reveal-body"><div class="u-quote-form-photoadd"><p>Asegurese de que la imagen salga clara y en foco</p><video id="addPhotoPreviewVideo" width="100%" height="auto" autoplay></video><div class="photoadd-btns-cntr"><button id="rotateCamera" class="button small" style="display:none"><i class="fa fa-retweet" aria-hidden="true"></i></button><button id="addPhotoSnap" class="button small right small-expanded"><i class="fa fa-camera" aria-hidden="true"></i></button><button id="closePhotoSnap" class="button small secondary small-expanded">Cancelar</button></div></div></div></div>')),gmwa.controllers.quoteRequest.addPhotoModal=$("#addPhotoModal"),gmwa.controllers.quoteRequest.addPhotoModal.foundation(),$(document).on("open.zf.reveal","#addPhotoModal[data-reveal]",function(){navigator.mediaDevices.enumerateDevices().then(function(e){for(var o,t=0;t!==e.length;++t){var r=e[t];"videoinput"===r.kind&&gmwa.controllers.quoteRequest.videoDevices.push(r.deviceId)}0===gmwa.controllers.quoteRequest.videoDevices.length?gmwa.logger.log("No video devices found!"):(1<gmwa.controllers.quoteRequest.videoDevices.length&&($("#rotateCamera").click(function(e){var o=gmwa.controllers.quoteRequest.videoDevicesIndex+1,t=(o==gmwa.controllers.quoteRequest.videoDevices.length&&(o=0),gmwa.controllers.quoteRequest.videoDevicesIndex=o,{video:{deviceId:gmwa.controllers.quoteRequest.videoDevices[o]}});gmwa.logger.log("Using device at index "+o+" with deviceId "+t.video.deviceId),gmwa.controllers.quoteRequest.playTakePhoto(t)}),$("#rotateCamera").show()),gmwa.controllers.quoteRequest.videoDevicesIndex=gmwa.controllers.quoteRequest.videoDevices.length-1,o={video:{deviceId:gmwa.controllers.quoteRequest.videoDevices[gmwa.controllers.quoteRequest.videoDevicesIndex]}},gmwa.controllers.quoteRequest.playTakePhoto(o))}).catch(function(e){gmwa.logger.error("Could not enumerate devices: ",e)})}),$(document).on("closed.zf.reveal","#addPhotoModal[data-reveal]",function(){}),$("#closePhotoSnap").click(function(e){gmwa.controllers.quoteRequest.stopTakePhoto(),gmwa.controllers.quoteRequest.addPhotoModal.foundation("close")}),$("#addPhotoSnap").click(function(e){var o=gmwa.controllers.quoteRequest.buildCanvasElement(gmwa.controllers.quoteRequest.addPhotoPreview.videoWidth,gmwa.controllers.quoteRequest.addPhotoPreview.videoHeight);o.element.getContext("2d").drawImage(gmwa.controllers.quoteRequest.addPhotoPreview,0,0,gmwa.controllers.quoteRequest.addPhotoPreview.videoWidth,gmwa.controllers.quoteRequest.addPhotoPreview.videoHeight),$("#canvas-"+o.id+" > i").click(function(e){$(this).parent().remove(),gmwa.controllers.quoteRequest.checkAddPhotoButton()}),gmwa.controllers.quoteRequest.checkAddPhotoButton(),gmwa.controllers.quoteRequest.stopTakePhoto(),gmwa.controllers.quoteRequest.addPhotoModal.foundation("close")}))},gmwa.controllers.quoteRequest.playTakePhoto=function(t){gmwa.controllers.quoteRequest.stopTakePhoto(),gmwa.logger.log("Requesting stream at device "+t.video.deviceId+"..."),navigator.mediaDevices.getUserMedia(t).then(function(o){gmwa.controllers.quoteRequest.stream=o,gmwa.controllers.quoteRequest.addPhotoStream=o;try{gmwa.controllers.quoteRequest.addPhotoPreview.srcObject=o,gmwa.controllers.quoteRequest.addPhotoPreview.onloadedmetadata=function(e){gmwa.logger.log("Playing (1) stream at device "+t.video.deviceId+"."),gmwa.controllers.quoteRequest.addPhotoPreview.play()}}catch(e){gmwa.controllers.quoteRequest.addPhotoPreview.src=window.URL.createObjectURL(o),gmwa.logger.log("Playing (2) stream at device "+t.video.deviceId+"."),gmwa.controllers.quoteRequest.addPhotoPreview.play()}})},gmwa.controllers.quoteRequest.stopTakePhoto=function(){gmwa.controllers.quoteRequest.stream&&gmwa.controllers.quoteRequest.stream.getTracks().forEach(function(e){gmwa.logger.log("Stopping current stream"),e.stop()})},gmwa.controllers.quoteRequest.buildCanvasElement=function(e,o){var t=new Date,t=t.getHours()+"-"+t.getMinutes()+"-"+t.getSeconds();return $("#photosList").prepend($('<div id="canvas-'+t+'" class="u-picture-cntr"><i class="fa fa-times" aria-hidden="true"></i><canvas width="'+e+'" height="'+o+'"></canvas></div>')),{id:t,element:$("#canvas-"+t+" > canvas").get(0)}},gmwa.controllers.quoteRequest.checkAddPhotoButton=function(){var e=$("#photosList").children().length;0===e?($("#photosTake").text("Tomar con la cámara"),$("#photosTake").show(),$("#photosAdd").text("Cargar desde el dispositivo"),$("#photosAdd").show(),$("#photosMaxMsg").hide()):e<4?($("#photosAdd").text("Cargar otra"),$("#photosAdd").show(),$("#photosTake").text("Tomar otra"),$("#photosTake").show(),$("#photosMaxMsg").hide()):($("#photosTake").hide(),$("#photosAdd").hide(),$("#photosMaxMsg").show())},gmwa.controllers.quoteRequest.addImagesToForm=function(){var t=0;$(".u-picture-cntr canvas").each(function(e,o){gmwa.logger.log("Adding image "+t),$("<input>").attr({type:"hidden",id:"qImg-"+t,name:"qImg-"+t,value:o.toDataURL("image/jpeg",.92)}).appendTo("#qrForm"),t++}),$("<input>").attr({type:"hidden",id:"qImgTotal",name:"qImgTotal",value:t}).appendTo("#qrForm"),gmwa.logger.log("Added "+t+" images and total to form")},gmwa.controllers.quoteRequest.validateForm=function(){var e="";return 0===document.forms.qrForm.qrDesc.value.length&&(e="Ingresa una descripción de lo que necesitas."),0===document.forms.qrForm.qrScheduleType.value.length&&(0<e.length&&(e+="<br>"),e+="Ingresa para cuando lo necesitas."),0<document.forms.qrForm.qrUserEmail.value.length?document.forms.qrForm.qrUserEmail.validity.valid||(0<e.length&&(e+="<br>"),e+="Ingresa un correo electrónico válido."):0===document.forms.qrForm.qrUserEmail.value.length&&(0<e.length&&(e+="<br>"),e+="Ingresa un correo electrónico para que podamos enviarte la respuesta."),0===document.forms.qrForm.qrLocation.value.length&&(0<e.length&&(e+="<br>"),e+="Ingresa tu ubicación aproximada, calle, barrio o zona."),0===document.forms.qrForm.qrUserName.value.length&&(0<e.length&&(e+="<br>"),e+="Ingresa tu nombre."),0<document.forms.qrForm.qrUserTel.value.length&&(document.forms.qrForm.qrUserTel.validity.valid||(0<e.length&&(e+="<br>"),e+="Ingresa un número de teléfono válido.")),e},gmwa.controllers.quoteRequest.countAdditionalStores=function(){var o=0,e=($("#qras-cntr").find("input:checkbox").each(function(e){$(this).prop("checked")&&o++}),$("#qras-desc").data("store"));0==o?$("#qras-desc").html("Enviaremos la solicitud solo a "+e):$("#qras-desc").html("Enviaremos la solicitud a "+e+" y a "+o+" más")},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.quoteView={},gmwa.controllers.quoteView.init=function(){gmwa.components.header.init(),$("#mi-reqs").addClass("u-tb-item-selected"),gmwa.controllers.requestsList.token=$("#req-info").data("token"),$(".btnAccept").each(function(e){$(this).click(gmwa.controllers.requestsList.quoteAcceptClick)}),$("#qrevForm").submit(gmwa.controllers.requestsList.quoteSendReviewClick),$("#qrevpriceval").change(function(){this.checked?($("#trpricevalwrong").hide(),$("#trwrongpriceexpensive").hide()):($("#trpricevalwrong").show(),$("#trwrongpriceexpensive").show())}),$("#qrevworkval").change(function(){this.checked?($("#trwrongworkbad").hide(),$("#trwrongworkslow").hide(),$("#trwrongworksloppy").hide()):($("#trwrongworkbad").show(),$("#trwrongworkslow").show(),$("#trwrongworksloppy").show())}),gmwa.controllers.quoteView.initQuoteHandlers()},gmwa.controllers.quoteView.initQuoteHandlers=function(){$("body").append($('<div class="tiny reveal u-reveal" id="cqvm" data-reveal data-animation-in="fade-in" data-animation-out="fade-out" data-close-on-click="false" data-close-on-esc="false"><div class="u-reveal-body"></div><div class="u-reveal-footer"><button id="cqvmAccept" type="button" class="success button">Aceptar</button><button id="cqvmClose" type="button" class="alert button">Cancelar</button></div></div>')),gmwa.controllers.requestsList.confirmModal=$("#cqvm"),gmwa.controllers.requestsList.confirmModal.foundation(),$("body").append($('<div class="small reveal u-reveal" id="fcqvm" data-reveal data-animation-in="fade-in" data-animation-out="fade-out" data-close-on-click="false" data-close-on-esc="false"><div class="u-reveal-body"></div><div class="u-reveal-footer"><button id="fcqvmClose" type="button" class="button">Aceptar</button></div></div>')),gmwa.controllers.requestsList.finalModal=$("#fcqvm"),gmwa.controllers.requestsList.finalModal.foundation(),$("#qvmClose").click(function(e){gmwa.controllers.requestsList.orderViewModal.foundation("close")})},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.requestsList={},gmwa.controllers.requestsList.init=function(){gmwa.components.header.init(),$("#mi-reqs").addClass("u-tb-item-selected"),gmwa.controllers.requestsList.initQuoteHandlers(),$(".u-req-bottom-btns-link").click(function(e){e.preventDefault(),gmwa.controllers.requestsList.token=$(this).data("token");e="/components/pedidos/presupuesto/"+$(this).data("token");$.ajax(e).done(function(e){$("#qvm .u-reveal-body").html(e),$(".btnAccept").each(function(e){$(this).click(gmwa.controllers.requestsList.quoteAcceptClick)}),$("#qrevForm").submit(gmwa.controllers.requestsList.quoteSendReviewClick),$("#qrevpriceval").change(function(){this.checked?($("#trpricevalwrong").hide(),$("#trwrongpriceexpensive").hide()):($("#trpricevalwrong").show(),$("#trwrongpriceexpensive").show())}),$("#qrevworkval").change(function(){this.checked?($("#trwrongworkbad").hide(),$("#trwrongworkslow").hide(),$("#trwrongworksloppy").hide()):($("#trwrongworkbad").show(),$("#trwrongworkslow").show(),$("#trwrongworksloppy").show())}),gmwa.controllers.requestsList.orderViewModal.foundation("open")})})},gmwa.controllers.requestsList.initQuoteHandlers=function(){$("body").append($('<div class="tiny reveal u-reveal" id="cqvm" data-reveal data-animation-in="fade-in" data-animation-out="fade-out" data-close-on-click="false" data-close-on-esc="false"><div class="u-reveal-body"></div><div class="u-reveal-footer"><button id="cqvmAccept" type="button" class="success button">Aceptar</button><button id="cqvmClose" type="button" class="alert button gmbutton">Cancelar</button></div></div>')),gmwa.controllers.requestsList.confirmModal=$("#cqvm"),gmwa.controllers.requestsList.confirmModal.foundation(),$("body").append($('<div class="reveal u-reveal" id="qvm" data-reveal data-animation-in="fade-in" data-animation-out="fade-out"><div class="u-reveal-body"></div><div class="u-reveal-footer"><button id="qvmClose" type="button" class="button gmbutton">Cerrar</button></div></div>')),gmwa.controllers.requestsList.orderViewModal=$("#qvm"),gmwa.controllers.requestsList.orderViewModal.foundation(),$("body").append($('<div class="small reveal u-reveal" id="fcqvm" data-reveal data-animation-in="fade-in" data-animation-out="fade-out" data-close-on-click="false" data-close-on-esc="false"><div class="u-reveal-body"></div><div class="u-reveal-footer"><button id="fcqvmClose" type="button" class="button gmbutton">Aceptar</button></div></div>')),gmwa.controllers.requestsList.finalModal=$("#fcqvm"),gmwa.controllers.requestsList.finalModal.foundation(),$("#qvmClose").click(function(e){gmwa.controllers.requestsList.orderViewModal.foundation("close")})},gmwa.controllers.requestsList.quoteAcceptClick=function(e){gmwa.controllers.requestsList.retailerName=$(this).data("name"),gmwa.controllers.requestsList.respId=$(this).data("id");var o='<div style="width: 100%;text-align: center;padding: 20px 0px;"><i class="fa fa-handshake-o" aria-hidden="true" style="font-size: 50px;color: #FFC107;"></i></div><div style="text-align: center;font-size: 16px;line-height: 19px;font-weight: 600;">Confirma que acepta el presupuesto enviado por '+gmwa.controllers.requestsList.retailerName+'?</div><div style="font-size: 80%;line-height: 110%;text-align: center;padding: 20px 10px;color: #777;"><i class="fa fa-info-circle" aria-hidden="true"></i> Una vez aceptado el presupuesto, le enviaremos una notificacion a '+gmwa.controllers.requestsList.retailerName+" quien se pondra en contacto con usted para afinar los detalles necesarios.</div>";$("#cqvm .u-reveal-body").html(o),$("#cqvmClose").click(gmwa.controllers.requestsList.quoteAcceptConfirmCancelClick),$("#cqvmAccept").click(gmwa.controllers.requestsList.quoteAcceptConfirmOKClick),gmwa.controllers.requestsList.confirmModal.foundation("open")},gmwa.controllers.requestsList.quoteAcceptConfirmCancelClick=function(e){gmwa.controllers.requestsList.confirmModal.foundation("close")},gmwa.controllers.requestsList.quoteAcceptConfirmOKClick=function(e){gmwa.controllers.requestsList.confirmModal.foundation("close"),gmwa.utils.showProgress("Enviando confirmación","Por favor espere...",!0,!1);var o="/components/presupuesto/ac/"+gmwa.controllers.requestsList.token+"/"+gmwa.controllers.requestsList.respId;$.ajax(o).done(function(e){gmwa.utils.hideProgress(),$("#fcqvm .u-reveal-body").html(e),$("#fcqvmClose").click(function(e){gmwa.controllers.requestsList.finalModal.foundation("close"),document.location.href="/pedidos"}),gmwa.controllers.requestsList.finalModal.foundation("open")}).fail(function(e){gmwa.utils.hideProgress(),gmwa.utils.showError("No se pudo enviar la confirmación","Ocurrio un problema al enviar la confirmación, por favor inténtelo más tarde."),gmwa.logger.error("DoQuoteAccept | API returned error: "+JSON.stringify(e))})},gmwa.controllers.requestsList.quoteSendReviewClick=function(e){e.preventDefault();e={token:$("#qrevToken").val(),text:$("#qrevDesc").val(),workVal:$("#qrevworkval").is(":checked")?1:0,priceVal:$("#qrevpriceval").is(":checked")?1:0,wrongWorkBad:$("#qrevwrongworkbad").is(":checked")?1:0,wrongWorkSlow:$("#qrevwrongworkslow").is(":checked")?1:0,wrongWorkSloppy:$("#qrevwrongworksloppy").is(":checked")?1:0,wrongPriceExpensive:$("#qrevwrongpriceexpensive").is(":checked")?1:0};gmwa.utils.showProgress("Enviando reseña","Por favor espere...",!0,!1);$.ajax({type:"POST",url:"/presupuesto/review",data:JSON.stringify(e),contentType:"application/json"}).done(function(e){gmwa.utils.hideProgress(),void 0===gmwa.controllers.requestsList.reviewDoneModal&&($("body").append($('<div class="tiny reveal u-reveal" id="cqrd" data-reveal data-animation-in="fade-in" data-animation-out="fade-out" data-close-on-click="false" data-close-on-esc="false"><div class="u-reveal-body"></div><div class="u-reveal-footer"><button id="cqrdClose" type="button" class="alert button">Cerrar</button></div></div>')),gmwa.controllers.requestsList.reviewDoneModal=$("#cqrd"),gmwa.controllers.requestsList.reviewDoneModal.foundation()),$("#cqrd .u-reveal-body").html(e),$("#cqrdClose").click(function(e){gmwa.controllers.requestsList.reviewDoneModal.foundation("close"),document.location.href="/pedidos"}),gmwa.controllers.requestsList.reviewDoneModal.foundation("open")}).fail(function(e){gmwa.utils.hideProgress(),gmwa.utils.showError("No se pudo enviar la reseña","Ocurrio un problema al enviar la reseña, por favor inténtelo más tarde."),gmwa.logger.error("DoQuoteReview | API returned error: "+JSON.stringify(e))})},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.store={},gmwa.controllers.store.init=function(){("1"==$("#retInfoCntr").data("stype")?gmwa.controllers.storeBig:gmwa.controllers.storeSmall).init()};(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.storeBig={},gmwa.controllers.storeBig.mobileCarritoOpened=!1,gmwa.controllers.storeBig.mobileCarritoQty=null,gmwa.controllers.storeBig.mobileCarritoViewBtn=null,gmwa.controllers.storeBig.hoursOpened=!1,gmwa.controllers.storeBig.sectionsOpened=!1,gmwa.controllers.storeBig.colors=["#fc8c69","#006fed","#379300","#d300cf","#d1a504","#750072","#01a4a8","#b32e00","#4db8cd","#de95b9"];var pList={},currentItem=(pList.plist=[],{}),idSelect=0,carrito=null,productName="",actualPrice=0,selectPrice=0,originalPrice=0,aux=-1,city="Montevideo",address1="",country="Uruguay";gmwa.controllers.storeBig.init=function(){var e=gmwa.utils.isMobile();gmwa.logger.log("storeBig|Init..."),gmwa.components.header.init(),currentItem.customFields=[],currentItem.quantity=$("#quantityItem").val(),$("body").append($('<div class="reveal u-reveal small" id="addProduct" data-reveal><div class="u-reveal-body"></div></div>')),gmwa.controllers.storeBig.addProductModal=$("#addProduct"),gmwa.controllers.storeBig.addProductModal.foundation(),$("#closeButton").click(function(e){gmwa.controllers.storeBig.addProductModal.foundation("close")}),$(".u-menu-item").click(function(e){e.preventDefault(),gmwa.utils.showProgress("","",!1,!1),productName=$(this).attr("data-name");e="/pedido/producto/"+$(this).data("id")+"/1";$.ajax(e).done(function(e){$("#addProduct .u-reveal-body").html(e),gmwa.controllers.storeBig.addProductOpened(-1),gmwa.controllers.storeBig.addProductModal.foundation("open"),gmwa.utils.hideProgress()})}),$("#buttonCheckout, #lnkCheckout").click(function(e){e.preventDefault(),gmwa.controllers.storeBig.goToCheckout()}),$("#bottomCartView").click(function(e){gmwa.controllers.storeBig.mobileCarritoOpened?($("#carritoCntr").hide(),gmwa.controllers.storeBig.mobileCarritoViewBtn.text("PEDIDO")):($("#carritoCntr").show(),gmwa.controllers.storeBig.mobileCarritoViewBtn.text("CERRAR")),gmwa.controllers.storeBig.mobileCarritoOpened=!gmwa.controllers.storeBig.mobileCarritoOpened}),$("#bottomCartClose").click(function(e){$("#carritoCntr").hide(),gmwa.controllers.storeBig.mobileCarritoViewBtn.text("PEDIDO"),gmwa.controllers.storeBig.mobileCarritoOpened=!1}),gmwa.controllers.storeBig.mobileCarritoViewBtn=$("#bottomCartView > :nth-child(2)"),gmwa.controllers.storeBig.mobileCarritoQty=$("#bottomCartView > :nth-child(3)"),$("#btnprodgroups").click(function(e){gmwa.controllers.storeBig.sectionsOpened?$("#prodgroups").hide():$("#prodgroups").show(),gmwa.controllers.storeBig.sectionsOpened=!gmwa.controllers.storeBig.sectionsOpened}),$("#prodgroups ul li").click(function(e){Foundation.MediaQuery.is("small only")&&($("#prodgroups").hide(),gmwa.controllers.storeBig.sectionsOpened=!1)}),$("#hourToday").click(function(e){gmwa.controllers.storeBig.hoursOpened?$("#restHours").hide():$("#restHours").show(),gmwa.controllers.storeBig.hoursOpened=!gmwa.controllers.storeBig.hoursOpened}),null!=window.loadCarrito&&(carrito=window.loadCarrito),$("#openCoverage").click(function(e){e.preventDefault(),void 0===window.coverageData?(gmwa.controllers.storeBig.viewCoverageModal=$("#viewCoverage"),e="/pedidos/listDeliveryCoverage/"+$("#retInfoCntr").data("idr")+"/"+$("#retInfoCntr").data("ids"),gmwa.utils.showProgress("","",!1,!1),$.ajax(e).done(function(e){gmwa.utils.hideProgress(),window.coverageData=e,gmwa.controllers.storeBig.viewCoverageModal.foundation("open"),setTimeout(function(){window.coverageData.storeLat=parseFloat(window.coverageData.storeLat),window.coverageData.storeLng=parseFloat(window.coverageData.storeLng);var e=!1;if(0<window.coverageData.zones.length?(0==gmwa.mapsFW?gmwa.controllers.storeBig.loadCoverageGMap():gmwa.controllers.storeBig.loadCoverageLMap(),e=!0):($("#btnShowUrban").hide(),$("#covUrban").hide()),0<window.coverageData.states.length){for(var o="<ul>",t=0;t<window.coverageData.states.length;t++)o+="<li>"+window.coverageData.states[t].name+"</li>";o+="</ul>",$("#covNational > div").html(o),e||$("#covNational").show()}else $("#btnShowNational").hide(),$("#covNational").hide()},400)}).fail(function(e){gmwa.utils.hideProgress(),gmwa.logger.error("listDeliveryCoverage | API returned error: "+JSON.stringify(e))})):gmwa.controllers.storeBig.viewCoverageModal.foundation("open")}),$("#btnShowUrban").click(function(){$("#btnShowUrban").css("font-weight","600"),$("#btnShowNational").css("font-weight","100"),$("#covUrban").show(),$("#covNational").hide()}),$("#btnShowNational").click(function(){$("#btnShowUrban").css("font-weight","100"),$("#btnShowNational").css("font-weight","600"),$("#covUrban").hide(),$("#covNational").show()}),e?new Swiper("#swipHighlights",{slidesPerView:1.3,paginationClickable:!1,navigation:{nextEl:"#next-sw-nearprms",prevEl:"#prev-sw-nearprms"},spaceBetween:10}):new Swiper("#swipHighlights",{slidesPerView:2.3,paginationClickable:!1,navigation:{nextEl:"#next-sw-nearprms",prevEl:"#prev-sw-nearprms"},spaceBetween:10})},gmwa.controllers.storeBig.loadCoverageLMap=function(){gmwa.logger.log("Initializing Maps...");var e=$("#coverageMap").data("im"),l=window.coverageData.storeLat,s=window.coverageData.storeLng;gmwa.components.maps.instance.initMapAsync("coverageMap",l,s,16,e,function(e){gmwa.controllers.storeBig.map=e,gmwa.controllers.reportarError.marker=gmwa.components.maps.instance.addMarkerSimple(gmwa.controllers.storeBig.map,l,s);for(var o=window.coverageData.zones.length,t=[],r="",a="",n=0;n<o;n++)L.polygon(window.coverageData.zones[n].polygon,{color:gmwa.controllers.storeBig.colors[n],weight:1}).addTo(gmwa.controllers.storeBig.map),a=0==window.coverageData.zones[n].amount?"sin costo":"$U "+window.coverageData.zones[n].amount,r+='<div style="background-color:'+gmwa.controllers.storeBig.colors[n]+';width:15px;height:15px;display:inline-block;margin: -2px 4px -2px 10px;border-radius: 50%;"></div><div style="display:inline-block">'+window.coverageData.zones[n].name+" ("+a+")</div>",t=t.concat(window.coverageData.zones[n].polygon);gmwa.controllers.storeBig.map.fitBounds(t),$("#coverageZonesDesc").html(r)})},gmwa.controllers.storeBig.loadCoverageGMap=function(){covMap=new google.maps.Map(document.getElementById("coverageMap"),{center:{lat:window.coverageData.storeLat,lng:window.coverageData.storeLng},styles:[{elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"geometry.stroke",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#0080ff"},{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.stroke",stylers:[{visibility:"on"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]}),google.maps.event.addListenerOnce(covMap,"idle",function(){new google.maps.Marker({map:covMap,position:{lat:window.coverageData.storeLat,lng:window.coverageData.storeLng}});for(var e=new google.maps.LatLngBounds,o="",t="",r=window.coverageData.zones.length,a=0;a<r;a++){(polygon=new google.maps.Polygon({paths:window.coverageData.zones[a].polygon,strokeColor:gmwa.controllers.storeBig.colors[a],strokeWeight:.5,fillColor:gmwa.controllers.storeBig.colors[a],fillOpacity:.35})).zonaIndex=a,polygon.setMap(covMap);for(var n=0;n<window.coverageData.zones[a].polygon.length;n++)e.extend(window.coverageData.zones[a].polygon[n]);t=0==window.coverageData.zones[a].amount?"sin costo":"$U "+window.coverageData.zones[a].amount,o+='<div style="background-color:'+gmwa.controllers.storeBig.colors[a]+';width:15px;height:15px;display:inline-block;margin: -2px 4px -2px 10px;border-radius: 50%;"></div><div style="display:inline-block">'+window.coverageData.zones[a].name+" ("+t+")</div>"}covMap.fitBounds(e),$("#coverageZonesDesc").html(o)})},gmwa.controllers.storeBig.calculateItemPrice=function(e){for(var o=e.originalPrice,t=0;t<e.customFields.length;t++)o+=e.customFields[t].price;return console.log("---------------------------------- EL QUANTITY ES"),console.log($("#quantityItem").val()),o*=$("#quantityItem").val()},gmwa.controllers.storeBig.getMainIDs=function(){var e=document.location.href.split("/"),o={};return 6===e.length?(o.idr=e[e.length-4],o.ids=e[e.length-3],o.token=null):7===e.length&&(o.idr=e[e.length-5],o.ids=e[e.length-4],e=e[e.length-1].split("#"),o.token=e[0]),o},(gmwa=gmwa||{}).controllers=gmwa.controllers||{},gmwa.controllers.storeSmall={},gmwa.controllers.storeSmall.mobileCarritoOpened=!1,gmwa.controllers.storeSmall.mobileCarritoQty=null,gmwa.controllers.storeSmall.mobileCarritoViewBtn=null,gmwa.controllers.storeSmall.hoursOpened=!1,gmwa.controllers.storeSmall.sectionsOpened=!1,gmwa.controllers.storeSmall.colors=["#fc8c69","#006fed","#379300","#d300cf","#d1a504","#750072","#01a4a8","#b32e00","#4db8cd","#de95b9"];(pList={}).plist=[],currentItem={},idSelect=0,carrito=null,productName="",actualPrice=0,selectPrice=0,originalPrice=0,aux=-1,city="Montevideo",address1="",country="Uruguay";gmwa.controllers.storeSmall.init=function(){gmwa.logger.log("storeSmall|Init..."),gmwa.components.header.init(),currentItem.customFields=[],$("body").append($('<div class="reveal u-reveal small" id="addProduct" data-reveal data-v-offset="0" style="padding: 0px;max-width:600px;top:20px"><div class="u-reveal-body"></div></div>')),gmwa.controllers.storeSmall.addProductModal=$("#addProduct"),gmwa.controllers.storeSmall.addProductModal.foundation(),gmwa.controllers.storeSmall.addProductModal.on("closeme.zf.reveal",function(){gmwa.controllers.storeSmall.modalOpen||(gmwa.controllers.storeSmall.scrollPosition=$(document).scrollTop())}),gmwa.controllers.storeSmall.addProductModal.on("open.zf.reveal",function(){gmwa.controllers.storeSmall.modalOpen=!0}),gmwa.controllers.storeSmall.addProductModal.on("closed.zf.reveal",function(){$(document).scrollTop(gmwa.controllers.storeSmall.scrollPosition),gmwa.controllers.storeSmall.modalOpen=!1}),$("[data-reveal]").on("closed.zf.reveal",function(){"addProduct"==$(this).attr("id")&&($("#adImgGal").each(function(){this.swiper&&this.swiper.destroy()}),$("#adImgGal").remove())}),$("#closeButton").click(function(e){gmwa.controllers.storeSmall.addProductModal.foundation("close")}),$(".u-menu-item, .u-prod-card > a").click(function(e){e.preventDefault(),gmwa.utils.showProgress("","",!1,!1),productName=$(this).attr("data-name"),0==(token=$("#carritoCntr").data("token")).length&&(token="-");e="/pd/component/"+$(this).data("id")+"/"+$(this).attr("data-ids")+"/"+$(this).attr("data-ids")+"/"+token+"/0/1";$.ajax(e).done(function(e){$("#addProduct .u-reveal-body").html(e),gmwa.controllers.storeSmall.addProductOpened(-1),gmwa.controllers.storeSmall.addProductModal.foundation("open"),gmwa.utils.hideProgress()})}),$("#buttonCheckout, #lnkCheckout").click(function(e){gmwa.controllers.storeSmall.goToCheckout()||e.preventDefault()}),$("#bottomCartView").click(function(e){gmwa.controllers.storeSmall.mobileCarritoOpened?($("#carritoCntr").hide(),gmwa.controllers.storeSmall.mobileCarritoViewBtn.text("PEDIDO")):($("#carritoCntr").show(),gmwa.controllers.storeSmall.mobileCarritoViewBtn.text("CERRAR")),gmwa.controllers.storeSmall.mobileCarritoOpened=!gmwa.controllers.storeSmall.mobileCarritoOpened}),$("#bottomCartClose").click(function(e){$("#carritoCntr").hide(),gmwa.controllers.storeSmall.mobileCarritoViewBtn.text("PEDIDO"),gmwa.controllers.storeSmall.mobileCarritoOpened=!1}),gmwa.controllers.storeSmall.mobileCarritoViewBtn=$("#bottomCartView > :nth-child(2)"),gmwa.controllers.storeSmall.mobileCarritoQty=$("#bottomCartView > :nth-child(3)"),$("#btnprodgroups").click(function(e){gmwa.controllers.storeSmall.sectionsOpened?$("#prodgroups").hide():$("#prodgroups").show(),gmwa.controllers.storeSmall.sectionsOpened=!gmwa.controllers.storeSmall.sectionsOpened}),$("#prodgroups ul li").click(function(e){Foundation.MediaQuery.is("small only")&&($("#prodgroups").hide(),gmwa.controllers.storeSmall.sectionsOpened=!1)}),$("#hourToday").click(function(e){gmwa.controllers.storeSmall.hoursOpened?$("#restHours").hide():$("#restHours").show(),gmwa.controllers.storeSmall.hoursOpened=!gmwa.controllers.storeSmall.hoursOpened}),null!=window.loadCarrito&&(carrito=window.loadCarrito,gmwa.controllers.storeSmall.cartDraw()),$("#openCoverage").click(function(e){e.preventDefault(),void 0===window.coverageData?(gmwa.controllers.storeSmall.viewCoverageModal=$("#viewCoverage"),e="/pedidos/listDeliveryCoverage/"+$("#retInfoCntr").data("idr")+"/"+$("#retInfoCntr").data("ids"),gmwa.utils.showProgress("","",!1,!1),$.ajax(e).done(function(e){gmwa.utils.hideProgress(),window.coverageData=e,gmwa.controllers.storeSmall.viewCoverageModal.foundation("open"),setTimeout(function(){window.coverageData.storeLat=parseFloat(window.coverageData.storeLat),window.coverageData.storeLng=parseFloat(window.coverageData.storeLng);var e=!1;if(0<window.coverageData.zones.length?(0==gmwa.mapsFW?gmwa.controllers.storeSmall.loadCoverageGMap():gmwa.controllers.storeSmall.loadCoverageLMap(),e=!0):($("#btnShowUrban").hide(),$("#covUrban").hide()),0<window.coverageData.states.length){for(var o="<ul>",t=0;t<window.coverageData.states.length;t++)o+="<li>"+window.coverageData.states[t].name+"<span> ( $U "+window.coverageData.states[t].amount+")</span></li>";o+="</ul>",$("#covNational > div").html(o),e||$("#covNational").show()}else $("#btnShowNational").hide(),$("#covNational").hide()},400)}).fail(function(e){gmwa.utils.hideProgress(),gmwa.logger.error("listDeliveryCoverage | API returned error: "+JSON.stringify(e))})):gmwa.controllers.storeSmall.viewCoverageModal.foundation("open")}),$("#btnShowUrban").click(function(){$("#btnShowUrban").css("font-weight","600"),$("#btnShowNational").css("font-weight","100"),$("#covUrban").show(),$("#covNational").hide()}),$("#btnShowNational").click(function(){$("#btnShowUrban").css("font-weight","100"),$("#btnShowNational").css("font-weight","600"),$("#covUrban").hide(),$("#covNational").show()}),currentItem.customFields=[],currentItem.quantity=$("#quantityItem").val(),currentItem.price=actualPrice,currentItem.originalPrice=actualPrice,originalPrice=actualPrice;var e;new Swiper("#swipHighlights",{slidesPerView:1.3,paginationClickable:!1,navigation:{nextEl:"#next-sw-nearprms",prevEl:"#prev-sw-nearprms"},spaceBetween:10});gmwa.utils.isMobile()&&(e=$("#carritoCntr").detach(),$(document.body).append(e))},gmwa.controllers.storeSmall.loadCoverageLMap=function(){gmwa.logger.log("Initializing LMaps...");var e=$("#coverageMap").data("im"),l=null,s=null,i=!1;isNaN(window.coverageData.storeLat)?(l=window.coverageData.zones[0].polygon[0].lat,s=window.coverageData.zones[0].polygon[0].lng):(l=window.coverageData.storeLat,s=window.coverageData.storeLng,i=!0),gmwa.components.maps.instance.initMapAsync("coverageMap",l,s,16,e,function(e){gmwa.controllers.storeSmall.map=e,i&&(gmwa.controllers.reportarError.marker=gmwa.components.maps.instance.addMarkerSimple(gmwa.controllers.storeSmall.map,l,s));for(var o=window.coverageData.zones.length,t=[],r="",a="",n=0;n<o;n++)L.polygon(window.coverageData.zones[n].polygon,{color:gmwa.controllers.storeSmall.colors[n],weight:1}).addTo(gmwa.controllers.storeSmall.map),a=0==window.coverageData.zones[n].amount?"sin costo":"$U "+window.coverageData.zones[n].amount,r+='<div style="background-color:'+gmwa.controllers.storeSmall.colors[n]+';width:15px;height:15px;display:inline-block;margin: -2px 4px -2px 10px;border-radius: 50%;"></div><div style="display:inline-block">'+window.coverageData.zones[n].name+" ("+a+")</div>",t=t.concat(window.coverageData.zones[n].polygon);gmwa.controllers.storeSmall.map.fitBounds(t),$("#coverageZonesDesc").html(r)})},gmwa.controllers.storeSmall.loadCoverageGMap=function(){covMap=new google.maps.Map(document.getElementById("coverageMap"),{center:{lat:window.coverageData.storeLat,lng:window.coverageData.storeLng},styles:[{elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"geometry.stroke",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#0080ff"},{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.stroke",stylers:[{visibility:"on"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]}),google.maps.event.addListenerOnce(covMap,"idle",function(){new google.maps.Marker({map:covMap,position:{lat:window.coverageData.storeLat,lng:window.coverageData.storeLng}});for(var e=new google.maps.LatLngBounds,o="",t="",r=window.coverageData.zones.length,a=0;a<r;a++){(polygon=new google.maps.Polygon({paths:window.coverageData.zones[a].polygon,strokeColor:gmwa.controllers.storeSmall.colors[a],strokeWeight:.5,fillColor:gmwa.controllers.storeSmall.colors[a],fillOpacity:.35})).zonaIndex=a,polygon.setMap(covMap);for(var n=0;n<window.coverageData.zones[a].polygon.length;n++)e.extend(window.coverageData.zones[a].polygon[n]);t=0==window.coverageData.zones[a].amount?"sin costo":"$U "+window.coverageData.zones[a].amount,o+='<div style="background-color:'+gmwa.controllers.storeSmall.colors[a]+';width:15px;height:15px;display:inline-block;margin: -2px 4px -2px 10px;border-radius: 50%;"></div><div style="display:inline-block">'+window.coverageData.zones[a].name+" ("+t+")</div>"}covMap.fitBounds(e),$("#coverageZonesDesc").html(o)})},gmwa.controllers.storeSmall.initProductControls=function(){null!=window.loadCustomFields&&(e=window.loadCustomFields,currentItem.customFields=e.data.customFields);var e,t=[];$(".u-menu-option option[data-variant=1]").each(function(){var e=$(this).data("id"),o=$(this).data("val");t.push({cfId:e,cfOpId:o})}),$(".u-menu-option input[data-variant=1]").each(function(){var e=$(this).data("id"),o=$(this).data("val");t.push({cfId:e,cfOpId:o})}),currentItem.quantity=$("#quantityItem").val(),$("#ompaQtyMinus").click(function(){1<currentItem.quantity&&(currentItem.quantity--,$("#ompaQtyNumber").html(currentItem.quantity),$("#quantityItem").val(currentItem.quantity),currentItem.price=gmwa.controllers.storeSmall.calculateItemPrice(currentItem),$("#priceCustom").html(gmwa.utils.formatNumberHTML(currentItem.price)))}),$("#ompaQtyPlus").click(function(){currentItem.quantity<20&&(currentItem.quantity++,$("#ompaQtyNumber").html(currentItem.quantity),$("#quantityItem").val(currentItem.quantity),currentItem.price=gmwa.controllers.storeSmall.calculateItemPrice(currentItem),$("#priceCustom").html(gmwa.utils.formatNumberHTML(currentItem.price)))}),$(".custom-list").change(function(){var e={},o=$("option:selected",this),t=$(this).data("variant");if(e.id=parseInt(o.attr("data-id")),e.type=2,e.val=parseInt(o.attr("data-val")),e.name=o.data("name"),e.optName=o.data("label"),e.price=parseInt(o.attr("data-extra")),"null"!=$(this).val()){for(var r=0;r<currentItem.customFields.length;r++)if(currentItem.customFields[r].id==e.id){currentItem.customFields.splice(r,1);break}currentItem.customFields.push(e)}else for(r=0;r<currentItem.customFields.length;r++)if(currentItem.customFields[r].id==e.id){currentItem.customFields.splice(r,1);break}if(currentItem.price=gmwa.controllers.storeSmall.calculateItemPrice(currentItem),$("#priceCustom").html(gmwa.utils.formatNumberHTML(currentItem.price)),1==t){var t=e.val,a=(!$(this).find("option[data-val="+t+"]").data("unavailable")&&0!=t||($(".u-menu-option input[data-variant=1]").each(function(){$(this).parent().removeClass("notavailable"),$(this).prop("checked",!1)}),$(".u-menu-option select[data-variant=1] option").each(function(){var e=$(this).data("label"),o=$(this).data("val"),t=Number($(this).data("extraselect"));0!=o&&($(this).text(e),0<t)&&$(this).append(" + $"+t)})),{});a.pInstId=$("#datos").data("id"),o.data("unavailable");a.pairs=[],a.clickedPair={},a.clickedPair.cfId=e.id,a.clickedPair.cfOpId=e.val,a.pairs.push(a.clickedPair);for(var n,r=0;r<currentItem.customFields.length;r++)1==currentItem.customFields[r].variant&&((n={}).cfId=currentItem.customFields[r].id,n.cfOpId=currentItem.customFields[r].val,a.pairs.push(n));gmwa.utils.showProgress("","",!1,!1),$.ajax({type:"POST",url:"/pd/variant",data:JSON.stringify(a),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){$(".u-menu-option input[data-variant=1]").each(function(){var e=$(this).data("id");a.clickedPair.cfId!=e&&($(this).parent().addClass("notavailable"),$(this).attr("data-unavailable",!0))}),$(".u-menu-option select[data-variant=1] option").each(function(){var e=$(this).text(),o=$(this).data("id"),t=$(this).data("val");a.clickedPair.cfId==o&&a.clickedPair.cfOpId==t||(e.includes("[NO DISPONIBLE]")||$(this).text(e+" [NO DISPONIBLE]"),$(this).attr("data-unavailable",!0))}),e.data.pairs.forEach(function(e){$("#cf-"+e.cfId+"-"+e.cfOpId).parent().removeClass("notavailable"),cleanLabel=$(".u-menu-option select[data-variant=1] option[data-val="+e.cfOpId+"]").text().replace("[NO DISPONIBLE]",""),$(".u-menu-option select[data-variant=1] option[data-val="+e.cfOpId+"]").text(cleanLabel),$(".u-menu-option select[data-variant=1] option[data-val="+e.cfOpId+"]").attr("data-unavailable",!1)}),gmwa.utils.hideProgress()}).fail(function(e){gmwa.utils.hideProgress(),gmwa.logger.error("Product variant | API returned error: "+JSON.stringify(e))})}}),$(".custom-check").change(function(){var e=$(this).prop("checked"),o=parseInt($(this).attr("data-extra")),t={};if(t.id=parseInt($(this).attr("data-id")),t.type=1,t.name=$(this).data("label"),t.price=o,e)currentItem.customFields.push(t);else for(var r=0;r<currentItem.customFields.length;r++)currentItem.customFields[r].id==t.id&&currentItem.customFields.splice(r,1);currentItem.price=gmwa.controllers.storeSmall.calculateItemPrice(currentItem),$("#priceCustom").html(gmwa.utils.formatNumberHTML(currentItem.price))}),$(".custom-radio").change(function(){var e={},o=$(this),t=(e.id=parseInt(o.attr("data-id")),e.type=2,o.data("variant"));if(e.val=parseInt(o.attr("data-val")),e.name=o.data("name"),e.optName=o.data("label"),e.price=parseFloat($(this).attr("data-extra")),"null"!=$(this).val()){for(var r=0;r<currentItem.customFields.length;r++)if(currentItem.customFields[r].id==e.id){currentItem.customFields.splice(r,1);break}currentItem.customFields.push(e)}else for(r=0;r<currentItem.customFields.length;r++)if(currentItem.customFields[r].id==e.id){currentItem.customFields.splice(r,1);break}if(currentItem.price=gmwa.controllers.storeSmall.calculateItemPrice(currentItem),$("#priceCustom").html(gmwa.utils.formatNumberHTML(currentItem.price)),1==t){var a=e.id,n=e.val,l=($(this).find("option[data-val="+n+"]"),$(this).parent().hasClass("notavailable")&&($(".u-menu-option input[data-variant=1]").each(function(){$(this).parent().removeClass("notavailable"),$(this).attr("id")!="cf-"+a+"-"+n&&$(this).prop("checked",!1)}),$(".u-menu-option select[data-variant=1] option").val(""),$(".u-menu-option select[data-variant=1] option").each(function(){var e=$(this).data("val"),o=$(this).text();0!=e&&$(this).text(o)})),{});l.pInstId=$("#datos").data("id"),o.data("unavailable");l.pairs=[],l.clickedPair={},l.clickedPair.cfId=e.id,l.clickedPair.cfOpId=e.val,l.pairs.push(l.clickedPair);for(var s,r=0;r<currentItem.customFields.length;r++)1==currentItem.customFields[r].variant&&((s={}).cfId=currentItem.customFields[r].id,s.cfOpId=currentItem.customFields[r].val,l.pairs.push(s));gmwa.utils.showProgress("","",!1,!1),$.ajax({type:"POST",url:"/pd/variant",data:JSON.stringify(l),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){$(".u-menu-option input[data-variant=1]").each(function(){var e=$(this).data("id"),o=$(this).data("val");l.clickedPair.cfId==e&&l.clickedPair.cfOpId==o||($(this).parent().addClass("notavailable"),$(this).attr("data-unavailable",!0))}),$(".u-menu-option select[data-variant=1] option").each(function(){var e=$(this).text();$(this).data("id"),$(this).data("val");e.includes("[NO DISPONIBLE]")||$(this).text(e+" [NO DISPONIBLE]"),$(this).attr("data-unavailable",!0)}),e.data.pairs.forEach(function(e){$("#cf-"+e.cfId+"-"+e.cfOpId).parent().removeClass("notavailable"),cleanLabel=$(".u-menu-option select[data-variant=1] option[data-val="+e.cfOpId+"]").text().replace("[NO DISPONIBLE]",""),$(".u-menu-option select[data-variant=1] option[data-val="+e.cfOpId+"]").text(cleanLabel),$(".u-menu-option select[data-variant=1] option[data-val="+e.cfOpId+"]").attr("data-unavailable",!1)}),gmwa.utils.hideProgress()}).fail(function(e){gmwa.utils.hideProgress(),gmwa.logger.error("Product variant | API returned error: "+JSON.stringify(e))})}}),$("#lblSpInstr").click(function(e){$("#lblSpInstr").hide(),$("#txtSpInstr").show(0,function(){$("#textArea").focus()})}),$("#textArea").focusout(function(e){0===$("#textArea").val().length&&($("#lblSpInstr").show(),$("#txtSpInstr").hide())}),$("#ompaModify").click(function(e){})},gmwa.controllers.storeSmall.goToCheckout=function(){return null!=carrito&&0!==carrito.items.length||(gmwa.utils.showError("El carrito esta vacio","Agrega algunos productos antes de finalizar la compra"),!1)},gmwa.controllers.storeSmall.addProductOpened=function(e){selectPrice=0,actualPrice=parseFloat($("#price").val()),originalPrice=0<e?($("#ompaAdd").click(gmwa.controllers.storeSmall.modifyProduct),$("#ompaAdd").text("Actualizar"),$("#ompaCancel, #ompaCancelTimes").click(gmwa.controllers.storeSmall.addProductCancel),currentItem=gmwa.controllers.storeSmall.cartGetItem(e),parseFloat($("#productOrigPrice").val())):($("#ompaAdd").click(gmwa.controllers.storeSmall.addProduct),$("#ompaCancel, #ompaCancelTimes").click(gmwa.controllers.storeSmall.addProductCancel),currentItem.customFields=[],currentItem.quantity=$("#quantityItem").val(),currentItem.price=actualPrice,currentItem.originalPrice=actualPrice),gmwa.controllers.storeSmall.initProductControls(),$(".swiper-wrapper").attr("style",""),setTimeout(function(){gmwa.controllers.storeSmall.imagesSwiper=new Swiper("#adImgGal",{slidesPerView:1,paginationClickable:!1,spaceBetween:0,pagination:{el:"#adImgGalPag",type:"bullets"}}),gmwa.controllers.storeSmall.pswp=$(".pswp")[0],gmwa.controllers.storeSmall.pswpItems=[],$(".additional-image, #adImgGal img").each(function(){var e,o,t;"moreImages"!=$(this).attr("id")&&(e=$(this).data("zoom-image"),o=(t=$(this).data("size").split("x"))[0],t=t[1],gmwa.controllers.storeSmall.pswpItems.push({src:e,w:o,h:t}))}),$("#adImgGal img").on("click",function(e){e.preventDefault();e=parseInt($(this).data("index"));new PhotoSwipe(gmwa.controllers.storeSmall.pswp,PhotoSwipeUI_Default,gmwa.controllers.storeSmall.pswpItems,{index:e,bgOpacity:.7,showHideOpacity:!0,shareEl:!1,fullscreenEl:!1,tapToClose:!0,preload:[0,0]}).init()})},500)},gmwa.controllers.storeSmall.addProductCheckMandatories=function(){for(var a=[],e=!0,o=($(".u-menu-option-options input[required]").each(function(){var e=$(this).attr("id").split("-"),o=$(this).data("name"),t=$(this).data("id"),e=Number(e[2]),r=$(this).is(":checked");a.push({cfId:t,cfOpId:e,cfLabel:o,checked:r})}),0),t=!1,r=0;r<a.length;r++)(o=0==o?a[r].cfId:o)!=a[r].cfId&&(t||(gmwa.logger.log("Required custom field "+a[r-1].cfId+"-"+a[r-1].cfLabel+" is not checked"),e=!1),t=!1),a[r].checked&&(t=!0),r+1!=a.length||t||(gmwa.logger.log("Required custom field "+a[r].cfId+"-"+a[r].cfLabel+" is not checked 2"),e=!1),o=a[r].cfId;$(".u-menu-option-options select[required]").each(function(){""==(cfId=$(this).val())&&(cfLabel=$(this).data("valcustomname"),gmwa.logger.log("Required custom field "+cfLabel+" is not checked"))});return a.forEach(function(e){}),e},gmwa.controllers.storeSmall.addProduct=function(e){e.preventDefault();var e=gmwa.controllers.storeSmall.getMainIDs(),o=new Date,t=(e.dateTo=[o.getMonth()+1,o.getDate(),o.getFullYear()].join("/")+" "+[o.getHours(),o.getMinutes(),o.getSeconds()].join(":"),currentItem.notes=$("#additionalNotes").val(),currentItem.quantity&&1<currentItem.quantity?currentItem.price=$("#datos").data("price")*currentItem.quantity:currentItem.price=$("#datos").data("price"),currentItem.id=$("#datos").data("id"),e.token=$("#token").val(),e.idr=$("#retInfoCntr").data("idr"),e.ids=$("#retInfoCntr").data("ids"),e.type=$("#retInfoCntr").data("stype"),e.plist=[],e.plist.push(currentItem),JSON.stringify(e));currentItem.productName=productName,gmwa.controllers.storeSmall.addProductCheckMandatories()?($("#lblError").html(""),gmwa.utils.showProgress("","",!1,!1),$.ajax({type:"POST",url:"/pedido/agregar",data:t,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){200==e.meta.status?(gmwa.logger.log("Order Add Product | API returned OK: "+JSON.stringify(e)),gmwa.logger.log(t),currentItem.lineId=e.data.lineId,gmwa.controllers.storeSmall.cartAdd(currentItem),gmwa.controllers.storeSmall.cartDraw()):gmwa.logger.error("Order Add Product | API returned error: "+JSON.stringify(e)),gmwa.utils.hideProgress()}).fail(function(e){gmwa.logger.error("Order Add Product | API returned error: "+JSON.stringify(e)),gmwa.utils.hideProgress()}),gmwa.controllers.storeSmall.addProductModal.foundation("close")):$("#lblError").html("<strong>Campos invalidos</strong> Ingrese todos los datos obligatorios")},gmwa.controllers.storeSmall.modifyProduct=function(e){e.preventDefault(),gmwa.logger.log("El producto a modificar es "+$("#ompaId").val()+" con cantidad: "+$("#ompaQty").val()),currentItem.notes=$("#textArea").val();var e={},o=(e.idr=$("#idr").val(),e.ids=$("#ids").val(),e.token=$("#token").val(),e.lineId=$("#lineId").val(),e.customFields=currentItem.customFields,e.notes=currentItem.notes,e.quantity=currentItem.quantity,JSON.stringify(e));gmwa.utils.showProgress("","",!1,!1),$.ajax({type:"POST",url:"/pedido/editar",data:o,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){200==e.meta.status?(gmwa.logger.log("Order Edit Product | API returned OK: "+JSON.stringify(e)),gmwa.logger.log(o),gmwa.controllers.storeSmall.cartEdit(currentItem),gmwa.controllers.storeSmall.cartDraw()):gmwa.logger.error("Order Edit Product | API returned error: "+JSON.stringify(e)),gmwa.utils.hideProgress()}).fail(function(e){gmwa.utils.hideProgress(),gmwa.logger.error("Order Edit Product | API returned error: "+JSON.stringify(e))}),gmwa.controllers.storeSmall.addProductModal.foundation("close")},gmwa.controllers.storeSmall.addProductCancel=function(e){gmwa.controllers.storeSmall.addProductModal.foundation("close")},gmwa.controllers.storeSmall.iniciarAdministrador=function(){$(".line-edit").click(function(e){e.preventDefault();var o={},e=(o.productId=$(this).attr("data-id"),o.lineId=$(this).attr("data-lineId"),o.token=carrito.token,o.idr=carrito.idr,o.ids=carrito.ids,o.type=0,"/pd/component/"+o.productId+"/"+o.idr+"/"+o.ids+"/"+o.token+"/0/1?lineId="+o.lineId);gmwa.utils.showProgress("","",!1,!1),$.ajax(e).done(function(e){$("#addProduct .u-reveal-body").html(e),gmwa.controllers.storeSmall.addProductOpened(o.lineId),gmwa.controllers.storeSmall.addProductModal.foundation("open"),gmwa.utils.hideProgress()}).fail(function(e){gmwa.utils.hideProgress(),gmwa.logger.error("Order Modify Product | API returned error: "+JSON.stringify(e))})}),$(".line-delete").click(function(e){e.preventDefault();var o={},t=($(this).attr("data-id"),o.token=carrito.token,o.idr=carrito.idr,o.ids=carrito.ids,o.lineId=$(this).attr("data-lineId"),JSON.stringify(o));gmwa.utils.showProgress("","",!1,!1),$.ajax({type:"POST",url:"/pedido/quitar",data:t,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){200==e.meta.status?(gmwa.logger.log("Order Remove Product | API returned OK: "+JSON.stringify(e)),gmwa.logger.log(t),gmwa.controllers.storeSmall.cartDelete(o.lineId),gmwa.controllers.storeSmall.cartDraw()):gmwa.logger.error("Order Add Product | API returned error: "+JSON.stringify(e)),gmwa.utils.hideProgress()}).fail(function(e){gmwa.utils.hideProgress(),gmwa.logger.error("Order Add Product | API returned error: "+JSON.stringify(e))})})},gmwa.controllers.storeSmall.calculateItemPrice=function(e){for(var o=parseInt(e.originalPrice),t=0;t<e.customFields.length;t++)if(1==e.customFields[t].type)null!=e.customFields[t].price&&null!=e.customFields[t].price&&(o=parseInt(o)+parseInt(e.customFields[t].price));else if(2==e.customFields[t].type||3==e.customFields[t].type)if(Array.isArray(e.customFields[t].val))for(var r=0;r<e.customFields[t].val.length;r++)null!=e.customFields[t].val[r].checked&&1==e.customFields[t].val[r].checked&&null!=e.customFields[t].val[r].price&&null!=e.customFields[t].val[r].price&&(o=parseInt(o)+parseInt(e.customFields[t].val[r].price));else null!=e.customFields[t].price&&null!=e.customFields[t].price&&(o=parseInt(o)+parseInt(e.customFields[t].price));return o=parseInt(o)*parseInt(e.quantity)},gmwa.controllers.storeSmall.cartDraw=function(){var e="",o="",t=!1,r=0;if(0==carrito.items.length)e='<tr><td style="font-size: 12px;text-align: center;padding: 30px;">Nada por aqui. Busca un producto y agregalo a tu carrito</td></tr>';else{for(var a=0;a<carrito.items.length;a++){o="",t=!1,carrito.items[a].notes&&0<carrito.items[a].notes.length&&(t=!0,o=20<carrito.items[a].notes.length?"<p>"+carrito.items[a].notes.substring(0,15)+"... ":"<p>"+carrito.items[a].notes+" ");for(var n=0;n<carrito.items[a].customFields.length;n++)t?o+=", ":(o="<p>",t=!0),2==carrito.items[a].customFields[n].type?o+=carrito.items[a].customFields[n].name+": "+carrito.items[a].customFields[n].optName:o+=carrito.items[a].customFields[n].name,0<carrito.items[a].customFields[n].price&&(o+='<span style="font-size:90%"> ('+gmwa.utils.formatNumberHTML(carrito.items[a].customFields[n].price)+")</span>");t&&(o+="</p>");var l=gmwa.utils.formatNumberObject(carrito.items[a].price);e+='<tr id="order-'+carrito.items[a].lineId+'" style="border-top: 1px solid #EEE;"><td>'+carrito.items[a].productName+o+'<div><a href="" class="line-edit" data-lineId='+carrito.items[a].lineId+" data-id="+carrito.items[a].id+' id="modifyOrder-'+carrito.items[a].lineId+'">Modificar </a><a href="" class="line-delete" data-lineId='+carrito.items[a].lineId+" data-id="+carrito.items[a].id+' id="deleteOrder-'+carrito.items[a].lineId+'">Quitar</a></div></td><td>x'+carrito.items[a].quantity+'</td><td class="price" style="text-align:right"><span class="currency">'+l.currency+" </span>"+l.number+'<span class="decimals">,'+l.decimals+"</span></td></tr>",r+=carrito.items[a].price}r=parseFloat(Math.round(100*r)/100),e+='<tr style="border-top: 2px solid #DDD;"><td colspan="2" style="text-align:right;bstore-top: 1px dashed #DDD;padding-bottom: 1px;">Sub-total:</td><td style="bstore-top: 1px dashed #DDD;padding-bottom: 1px;text-align:right" class="price"><span class="currency">'+(oSubTotal=gmwa.utils.formatNumberObject(r)).currency+" </span>"+oSubTotal.number+'<span class="decimals">,'+oSubTotal.decimals+"</span></td></tr>",total=parseFloat(Math.round(100*(r+parseFloat(0)))/100),e+='<tr><td colspan="2" style="text-align:right;padding-bottom: 1px;font-size: 20px;">Total:</td><td style="color: #159de1;font-weight: 600;padding-bottom: 1px;font-size: 20px;text-align:right" class="price"><span class="currency">'+(oTotal=gmwa.utils.formatNumberObject(total)).currency+" </span>"+oTotal.number+'<span class="decimals">,'+oTotal.decimals+"</span></td></tr>"}$("#carrito").html(e),gmwa.controllers.storeSmall.iniciarAdministrador(),gmwa.controllers.storeSmall.cartUpdateMobileQty()},gmwa.controllers.storeSmall.cartInit=function(){var e=new Date;(carrito=gmwa.controllers.storeSmall.getMainIDs()).dateTo=[e.getMonth()+1,e.getDate(),e.getFullYear()].join("/")+" "+[e.getHours(),e.getMinutes(),e.getSeconds()].join(":"),carrito.items=[]},gmwa.controllers.storeSmall.cartAdd=function(e){e=$.extend({},e);null===carrito&&gmwa.controllers.storeSmall.cartInit(),carrito.items.push(e),gmwa.controllers.storeSmall.cartUpdateMobileQty()},gmwa.controllers.storeSmall.cartEdit=function(e){var o=$.extend({},e);null===carrito&&gmwa.controllers.storeSmall.cartInit();for(var t=0;t<carrito.items.length;t++)if(carrito.items[t].lineId==o.lineId){carrito.items[t]=o;break}},gmwa.controllers.storeSmall.cartDelete=function(e){null===carrito&&gmwa.controllers.storeSmall.cartInit();for(var o=0;o<carrito.items.length;o++)if(carrito.items[o].lineId==e){carrito.items.splice(o,1);break}gmwa.controllers.storeSmall.cartUpdateMobileQty()},gmwa.controllers.storeSmall.cartGetItem=function(e){for(var o=0;o<carrito.items.length;o++)if(carrito.items[o].lineId==e)return carrito.items[o]},gmwa.controllers.storeSmall.cartUpdateMobileQty=function(){var e=carrito.items.length;0<e?(gmwa.controllers.storeSmall.mobileCarritoQty.css("display","inline-block"),gmwa.controllers.storeSmall.mobileCarritoQty.text(e)):gmwa.controllers.storeSmall.mobileCarritoQty.css("display","none")},gmwa.controllers.storeSmall.getMainIDs=function(){var e,o={},t=document.getElementById("token"),r=document.getElementById("idr"),a=document.getElementById("ids");return t&&r&&a?(o.token=t.value,o.idr=r.value,o.ids=a.value):"store"==(t=document.location.href.split("/"))[3]?8<t.length?(o.idr=t[t.length-5],o.ids=t[t.length-4],e=t[t.length-1].split("#"),o.token=e[0]):(o.idr=t[t.length-4],o.ids=t[t.length-3]):"pedido"==t[3]&&(8<t.length?(e=t[t.length-1].split("#"),o.token=e[0],o.ids=t[t.length-2]):o.ids=t[t.length-1]),o};